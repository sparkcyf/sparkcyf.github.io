[{"content":"Jetson is an embedded AI computing platform launched by Nvidia. Compared to laptops and servers, Jetson has a smaller size and lower power consumption, making it suitable for deployment on edge devices. Oxford Nanopore Technology has also released MinION Mk1C based on the Jetson platform for real-time analysis of sequencing data. This article describes how to install and run Bonito Basecaller on Jetson for real-time sequencing data analysis and model training on edge devices.\nThis article is based on the Jetson Xavier NX development board running Jetson Linux 35.2.1. Other Jetson devices may require minor adjustments.\n$ uname -r 5.10.216-tegra $ nvcc --version nvcc: NVIDIA (R) Cuda compiler driver Copyright (c) 2005-2022 NVIDIA Corporation Built on Sun_Oct_23_22:16:07_PDT_2022 Cuda compilation tools, release 11.4, V11.4.315 Build cuda_11.4.r11.4/compiler.31964100_0 Ensure CUDA Dependencies Bonito Basecaller is a deep learning model based on CUDA, so it is necessary to ensure that CUDA dependencies are installed. During the installation of Jetson Linux using sdkmanager, you need to select the installation of the CUDA Toolkit to ensure that CUDA dependencies are installed. After entering the system, you can check the CUDA version using the following command:\n$ nvcc --version nvcc: NVIDIA (R) Cuda compiler driver Copyright (c) 2005-2022 NVIDIA Corporation Built on Sun_Oct_23_22:16:07_PDT_2022 Cuda compilation tools, release 11.4, V11.4.315 Build cuda_11.4.r11.4/compiler.31964100_0 Install Conda To avoid conflicts with the system\u0026rsquo;s Python environment, we can use Conda to create an independent Python environment. First, we create a Conda environment:\nconda create -n bonito-py38-081 conda activate bonito-py38-081 And install Python 3.8 in this environment:\nconda install python=3.8 Install Bonito Observing the requirements.txt file of Bonito, we can see that Bonito depends on the following Python libraries:\n# general requirements edlib fast-ctc-decode mappy networkx # required for py3.8 torch compatability numpy\u0026lt;2 # numpy~=2 is currently unreleased, it may have breaking changes pandas\u0026lt;3 # pandas~=3 is currently unreleased, it may have breaking changes parasail pod5 pysam python-dateutil requests toml tqdm wheel # specific requirements torch==2.1.2 # ont requirements ont-fast5-api ont-koi ont-remora After testing by the author, the packages that have compatibility issues on the arm64 architecture are mainly focused on torch and ont-koi. Among them, PyTorch requires the installation of the torch package provided by NVIDIA, and ont-koi requires the porting of the dorado koi library.\nPyTorch According to Nvidia\u0026rsquo;s documentation and compatibility matrix table, we can install version 2.1.0a which is closest to Pytorch 2.1.2 (Please select the appropriate PyTorch version according to the actual Jetpack Linux version):\n# Download the PyTorch wheel file wget https://developer.download.nvidia.com/compute/redist/jp/v512/pytorch/torch-2.1.0a0+41361538.nv23.06-cp38-cp38-linux_aarch64.whl # Install numpy and pandas pip install \u0026#34;numpy\u0026lt;2\u0026#34; \u0026#34;pandas\u0026lt;3\u0026#34; # Install PyTorch pip install torch-2.1.0a0+41361538.nv23.06-cp38-cp38-linux_aarch64.whl After installation, you can use the following command to determine that PyTorch has read the Jetson\u0026rsquo;s GPU:\npython3 \u0026gt;\u0026gt;\u0026gt; import torch torch.cuda.get_device_name(0) \u0026gt;\u0026gt;\u0026gt; torch.cuda.get_device_name(0) \u0026#39;Xavier\u0026#39; ont-koi Compile so file Since ONT only provides the koi library for the x86_64 architecture, we need to port the koi library to the arm64 architecture ourselves. After observation by the author, pre-compiled koi packages were found in Dorado\u0026rsquo;s Koi.cmake. We can directly download and compile the so file. We first download the koi package from ONT:\n# Download the koi package wget https://cdn.oxfordnanoportal.com/software/analysis/libkoi-0.4.3-Linux-aarch64-cuda-11.4.tar.gz tar -zxvf libkoi-0.4.3-Linux-aarch64-cuda-11.4.tar.gz Then, create a setup.py in the folder:\nimport os from cffi import FFI ffi = FFI() def build_koi(): with open(\u0026#34;include/koi.h\u0026#34;, \u0026#39;r\u0026#39;) as f: header_content = f.read() ffi.cdef(header_content) ffi.set_source( \u0026#39;koi._runtime\u0026#39;, \u0026#39;#include \u0026lt;koi.h\u0026gt;\u0026#39;, include_dirs=[\u0026#39;./include\u0026#39;], # include library_dirs=[\u0026#39;./lib\u0026#39;], # lib libraries=[\u0026#39;koi\u0026#39;], # link libkoi.a extra_link_args=[\u0026#39;-Wl,-rpath,$ORIGIN/lib\u0026#39;] ) ffi.compile() if __name__ == \u0026#39;__main__\u0026#39;: build_koi() And run the script. After compilation, we can find the _runtime.cpython-38-aarch64-linux-gnu.so file in the current directory.\nThe author also provides a pre-compiled so file for readers to use: https://assets.sparktour.me/img/blog/2025/port-ont-bonito-koi-to-jetson-arm64/_runtime.cpython-38-aarch64-linux-gnu.so.tar.gz Install ont-koi Since the koi architecture is different, we need to install ont-koi manually:\n# We first download the x86_64 architecture whl package wget https://files.pythonhosted.org/packages/fe/68/4bb9241c65d6c0c51b6ae366b5dedda2e8a41ba17d2559079ee8811808ef/ont_koi-0.4.4-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl # Unzip the wheel file (a wheel is essentially a zip file) unzip ont_koi-0.4.4-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl -d ont_koi_temp # Find the Python site-packages directory SITE_PACKAGES=$(python -c \u0026#34;import site; print(site.getsitepackages()[0])\u0026#34;) # Copy the files directly to site-packages (but be sure to back up first) cp -r ont_koi_temp/koi $SITE_PACKAGES/ cp -r ont_koi_temp/ont_koi.libs $SITE_PACKAGES/ cp -r ont_koi_temp/ont_koi-0.4.4.dist-info $SITE_PACKAGES/ # Replace the so file cp /path/to/your/new/_runtime.cpython-38-aarch64-linux-gnu.so $SITE_PACKAGES/koi/_runtime.abi3.so Install Bonito We first download the Bonito source code:\ngit clone https://github.com/nanoporetech/bonito cd bonito Comment out the dependencies of torch and ont-koi in requirements.txt, and then install Bonito:\npip install . Run Bonito bonito basecaller dna_r9.4.1_e8_sup@v3.3 --reference reference.mmi /data/reads \u0026gt; basecalls.bam ","permalink":"https://blog.sparktour.me/en/posts/2025/01/25/port-ont-bonito-koi-to-jetson-arm64/","summary":"\u003cp\u003e\u003ca href=\"https://www.nvidia.com/en-us/autonomous-machines/embedded-systems/\"\u003eJetson\u003c/a\u003e is an embedded AI computing platform launched by Nvidia. Compared to laptops and servers, Jetson has a smaller size and lower power consumption, making it suitable for deployment on edge devices. Oxford Nanopore Technology has also released \u003ca href=\"https://nanoporetech.com/document/requirements/minion-mk1c-spec\"\u003eMinION Mk1C\u003c/a\u003e based on the Jetson platform for real-time analysis of sequencing data. This article describes how to install and run Bonito Basecaller on Jetson for real-time sequencing data analysis and model training on edge devices.\u003c/p\u003e","title":"Running Bonito Basecaller on Nvidia Jetson and other ARM64 devices"},{"content":"All photos are arranged chronologically and have not been post-processed. I tried to use AVIF as the image container format, which might correctly display the HDR effect captured by my phone on the web (unfortunately, the issue of AVIF overflow on Android devices still hasn\u0026rsquo;t been fixed after a year, I\u0026rsquo;ve submit the bugreport link but still got no fix).\nJanuary 2024, a morning view from the Tanglang metro station overpass, Shenzhen February 2024, Victoria Harbour at noon, Hong Kong March 2024, the snack street at Gate 6 of the school. Due to Shenzhen relaxing regulations on street vendors, the number of \u0026ldquo;snack street\u0026rdquo; stalls at the school gate has been gradually increasing since 2024. Shenzhen April 2024, Huangmugang subway station. The station\u0026rsquo;s concourse level is very large but has not yet been furnished with any facilities. Shenzhen May 2024, a CRH6 train passes by the Guangzhou-Shenzhen Railway, Shenzhen June 2024, the exterior wall of a residential building is being repainted, Shenzhen July 2024, the Tsing Ma Bridge seen during a plane landing, Hong Kong August 2024, Old and new CalTrain, San Francisco September 2024, an MLR train on display at an old platform in Hung Hom Station, Hong Kong October 2024, the construction site of the School of Microelectronics, Shenzhen November 2024, evening glow on campus, Shenzhen December 31, 2024, sunset on campus, Shenzhen ","permalink":"https://blog.sparktour.me/en/posts/2024/12/31/2024-in-photos/","summary":"\u003cp\u003e\u003cem\u003eAll photos are arranged chronologically and have not been post-processed. I tried to use AVIF as the image container format, which might correctly display the HDR effect captured by my phone on the web (unfortunately, the issue of AVIF overflow on Android devices still hasn\u0026rsquo;t been fixed after a year, I\u0026rsquo;ve submit the bugreport \u003ca href=\"https://issues.chromium.org/issues/342520633\"\u003elink\u003c/a\u003e but still got no fix).\u003c/em\u003e\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cp\u003e\u003cfigure\u003e\n    \u003cimg loading=\"lazy\" src=\"https://assets.sparktour.me/img/blog/2024/2024-in-photos/202401_sunrise_tl.avif\" alt=\"January 2024, a morning view from the Tanglang metro station overpass, Shenzhen\"  /\u003e\n    \u003cfigcaption\u003eJanuary 2024, a morning view from the Tanglang metro station overpass, Shenzhen\u003c/figcaption\u003e\n\u003c/figure\u003e\n\u003c/p\u003e","title":"2024 in Photos"},{"content":"This blog post shares my travel experience in the United States during the summer of 2024. In this two-week trip, I visited cities on the West Coast, including San Francisco and Los Angeles, and on the East Coast, including New York and Washington, D.C.\nRoute and Attractions Map My general itinerary involved driving from San Francisco to Los Angeles, then flying to New York, taking a train to Washington, D.C., and finally flying back to San Francisco.\nPre-Trip Preparations Visa Fill out the DS-160 form, schedule an interview slot, and then go for an interview at the consulate. Slots at the southern consulates are quite tight, so it\u0026rsquo;s advisable to book about a year in advance of your planned trip. Based on DPs from people around me, graduate students applying for a visa may be asked by the officer to provide a transcript and CV (even if the purpose is tourism), so it\u0026rsquo;s recommended to prepare these in advance. If you don\u0026rsquo;t have them, you might be put on hold (check), and you\u0026rsquo;ll need to send your transcript, CV, and travel plan to the consulate\u0026rsquo;s email, which takes about a month to process. You\u0026rsquo;ll then get a one-year visa with CLEARANCE RECEIVED 202X-XX-XX. It\u0026rsquo;s said that this clearance is valid for 48 months, but I haven\u0026rsquo;t tried to get another visa yet. The only advantage of a one-year visa compared to a ten-year one is that you don\u0026rsquo;t need to fill out EVUS again.\nFlights It\u0026rsquo;s recommended to check Google Flights and other platforms frequently. Generally, it\u0026rsquo;s advisable to start looking at and buying transoceanic flight tickets about 6 months before your trip, as prices are relatively lower then. However, since I chose to travel in August, which may coincide with many international students returning to school, the prices for direct flights and convenient connecting flights (via Japan and South Korea) all exceeded 10,000 RMB. After considering flight prices and comfort, I chose the route MFM-SIN-SFO and SFO-SIN-HKG, operated by Singapore Airlines, which cost about 7,500 RMB per person after a student discount. But it must be said that this route is much longer than a direct flight. The great-circle distance for the MFM-SIN-SFO one-way journey is as high as 16,117km, a distance that can reach South America. In comparison, the direct HKG-SFO flight is only 11,147km, a difference of 1/3 in distance.\nFor domestic flights within the US, it\u0026rsquo;s recommended to purchase tickets about 2 months before departure. However, considering that the three major US airlines (UA, DL, AA) allow free changes and refunds for the price difference (as vouchers) on domestic flights, even if you buy a more expensive ticket, you can convert it to a cheaper one through a refund as a voucher.\nCar Rental Considering that this was my first time driving overseas, we booked a car on the website 租租车 (Zuzuche) for our self-drive trip from San Francisco to Los Angeles. (In theory, large OTAs like Zuzuche and Ctrip should work, as they can get travel agency rates. The only requirement is that the renter needs to present a mainland China driver\u0026rsquo;s license.) The car rental company we were assigned was Avis. Renting a Compact car for 7 days cost about 495 USD. The actual car we got was a 2020 Hyundai Elantra Limited, which had features like ACC, lane keeping, and CarPlay. Aside from the average noise control, I was quite satisfied with it.\n2020 Hyundai Elantra Limited Both mainland China and North America use left-hand drive and right-hand traffic. The main differences are that in North America, you need to completely stop for about 3 seconds at a STOP sign before proceeding, and when turning right at a red light, you also need to stop completely before turning. Another detail I noticed is that when waiting at a red light in North America, don\u0026rsquo;t get too close to the car in front of you. If you follow the habit of mainland China, Americans might think you\u0026rsquo;re going to rear-end them, and they might even move forward a bit if you\u0026rsquo;re too close. Attractions/Experience Ticket Bookings Museums in the United States are not as competitive as those in Europe and other places. Generally, booking two or three days in advance or even buying tickets on-site is fine. The only tickets that were sold out on-site were the ferry tickets to Alcatraz Island in San Francisco.\nI personally recommend using the website \u0026ldquo;美旅通\u0026rdquo; for planning, especially when specifying the itinerary for visiting major attractions. I think it works very well. Compared to Xiaohongshu and some \u0026ldquo;travel blogs\u0026rdquo;, its information density is high, and it has basically no ads (I feel its main source of revenue is from accommodation affiliate links). Payment Methods/Tipping If you don\u0026rsquo;t want to rely on social media platforms like Xiaohongshu when choosing a restaurant, you can consider directly filtering restaurants on Google Maps with ratings higher than 4.3. Generally, restaurants above this line have some unique features and are not likely to be bad. Of course, if you\u0026rsquo;re still too lazy to choose, you can consider eating at common chain fast-food restaurants like McDonald\u0026rsquo;s, Wendy\u0026rsquo;s, Taco Bell, etc. Most places support credit card payments. We only encountered one small pizza place that didn\u0026rsquo;t accept credit cards. Considering the tipping culture in North America (though I don\u0026rsquo;t like it), it\u0026rsquo;s recommended to have a few tens of 1 USD bills for tipping hotel shuttle drivers and housekeeping (if you don\u0026rsquo;t have them, it\u0026rsquo;s okay not to tip. I exchanged some at the hotel front desk on the first day).\nScenario Is Tipping Recommended? How Much to Tip How to Tip Handling luggage, valet parking If no price is listed, yes 1 USD per bag, valet parking depends on the situation Cash Housekeeping If staying more than 1 night, yes 2-5 USD per night Cash, placed under the pillow Restaurant (with waiter service) Generally yes If writing the tip amount, I usually give 10-15% of the pre-tax amount and round it up. Calculated when paying by card Restaurant (counter service) Optional If the server doesn\u0026rsquo;t bring the food and I pick it up myself, I usually don\u0026rsquo;t tip. If the server brings the food, then I give 10% Calculated when paying by card. Some POS machines have default options like 15%, 18%, 20%. You can ignore them and enter your own custom amount. Phone/Data Card If you have a phone that supports eSIM, you can try the 15-day trial with Visible or Verizon. Or you can buy a phone card on Fliggy (飞猪). A 15-day card costs around 120-150 CNY. It\u0026rsquo;s important to note that if you\u0026rsquo;re driving in more remote areas, most carriers might not have signal (like in the middle of Highway 1). If necessary, you can download offline maps. Also, hotspotting on American phone cards will be speed-limited (about 5Mbps). If you need higher speeds, it\u0026rsquo;s better for everyone to have their own card.\nClimate The weather on both the East and West Coasts in August isn\u0026rsquo;t too cold, with temperatures ranging between 15-30 degrees Celsius. The coldest times (San Francisco mornings, New York) require a sweater and a jacket, while the hottest times (Los Angeles) are fine with a t-shirt and shorts.\nDay 0: Arrival in San Francisco Sunset seen from the Macau-Singapore leg, very vibrant Sunrise on the plane, this should be near Alaska Considering the need to pick up our rental car on the third day and the price of accommodation in the city center, we chose to stay at the Aloft SFO hotel in the Millbrae area near the airport. The hotel has a free shuttle bus to and from the airport, about every half hour, and it takes 10 minutes on the shuttle. The Millbrae station of the Caltrain and BART is also close to the hotel, about a 10-minute walk away.\nSan Francisco Airport International Terminal, you can wait here for the free shuttle to the hotel After dropping off our luggage, a local friend took me around the city, briefly visiting areas near Union Square and Chinatown.\nView of I80 heading into the city and part of the San Francisco skyline A street scene near Chinatown A \u0026ldquo;hollowed-out\u0026rdquo; city center, with many shops vacant and \u0026ldquo;For Lease\u0026rdquo; signs posted Area near Union Square, with a Waymo RoboTaxi and the Apple Store in the distance Road near Millbrae, looks new, probably recently built Day 1: San Francisco City Map from \u0026ldquo;美旅通\u0026rdquo; Considering San Francisco\u0026rsquo;s safety issues (especially car break-ins), we didn\u0026rsquo;t try to drive in the city center. Instead, we mainly relied on public transportation like BART, trams, and buses.\nIn the morning, I took the BART into the city. You can use Clipper to ride BART, which can be opened on an iPhone (no opening fee). It must be said that the fare evasion issue on BART is serious. Both when entering and exiting the station, I saw more than one person jumping over the ticket barriers, and the staff didn\u0026rsquo;t seem to care much.\nBART interior, a special feature is that BART is a wide-gauge train, so the interior looks a bit wider than regular subways After getting to Union Square, we walked to the Painted Ladies and then to Japantown, where we had lunch.\nPainted Ladies and city skyline Peace Pagoda in Japantown Ramen in Japantown (HINODEYA Ramen Japantown) After lunch, we experienced Waymo\u0026rsquo;s self-driving car. Similar to Pony.ai, which I experienced in Guangzhou, Waymo also uses an app to select the starting point and destination, and then you can wait for the car at the designated location. Compared to Pony.ai, Waymo\u0026rsquo;s cars seem to drive more aggressively (which might also be because Waymo uses electric cars), even trying to cut into the right-turn traffic flow. We rode for 2.4 miles (4km), which cost 24 USD, quite expensive compared to Uber (about twice the price of a standard Uber).\nWaymo After taking a ride to the seaside, I experienced the cable cars. The experience was similar to the trams in Hong Kong, but unfortunately, there were too many people, and I couldn\u0026rsquo;t experience standing on the sides of the car.\nCable car reversing After that, we walked to Fisherman\u0026rsquo;s Wharf. We originally wanted to take a ferry to Alcatraz Island, but since the Alcatraz ferry tickets were sold out when we tried to buy them three days in advance, we settled for a sightseeing boat tour to see the Golden Gate Bridge instead (there were plenty of seats on the sightseeing boat, and you could buy tickets at the ticket office at any time).\nSightseeing boat One of the Golden Gate Bridge piers seen from the boat Full view of the Golden Gate Bridge Alcatraz Island and the San Francisco city center In the evening, with the goal of trying all of San Francisco\u0026rsquo;s public transportation, we took the bus to the San Francisco Caltrain station and took the train back to Millbrae. Compared to BART, Caltrain is a more serious commuter rail (but you can use Clipper). The staff checking tickets only allowed people to go to the platform 10 minutes before departure, a bit like CR (China Railway). The Caltrain we rode was still the Gallery Car from before the electrification (right side of the picture below), which seems to be at least 40 years old. The structure of the car is very unique; the middle of the second floor is hollow and connected to the first floor.\nNew and old Caltrain, the old Caltrain will be completely retired in 2024 Returning to the hotel from Millbrae station, you need to pass the entrance ramp of US101 Day 2: San Jose Overpass of AirTrain and BART This morning, I took the hotel shuttle back to the airport again and then took the airport AirTrain to the rental car parking lot to pick up the car. The self-driving trip from San Francisco to Los Angeles officially started on this day. According to the car\u0026rsquo;s odometer, we drove 745mi (1198km) in six and a half days.\nSince we had already prepaid for the car rental online, we only needed to show our driver\u0026rsquo;s license and sign the contract at the counter. After the counter froze the 250 USD deposit on the card, they told us the location of the car in the parking lot, and we could directly go upstairs to pick up the car. The only thing to note is that the staff at the counter might ask if you want to add some insurance, refueling service, and ETC. If you don\u0026rsquo;t need them, you need to explicitly reject them. I rented a Compact (Corolla or similar) and got a 2020 Hyundai Elantra Limited, which had features like a digital dashboard, ACC, lane keeping, and CarPlay.\nStanford University After driving out of the airport, we first went to Stanford University. If you need to park, consider parking spots around Stanford Oval. If you want to eat nearby, you can also park in the parking lot next to the Stanford Shopping Center, and then walk or take the university\u0026rsquo;s shuttle bus to the campus.\nBricks with graduation year markings Hoover Tower Interestingly, the Stanford campus was the place with the most Chinese tourists on our entire trip, perhaps showing the strong desire for famous universities in East Asia.\nStanford Oval (and parking spots next to it) GooglePlex GooglePlex has a separate visitor center with a store that sells Pixel, Google Cast, and other Google-branded products, and a cafe. Tourists can park at the Shoreline Amphitheatre Parking Lot C. After crossing the street, you\u0026rsquo;ll reach the new GooglePlex main building. There are many bicycles in the Google campus that seem to be free to ride. We went to the work area on a weekend, and it seemed that no one was working overtime inside, and the lights were off. I wonder if the headquarters needs to set an example for a five-day work week.\nBicycles outside the GooglePlex visitor center Scene inside the Google work area Google\u0026rsquo;s old office building (1900 Charleston Road) Apple Park Visitor Center Apple\u0026rsquo;s visitor center is located outside Apple Park, and visitors cannot enter Apple Park itself. However, Apple Park has an AR model where visitors can use an iPad to view the entire Apple Park model (probably to showcase ARKit). The Apple Park visitor center is also an Apple Store, which sells small souvenirs like shirts and cups, unlike regular Apple Stores.\nApple Park model based on AR Kit Sign for the Visitor Center After visiting Apple Park, we drove to the hotel. Interestingly, the hotel was next to the headquarters of Cisco and Cadence, and seemed to be the reception hotel for these two companies. There was even a Wi-Fi network called \u0026ldquo;Cadence\u0026rdquo; in the hotel. There was a shopping plaza next to the hotel (shopping plazas in North America are literally squares, with a large parking lot in the middle and some shops around it). There was a Walmart and a McDonald\u0026rsquo;s, so we had dinner there and bought some water for the car.\nUS101 southbound section, San Jose section Passing by the Cisco headquarters McDonald\u0026rsquo;s Entrance of Walmart and Sierra Vista in the distance Day 3: Monterey, CA-1, Seaside CA-1 (Highway 1) often has landslides in the summer. During my trip, only the southbound direction was open, while the northbound direction was closed. So, I drove to the Great Sur Vista Point and returned the same way. If you need to check the status of CA-1, you can check the CA DOT website or this link. After having breakfast at McDonald\u0026rsquo;s in the morning, we first headed southwest on CA-85. After a stretch of mountain road, we reached CA-1. If you go too early, the fog on the road might not have completely dissipated, and visibility might be low. You should drive carefully.\nTruck on the mountain road Vineyard Stratus clouds haven\u0026rsquo;t dissipated After the fog has cleared Because of the road closure, I only drove to the area near Great Sur Vista Point. The scenery along the way was still very good, especially the very blue sea.\nBixby Bridge Bixby Bridge in the distance Garr Apata State Park Highway along the coast Cars parked on the side of the road (the Elantra we rented is on the far right) After driving back from CA-1, we also took a loop on 17 Mile Drive (a toll road with coastal views). It\u0026rsquo;s recommended to enter from Pacific Grove Gate when visiting, so that you can drive along the coast when you drive on the right side.\nEntrance Sunset at the sea Old tree by the sea Rocky beach CA-1 at dusk Day 4: US-101, King City, Morro Bay Because CA-1 was not fully open due to landslides, we had to detour back to US-101 and continue south to Morro Bay. We mainly drove on this day and stopped for a short break in King City.\nAfter leaving CA-1, the surrounding scenery turned into a desert style, somewhat similar to the highway in the Hexi Corridor A rest area in King City, with gas stations, KFC, McDonald\u0026rsquo;s, Starbucks, etc. Continuing on US-101 Back on CA-1 again In the evening, we drove to our accommodation in Morro Bay. Morro Bay is also the prototype for Night City in \u0026ldquo;Cyberpunk 2077\u0026rdquo;. In the setting, Morro Bay is called \u0026ldquo;Tomorrow Bay\u0026rdquo;.\nMorro Rock Morro Bay pier Morro Bay pier Our dinner at a western restaurant on the Morro Bay pier, Tognazzini\u0026rsquo;s Dockside Restaurant. We ordered their grilled seafood platter, which was quite large The smokestack of the Morro Bay power plant, now decommissioned Sunset, the photo was taken around Morro Bay Water Access Evening glow in front of the motel Day 5: CA-1, Santa Barbara, Los Angeles Today, we continued driving south, stopping for a while in the town of Solvang, a Danish-style town (somewhat like a \u0026ldquo;Ancient Town\u0026rdquo; built in mainland China).\nA scene from Solvang Streets of Solvang Clouds on the highway After driving in, it was foggy Gas station. Gas stations in North America are self-service. Just insert your credit card and lift the pump. Now most gas stations support foreign credit cards with PIN Hills of Southern California Santa Barbara seaside Santa Barbara church On the way back to CA-1 Back on CA-1, there was some traffic due to road work Typical Southern California landscaping, palm trees on the side of the road (and typical California gas prices) Back to two lanes Suburban expressway Pacific Palisades area, already in the suburbs of Los Angeles Pacific Palisades Arriving near Santa Monica Driving into the city on I-10 Day 6: Los Angeles City Tour guide map from 美旅通, you can refer to this map to plan your itinerary K-Town In the morning, we first went to Griffith Observatory. If you go early (before 10 AM), you can consider parking directly on the mountain road. If you go later, you can park at Greek Theater Parking at the foot of the mountain.\nMain building of the Griffith Observatory LA Downtown, a typical \u0026ldquo;spread out\u0026rdquo; urban planning In the distance (on the right), it looks like something is on fire At noon, we tried Italian food (pasta) at Maccheroni Republic with friends. Although the presentation wasn\u0026rsquo;t great, it tasted good A scene in Downtown After that, we drove to the Getty Center, which mainly exhibits classical and contemporary artworks. The classical artworks at the Getty felt like they were mainly from Europe, similar to some artworks seen in European palaces.\nWalt Disney Concert Hall Getty Center (on the mountain to the left) Getty tram I-405 and Los Angeles Downtown Stickers in the North Pavilion In the evening, I went to Santa Monica Pier. I believe many people first learned about this place in the GTA. The layout of the pier in the game is basically the same as the real Santa Monica Pier.\nParking in Santa Monica is competitive and expensive. You can consider parking in one of the Parking Structures one block away. It seems that parking for less than an hour is free.\nSanta Monica Pier in the distance Parking lot on Santa Monica Pier Amusement facilities on the pier Sunset over the Pacific Ocean Day 7: Los Angeles City In the morning, I first went around the Hollywood sign. Because the sign is on a hill, it looks relatively small in photos taken with a phone.\nHollywood Sign At noon, I went for a walk on the USC campus with friends. The USC campus is not large, and the architectural style is quite uniform.\nMy friend took us to Sun Nong Dan in K-Town, which serves Korean-style iron plate beef ribs and beef bone soup. One of the dishes was finished by the staff lighting a fire on the dish to heat it up USC Campus In the evening, I went to the famous In-N-Out Burger near LAX airport. It\u0026rsquo;s very close to the runway, so you can eat burgers while watching planes.\nLAX In-N-Out Burger Planes seen from LAX In-N-Out Burger BA\u0026rsquo;s A380 AVIS parking lot LAX sign at the airport entrance To save on accommodation costs, we booked the latest LAX-EWR flight of the day, which was equivalent to resting for 5 hours on the plane and arriving in New York the next morning.\nThe plane was a nearly 30-year-old 777-200, with shorter seat pitch than the 777 used for intercontinental flights and no IFE, but the plane had Wi-Fi Day 8: New York After arriving at EWR, we took the Newark Airport Express bus into the city. You need to buy tickets online in advance or pay the driver cash (22.5 USD). The trip into the city takes about 1 hour (although I was asleep the whole time, so I didn\u0026rsquo;t notice anything). If there is no traffic, it\u0026rsquo;s more comfortable than the AirTrain and NJ Transit, which require transfers.\nSince I was too tired on that day, we only went to see the Harry Potter play and then went back to the hotel to rest.\nTime Square Day 9: New York 42 St subway station Downtown Downtown attractions (美旅通) This morning, we first went to the southern part of Manhattan (Downtown).\nSubway station. A strange design of the New York subway is that all exits are labeled with names, not numbers, which makes it a bit inconvenient for tourists to find exits New York\u0026rsquo;s subway has a flat fare system, and you can use your credit card to enter. Some stations also support virtual transfers.\nExit signs at the subway station Considering the limited time, we didn\u0026rsquo;t take a boat to see the Statue of Liberty. The distance from Battery Park is relatively far. Also, because Battery Park was under construction, the whole seaside was surrounded by fences, and there were only a limited number of angles to see the statue.\nStatue of Liberty seen from Battery Park After leaving Battery Park, walking north along Broadway will take you past Wall Street, the NYSE, and other locations.\nCharging Bull on Wall Street Trinity Church NYSE Brooklyn Bridge After walking to Fulton St station, you can take the subway one stop to High St, and then walk back to Manhattan Island across the Brooklyn Bridge.\nBrooklyn District Brooklyn Bridge At noon, we had Southeast Asian food at Nemesis Intrepid Sea, Air \u0026amp; Space Museum In the afternoon, I visited the Intrepid Sea, Air \u0026amp; Space Museum (USS Intrepid (CV 11)) with a classmate. The structure is similar to the Minsk aircraft carrier museum in Shenzhen. They are both decommissioned aircraft carriers, with some other aircraft on display.\nConcorde Aircraft on display on the aircraft carrier and Manhattan Island Before returning to the hotel in the evening, I also went for a walk in Grand Central, which mainly handles MTA subway and LIRR commuter rail traffic.\nGrand Central Another feature of New York is its steam system for heating. However, due to years of disrepair, you can often see steam coming out of cracked pipes on the street.\nUnderground steam system Day 10: New York United Nations Headquarters In the morning, I visited the United Nations. You need to book tickets in advance. One hour before the guided tour, you need to go to the Visitor Check-in Office opposite the UN headquarters to get a tag using your passport, and then you can enter the main building after security check.\nUnited Nations building and the US Mission to the United Nations opposite Non-Violence sculpture The guided tour lasts about an hour. If there are no meetings that day, the tour guide will take you to see several major meeting rooms.\nMeeting room of the Economic and Social Council (ECOSOC) General Assembly Hall Metropolitan Museum of Art In the afternoon, I went to the Metropolitan Museum of Art. Since it was a bit late when I entered (only 1.5 hours before closing), we followed the \u0026ldquo;An Hour at The Met\u0026rdquo; guide on the Met\u0026rsquo;s official website and visited some famous exhibits. However, this website has been removed as of the time I write this blog, and I don\u0026rsquo;t know why. This guide page can be found in the web archive. Or you can check the museum\u0026rsquo;s official website for any tours on the day of your visit and make your arrangements accordingly.\nYellow taxis in front of the Metropolitan Museum of Art The Temple of Dendur Charles Engelhard Court, mainly exhibiting classical European sculptures E 82nd St Central Park We stayed until the museum closed. After leaving the museum, I went to Central Park. The park itself wasn\u0026rsquo;t particularly special and was similar to many city parks in mainland China. Maybe the main point is that the park is built on the valuable land of Manhattan.\nA scene from Central Park It started to rain after walking near Columbus Circle, and we took shelter next to a tree for a while Columbus Circle, also the center of the geographical restrictions for G3 visa holders in the United States (restricting holders to only operate within a 25-mile radius of Columbus Circle) Central Park Tower Woolworth Building and the USPS below Day 11: New York-Washington, D.C. Because I wanted to experience another type of public transportation in North America, we chose to take the train from New York to Washington, D.C. There are three types of trains to choose from: Northeast Regional, Silver Meteor, and Acela. The Northeast Regional and Silver Meteor are regular speed trains that can travel at 200km/h, while Acela is a high-speed train that can travel at 250km/h. The price is also cheaper for the first two. If you don\u0026rsquo;t have a strict time requirement, you can consider purchasing the Northeast Regional. If booked 1-2 months in advance, tickets can be as low as 25 USD from New York to Washington, D.C., which is very cheap compared to other transportation methods like the subway.\nNY Penn Station, this station was renovated in 2023. Like in mainland China, the station only allows people to go down the elevator to the platform about 10 minutes before departure Northeast Regional train Northeast Regional train tickets do not assign seats; seating is on a first-come, first-served basis. Half of the seats in each car are in the reverse direction.\nSignage The windows in the car are relatively small, but the seats are very wide, about the width of a first-class seat on a high-speed train in mainland China. Each row of seats has charging plugs and other facilities After the train starts, the ticket inspector will come to check tickets (scan the QR code on the electronic ticket). After checking the tickets, the inspector will place a card above the seat (in the paper ticket era, they would directly insert the ticket above the seat), indicating that the seat has been checked and occupied.\nPassing a rail yard near Philadelphia Arriving at Washington Union Station. Interestingly, before arriving in Washington, the train attendant said that for security reasons, it was necessary to lock the train toilets in the district Union Station subway station Subway train, which looks newer than the ones in New York You need to swipe a SmartTrip card to enter the Washington subway. You can open a card in Apple Pay (with an opening fee) or buy one with a credit card at a self-service vending machine (you can load it into your phone after purchasing and get a commemorative card).\nSampannee, also a Thai restaurant, with quite large portions. We didn\u0026rsquo;t realize the size of the portions at first and ended up packing half of it back to eat later Day 12: White House, Washington Monument White House White House photographed from the north side White House photographed from the south side, with a Secret Service police car in the foreground Washington Monument You need to book tickets for the Washington Monument elevator and the museum at the top one month in advance. Visitors can book on the www.recreation.gov website, go in, select a time slot, and pay a 1 USD booking fee. If time is tight, there are also same-day tickets available at the foot of the monument every morning, but you might have to go quite early. To visit the monument, you need to go through security first (similar to airport security), and then take an elevator inside the monument to a museum at the top. The museum has some display boards introducing the construction and maintenance of the monument, and small windows where you can see the views around the monument.\nWashington Monument, the monument itself is blocking the sun Entrance to the monument East side, you can see the Capitol Northwest side, you can see the Ellipse and the White House North side, you can see the White House South side, you can see the Tidal Basin, and also planes taking off from DCA airport Smithsonian National Museum of Natural History The Smithsonian National Museum of Natural History mainly displays biological specimens and geological minerals. The collection is very rich, especially the minerals, where samples from almost all minerals you can find on the market are displayed.\nElephant specimen in the center of the Smithsonian Museum. In the lower right corner, a group of Japanese students are lining up to visit. During the visit, I encountered many Japanese and Korean elementary and middle school students National Mall The National Mall refers to the large lawn and group of buildings between the Capitol Building and the Lincoln Memorial.\nLincoln Memorial Reflecting Pool. This pool has appeared in many movies, including \u0026ldquo;Forrest Gump\u0026rdquo; Lincoln Memorial Some street scenes, with bike lanes set in the middle of the road Department of State Day 13: Capitol, Library of Congress, Art Gallery, Air and Space Museum Capitol, Library of Congress The Capitol and the Library of Congress are connected. You need to book a tour on the website to enter. The tour starts with a guide showing a short video introducing the Capitol system. Then, the guide will take you around the hall. Meeting rooms seem to require a separate arrangement with a member of Congress to enter.\nCapitol Visitor Center The dome of the Capitol Building. Inside, sculptures donated by each state are on display. The guide said that these sculptures are often changed Dome of the Library of Congress Library of Congress Capitol Building restaurant, standard Western-style cafeteria East side of the Capitol Building West side of the Capitol Building, also where the presidential inauguration ceremony takes place. The flag was at half-staff that day, but I couldn\u0026rsquo;t find the specific reason (perhaps a member of Congress had passed away) National Gallery of Art Alexander Calder\u0026rsquo;s Monumental Mobile. The sculpture slowly rotates in the breeze from the air conditioning Smithsonian National Air and Space Museum The Smithsonian National Air and Space Museum has two locations, one in the city and one next to the IAD airport. The museum in the city is more educational, with more interactive exhibits, while the museum next to the airport is larger, with more aircraft models (including SR71, the space shuttle, etc.). Due to scheduling, I only went to the museum in the city.\nAircraft inside the museum A blue school bus Day 14: Return Trip My return journey was on United Airlines, flying from Washington Dulles IAD to San Francisco SFO, then taking a Singapore Airlines flight to Singapore SIN, and finally transferring back to Hong Kong HKG. This long journey took a total of nearly 24 hours in the air.\nUnited Airlines 737-900, also equipped with winglets Welcome To SFO (sadly, I only took the photo when leaving) Various United Airlines aircraft at SFO airport Taking off from Singapore, returning to Hong Kong ","permalink":"https://blog.sparktour.me/en/posts/2024/10/03/2024-summer-usa-travel-notes/","summary":"\u003cp\u003eThis blog post shares my travel experience in the United States during the summer of 2024. In this two-week trip, I visited cities on the West Coast, including San Francisco and Los Angeles, and on the East Coast, including New York and Washington, D.C.\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"route-and-attractions-map\"\u003eRoute and Attractions Map\u003c/h2\u003e\n\u003cp\u003eMy general itinerary involved driving from San Francisco to Los Angeles, then flying to New York, taking a train to Washington, D.C., and finally flying back to San Francisco.\u003c/p\u003e","title":"USA Travelogue"},{"content":" This article will be continuously updated as my research progresses. The currently planned additions include:\nTraining dataset format and some techniques Explanation of the principles of CRF Overview of Bonito Basecaller Bonito, named after the bonito fish, is a basecaller framework developed by Oxford Nanopore Technology. The trained basecaller weights can be exported to dorado, guppy, etc. Due to the scarcity of qualitative descriptions of basecallers on the internet, I have spent a lot of time and effort studying the architecture and data flow of these basecallers. Therefore, in this article, I will try to explain, in an easy-to-understand way, the data flow and data formats of Bonito, as well as some knowledge needed for the development of Bonito (or even other nanopore sequencing basecallers). I hope to provide some inspiration for those who come after.\nWhat is a Basecaller? To make it simple, a \u0026ldquo;basecaller\u0026rdquo; is a neural network. Its input is the current signal obtained from nanopore translocation, and its output is the ATCG bases and some other debugging information (in fasta, fastq or bam format). In ONT\u0026rsquo;s devices, the current is generally stored in fast5 format (based on hdf5) and the recently released pod5 format. Regardless of the format, the stored data structure includes at least the following information:\nStored Item Description read_id uuid, used to uniquely identify the sequence raw current Sampled values directly output from the amplifier, without units scale, offset Amplification and offset coefficients, the current in pA can be obtained by pA_val = scale * (raw + offset) metadata Some information related to sequencing, such as time, the kit used, the sequencing flowcell, etc. Some readers may notice that the current signal from nanopore sequencing is somewhat similar to the audio signal in speech recognition. For example, the sound recorded by a microphone is also stored as a one-dimensional array. At the same time, the ATCG output by the basecaller is also similar to the transcript obtained by the speech recognition network (ASR). Therefore, we can also consider the basecaller in nanopore sequencing as a special ASR network.\nArchitecture of Bonito The code referenced in this section has listed the specific github repo and commit. Readers can refer to the source code for reading. The following is the model architecture diagram output by torchinfo (dna_r9.4.1_e8_hac@v3.3, state_len=4), the input of the model is [64,5000] (batchsize, current_length)\n========================================================================================== Layer (type:depth-idx) Output Shape Param # ========================================================================================== Model [64, 1000, 1024] -- ├─Sequential: 1-1 [64, 1000, 1024] -- │ └─Convolution: 2-1 [64, 4, 5000] -- │ │ └─Conv1d: 3-1 [64, 4, 5000] 24 │ │ └─Swish: 3-2 [64, 4, 5000] -- │ └─Convolution: 2-2 [64, 16, 5000] -- │ │ └─Conv1d: 3-3 [64, 16, 5000] 336 │ │ └─Swish: 3-4 [64, 16, 5000] -- │ └─Convolution: 2-3 [64, 384, 1000] -- │ │ └─Conv1d: 3-5 [64, 384, 1000] 117,120 │ │ └─Swish: 3-6 [64, 384, 1000] -- │ └─Permute: 2-4 [1000, 64, 384] -- │ └─LSTM: 2-5 [1000, 64, 384] -- │ │ └─LSTM: 3-7 [1000, 64, 384] 1,182,720 │ └─LSTM: 2-6 [1000, 64, 384] -- │ │ └─LSTM: 3-8 [1000, 64, 384] 1,182,720 │ └─LSTM: 2-7 [1000, 64, 384] -- │ │ └─LSTM: 3-9 [1000, 64, 384] 1,182,720 │ └─LSTM: 2-8 [1000, 64, 384] -- │ │ └─LSTM: 3-10 [1000, 64, 384] 1,182,720 │ └─LSTM: 2-9 [1000, 64, 384] -- │ │ └─LSTM: 3-11 [1000, 64, 384] 1,182,720 │ └─Permute: 2-10 [64, 1000, 384] -- │ └─LinearCRFEncoder: 2-11 [64, 1000, 1024] -- │ │ └─Linear: 3-12 [64, 1000, 1024] 394,240 │ │ └─Tanh: 3-13 [64, 1000, 1024] -- ========================================================================================== Total params: 6,425,320 Trainable params: 6,417,640 Non-trainable params: 7,680 Total mult-adds (G): 386.11 ========================================================================================== Input size (MB): 0.64 Forward/backward pass size (MB): 877.57 Params size (MB): 12.85 Estimated Total Size (MB): 891.06 ========================================================================================== Fig. 1 As shown in Figure 1 of Marcus et al.\u0026rsquo;s article, the model structure of Bonito (and some common basecallers) is mainly divided into three parts: CNN, LSTM/RNN, etc. Encoder, and CTC/CRF, etc. Decoder.\nbonito/bonito/crf/model.py at 0c7fcceeeca16e300ba427d737282b33d3cb8ec9 · nanoporetech/bonito · GitHub\ndef rnn_encoder(n_base, state_len, insize=1, first_conv_size=4, stride=5, winlen=19, activation=\u0026#39;swish\u0026#39;, rnn_type=\u0026#39;lstm\u0026#39;, features=768, scale=5.0, blank_score=None, expand_blanks=True, num_layers=5, norm=None): rnn = layers[rnn_type] return Serial([ conv(insize, first_conv_size, ks=5, bias=True, activation=activation, norm=norm), conv(first_conv_size, 16, ks=5, bias=True, activation=activation, norm=norm), conv(16, features, ks=winlen, stride=stride, bias=True, activation=activation, norm=norm), Permute([2, 0, 1]), *(rnn(features, features, reverse=(num_layers - i) % 2) for i in range(num_layers)), LinearCRFEncoder( features, n_base, state_len, activation=\u0026#39;tanh\u0026#39;, scale=scale, blank_score=blank_score, expand_blanks=expand_blanks ) ]) Configuration File (a.k.a config.toml) Take dna_r9.4.1_e8_hac@v3.3 (based on bonito/bonito/models/configs/dna_r9.4.1@v3.1.toml at 0c7fcceeeca16e300ba427d737282b33d3cb8ec9 · nanoporetech/bonito · GitHub ) as an example:\n[global_norm] # State Length of CRF, determine how many state CRF decoder need to consider state_len = 4 [input] features = 1 [labels] labels = [ \u0026#34;N\u0026#34;, \u0026#34;A\u0026#34;, \u0026#34;C\u0026#34;, \u0026#34;G\u0026#34;, \u0026#34;T\u0026#34;,] # labels of bases, N means empty state. [qscore] scale = 0.9356 bias = -0.1721 # bias factor of Q Score [model] package = \u0026#34;bonito.crf\u0026#34; # use CRF or CTC at decoder (since bonito v0.4, only CRF is valid) [encoder] scale = 5.0 rnn_type = \u0026#34;lstm\u0026#34; winlen = 19 features = 384 activation = \u0026#34;swish\u0026#34; stride = 5 # downsample stride blank_score = 2.0 [basecaller] # config when basecalling, don\u0026#39;t affect training batchsize = 512 chunksize = 10000 overlap = 500 CNN After the one-dimensional array of current is input, it will first go through three convolutions for feature extraction. The implementation code of the convolution is located here, it can be seen that it is a standard pytorch convolution implementation (Conv1d — PyTorch 2.4 documentation), there is nothing too special. But it should be noted that in order to speed up the calculation, Bonito sets the stride to 5 in the third convolutional layer, which downsamples the signal by 5 times (5000 -\u0026gt; 1000). Finally, the output of the convolutional layer is [64, 384, 1000] (batch, channel, signal_length).\nbonito/bonito/nn.py at 0c7fcceeeca16e300ba427d737282b33d3cb8ec9 · nanoporetech/bonito · GitHub\n@register class Convolution(Module): def __init__(self, insize, size, winlen, stride=1, padding=0, bias=True, activation=None, norm=None): super().__init__() self.conv = torch.nn.Conv1d(insize, size, winlen, stride=stride, padding=padding, bias=bias) self.activation = layers.get(activation, lambda: activation)() if isinstance(norm, dict): self.norm = from_dict(norm) elif isinstance(norm, str): self.norm = layers[norm](size) else: self.norm = norm def forward(self, x): h = self.conv(x) if self.norm is not None: h = self.norm(h) if self.activation is not None: h = self.activation(h) return h def to_dict(self, include_weights=False): res = { \u0026#34;insize\u0026#34;: self.conv.in_channels, \u0026#34;size\u0026#34;: self.conv.out_channels, \u0026#34;bias\u0026#34;: self.conv.bias is not None, \u0026#34;winlen\u0026#34;: self.conv.kernel_size[0], \u0026#34;stride\u0026#34;: self.conv.stride[0], \u0026#34;padding\u0026#34;: self.conv.padding[0], } if self.activation is not None: res[\u0026#34;activation\u0026#34;] = self.activation.name if self.norm is not None: res[\u0026#34;norm\u0026#34;] = to_dict(self.norm, include_weights) #simplify default case e.g. norm=\u0026#34;batchnorm\u0026#34; if not include_weights and self.norm.name in layers: if res[\u0026#34;norm\u0026#34;] == to_dict(layers[self.norm.name](res[\u0026#34;size\u0026#34;])): res[\u0026#34;norm\u0026#34;] = self.norm.name if include_weights: res[\u0026#39;params\u0026#39;] = { \u0026#39;W\u0026#39;: self.conv.weight, \u0026#39;b\u0026#39;: self.conv.bias if self.conv.bias is not None else [] } return res LSTM After feature extraction, the signal passes through a fully connected layer, and then enters the LSTM layer to learn the temporal relationship of signal features. The LSTM here is also based on the standard LSTM — PyTorch 2.4 documentation:\nbonito/bonito/nn.py at 91fb1408398fb3d8188621f1486281a2baa76318 · nanoporetech/bonito · GitHub\n@register class LSTM(RNNWrapper): def __init__(self, size, insize, bias=True, reverse=False): super().__init__(torch.nn.LSTM, size, insize, bias=bias, reverse=reverse) def to_dict(self, include_weights=False): res = { \u0026#39;size\u0026#39;: self.rnn.hidden_size, \u0026#39;insize\u0026#39;: self.rnn.input_size, \u0026#39;bias\u0026#39;: self.rnn.bias, \u0026#39;reverse\u0026#39;: self.reverse, } if include_weights: res[\u0026#39;params\u0026#39;] = { \u0026#39;iW\u0026#39;: self.rnn.weight_ih_l0.reshape(4, self.rnn.hidden_size, self.rnn.input_size), \u0026#39;sW\u0026#39;: self.rnn.weight_hh_l0.reshape(4, self.rnn.hidden_size, self.rnn.hidden_size), \u0026#39;b\u0026#39;: self.rnn.bias_ih_l0.reshape(4, self.rnn.hidden_size) } return res The shape of the LSTM output layer is [1000, 64, 384] (signal_length, batch, channel)\nCRF Encoder After the data leaves the LSTM, it will enter a fully connected layer to output a matrix for CRF decoding. From the code, we can see that this encoder only performs a non-linear transformation on the data, and rearranges the output.\nbonito/bonito/nn.py at 0c7fcceeeca16e300ba427d737282b33d3cb8ec9 · nanoporetech/bonito · GitHub\n@register class LinearCRFEncoder(Module): def __init__(self, insize, n_base, state_len, bias=True, scale=None, activation=None, blank_score=None, expand_blanks=True, permute=None): super().__init__() self.scale = scale self.n_base = n_base self.state_len = state_len self.blank_score = blank_score self.expand_blanks = expand_blanks size = (n_base + 1) * n_base**state_len if blank_score is None else n_base**(state_len + 1) self.linear = torch.nn.Linear(insize, size, bias=bias) self.activation = layers.get(activation, lambda: activation)() self.permute = permute def forward(self, x): if self.permute is not None: x = x.permute(*self.permute) scores = self.linear(x) if self.activation is not None: scores = self.activation(scores) if self.scale is not None: scores = scores * self.scale if self.blank_score is not None and self.expand_blanks: T, N, C = scores.shape scores = torch.nn.functional.pad( scores.view(T, N, C // self.n_base, self.n_base), (1, 0, 0, 0, 0, 0, 0, 0), value=self.blank_score ).view(T, N, -1) return scores The part with weights in the entire neural network ends here. The following CRF decoder does not include any weights. (Therefore, during training and inference, Bonito uses different decoders, which will be explained in detail later)\nCRF Decoder The core of the CRF Decoder is in this function:\nbonito/bonito/crf/basecall.py at 0c7fcceeeca16e300ba427d737282b33d3cb8ec9 · nanoporetech/bonito · GitHub\ndef compute_scores(model, batch, beam_width=32, beam_cut=100.0, scale=1.0, offset=0.0, blank_score=2.0, reverse=False): \u0026#34;\u0026#34;\u0026#34; Compute scores for model. \u0026#34;\u0026#34;\u0026#34; with torch.inference_mode(): device = next(model.parameters()).device dtype = torch.float16 if half_supported() else torch.float32 scores = model(batch.to(dtype).to(device)) if reverse: scores = model.seqdist.reverse_complement(scores) with torch.cuda.device(scores.device): sequence, qstring, moves = beam_search( scores, beam_width=beam_width, beam_cut=beam_cut, scale=scale, offset=offset, blank_score=blank_score ) return { \u0026#39;moves\u0026#39;: moves, \u0026#39;qstring\u0026#39;: qstring, \u0026#39;sequence\u0026#39;: sequence, } In compute_scores, scores is the matrix inferred by the aforementioned neural network, with a size of [64, 1000, 1024] (batch, current_length, state), $1024=4^5(4base^{4state+1})$. Then, if RNA is being sequenced, the score is reversed (this is also why the reference fasta needs to be reversed when training RNA). Finally, call koi (a non-open source CRF decoding package developed by ONT, which will be explained in detail below) beam_search to get moves (output which sampling point decoded a base, used for base sequence and current alignment reference), qstring (Q score string, encoded in numbers) and sequence (sequence, encoded in numbers).\nClose-sourced koi Package and Its Open Source Alternatives Since Bonito introduced CRF decoding, Bonito has encapsulated the beam search function into a close-sourced ont-koi package, which makes it impossible for us to understand the specific implementation of CRF decoding. But fortunately, ONT has included some CRF decoding logic in these two repos: GitHub - davidcpage/seqdist and GitHub - nanoporetech/fast-ctc-decode: Blitzing Fast CTC Beam Search Decoder. At the same time, ONT used the aforementioned open-source code in the old version of Bonito to build a usable compute_score workflow to handle the duplex part:\nbonito/bonito/cli/duplex.py at 91fb1408398fb3d8188621f1486281a2baa76318 · nanoporetech/bonito · GitHub\ndef compute_scores(model, batch, reverse=False): with torch.no_grad(): device = next(model.parameters()).device dtype = torch.float16 if half_supported() else torch.float32 scores = model.encoder(batch.to(dtype).to(device)) if reverse: scores = model.seqdist.reverse_complement(scores) betas = model.seqdist.backward_scores(scores.to(torch.float32)) trans, init = model.seqdist.compute_transition_probs(scores, betas) return { \u0026#39;trans\u0026#39;: trans.to(dtype).transpose(0, 1), \u0026#39;init\u0026#39;: init.to(dtype).unsqueeze(1), } def beam_search_duplex(seq1, path1, t1, b1, seq2, path2, t2, b2, alphabet=\u0026#39;NACGT\u0026#39;, beamsize=5, pad=40, T=0.01): env = build_envelope(t1.shape[0], seq1, path1, t2.shape[0], seq2, path2, padding=pad) return crf_beam_search_duplex( t1, b1, t2, b2, alphabet=alphabet, beam_size=beamsize, beam_cut_threshold=T, envelope=env, ) I have also referred to Marcus\u0026rsquo;s research on Bonito CRF decoding, and obtained a compute_score function implemented using ONT\u0026rsquo;s open source code. The function mainly needs to be modified in two places, as listed below:\nModify the backward_scores function to an open source implementation (the backward_score implementation before Bonito 0.5 can be used): bonito/bonito/crf/model.py at 0c7fcceeeca16e300ba427d737282b33d3cb8ec9 · nanoporetech/bonito · GitHub\nimport seqdist.sparse from seqdist.ctc_simple import logZ_cupy, viterbi_alignments from seqdist.core import SequenceDist, Max, Log, semiring def backward_scores(self, scores, S: semiring=Log): T, N, _ = scores.shape Ms = scores.reshape(T, N, -1, self.n_base + 1) beta_T = Ms.new_full((N, self.n_base**(self.state_len)), S.one) return seqdist.sparse.bwd_scores_cupy(Ms, self.idx, beta_T, S, K=1) Modify the compute_scores function, remember to import the corresponding packages: from fast_ctc_decode import crf_greedy_search def compute_scores(model, batch, beam_width=32, beam_cut=100.0, scale=1.0, offset=0.0, blank_score=2.0, reverse=False): \u0026#34;\u0026#34;\u0026#34; Compute scores for model. \u0026#34;\u0026#34;\u0026#34; with torch.inference_mode(): device = next(model.parameters()).device dtype = torch.float16 if half_supported() else torch.float32 scores = model(batch.to(dtype).to(device)) if reverse: scores = model.seqdist.reverse_complement(scores) # switch dim 1 \u0026amp; 2 scores_pad = scores.permute(1, 0, 2) # pad score n_base = model.seqdist.n_base T, N, C = scores_pad.shape scores_pad = torch.nn.functional.pad( scores_pad.view(T, N, C // n_base, n_base), (1, 0, 0, 0, 0, 0, 0, 0), value=blank_score ).view(T, N, -1) betas = model.seqdist.backward_scores(scores_pad.to(torch.float32)) trans, init = model.seqdist.compute_transition_probs(scores_pad, betas) trans = trans.to(torch.float32).transpose(0, 1) init = init.to(torch.float32).unsqueeze(1) # offload tracebacks = trans.cpu() init = init.cpu() seq_tensor = torch.zeros((N, T), dtype=torch.uint8, device=\u0026#39;cpu\u0026#39;) qstring_tensor = torch.zeros((N, T), dtype=torch.uint8, device=\u0026#39;cpu\u0026#39;) moves_tensor = torch.zeros((N, T), dtype=torch.uint8, device=\u0026#39;cpu\u0026#39;) for batch_idx in range(N): tracebacks_batch = tracebacks[batch_idx].numpy() # (T, 256, 5) init_batch = init[batch_idx][0].numpy() # (256,) # greedy decode, cef_beam_search dont output qstring seq_batch, path_batch = crf_greedy_search( network_output=tracebacks_batch, init_state=init_batch, alphabet=\u0026#34;NACGT\u0026#34;, qstring=True, qscale=1, qbias=1 ) # re-encode seq_batch_str = seq_batch[:len(seq_batch) // 2] qstring_batch_str = seq_batch[len(seq_batch) // 2:] seq_as_numbers = np.frombuffer(seq_batch_str.encode(), dtype=np.uint8).copy() qstring_as_numbers = np.frombuffer(qstring_batch_str.encode(), dtype=np.uint8).copy() seq_tensor[batch_idx, path_batch] = torch.from_numpy(seq_as_numbers[:len(path_batch)]) qstring_tensor[batch_idx, path_batch] = torch.from_numpy(qstring_as_numbers[:len(path_batch)]) moves_tensor[batch_idx, path_batch] = 1 return { \u0026#39;qstring\u0026#39;: qstring_tensor, \u0026#39;sequence\u0026#39;: seq_tensor, \u0026#39;moves\u0026#39;: moves_tensor, } It should be noted that the open-source implementation here has replaced beam_search with crf_greedy_search. Therefore, the accuracy of the basecaller may be slightly reduced. However, according to my tests, the accuracy only decreases by about 0.3%, which I think is not perfect but acceptable. At this point, the obtained qstring, sequence is a matrix with a length of current_length. Some indices are 0 (indicating that no new bases were decoded at this position), and the remaining indices are numbers (number-encoded ATCG bases or q string scores).\nStitching Basecaller Results and Outputting Characters Due to the limited window size of the neural network, when encountering long sequences of current, the current will be split into short sequences according to the chunksize and overlap given in the network configuration. Therefore, after completing the decoding, the obtained qstring, sequence and moves need to be re-stitched together according to read_id by the stitch_results function.\nAfter stitching, the sequence will be decoded back to the base sequence/Q Score through decoding functions such as path_to_str. Finally, after formatting, it can be output as fastq, or after going through mappy once, it can be output as an aligned sam/bam file.\nTraining Bonito Dataset Structure Referencing the official documentation of Bonito 0.8.1, we need at least three .npy files to construct a training basecaller dataset (assuming that the length of each current segment used during training is chunksize). Referencing Bonito\u0026rsquo;s download.py, Bonito currently provides three training datasets, listed below:\nUrl flowcell https://cdn.oxfordnanoportal.com/software/analysis/bonito/example_data_dna_r9.4.1_v0.zip dna_r9.4.1 https://cdn.oxfordnanoportal.com/software/analysis/bonito/example_data_dna_r10.4.1_v0.zip dna_r10.4.1 https://cdn.oxfordnanoportal.com/software/analysis/bonito/example_data_rna004_v0.zip rna004 Each downloaded and decompressed dataset contains three .npy files:\nFilename Shape Purpose references.npy (data_length, max_len_of_reference) uint8 Stores the sequence corresponding to each signal chunk, encoded using rules such as {'A': 1, 'C': 2, 'G': 3, 'T': 4} for ATCG, with the remaining positions padded with 0 reference_lengths.npy (data_length,) uint8 Stores the length of the sequence corresponding to each signal chunk (the part not padded with 0) chunks.npy (data_length, chunksize) float32 Stores the current signal of each signal chunk Optionally, the dataset folder can also contain a folder named validation_sets. If this folder exists, the references.npy, reference_lengths.npy, and chunks.npy inside it will be used as the validation set.\nTraining-related Commands # bonito train positional arguments: training_directory optional arguments: -h, --help show this help message and exit --config CONFIG --pretrained PRETRAINED --directory DIRECTORY --device DEVICE --lr LR --seed SEED --epochs EPOCHS --batch BATCH --chunks CHUNKS --valid-chunks VALID_CHUNKS --no-amp -f, --force --restore-optim --nondeterministic --save-optim-every SAVE_OPTIM_EVERY --grad-accum-split GRAD_ACCUM_SPLIT --quantile-grad-clip --num-workers NUM_WORKERS Loss Function Calculation During Training Unlike the CRF used during inference, Bonito does not use the previously mentioned compute_score function as the decoder and loss function during training.\nbonito/bonito/crf/model.py at 0c7fcceeeca16e300ba427d737282b33d3cb8ec9 · nanoporetech/bonito · GitHub\ndef decode_batch(self, x): scores = self.seqdist.posteriors(x.to(torch.float32)) + 1e-8 tracebacks = self.seqdist.viterbi(scores.log()).to(torch.int16).T return [self.seqdist.path_to_str(x) for x in tracebacks.cpu().numpy()] Instead, it uses seqdist\u0026rsquo;s viterbi search to directly obtain the sequence, and then compares it with the standard reference sequence to obtain an accuracy.\nTraining Command bonito train \\ --config config.toml \\ # The model config mentioned earlier, chunksize, etc., will be automatically read from the dataset --device cuda:0 \\ # GPU --epochs 5 # epoch --lr 5e-4 \\ # learning rate --batch 96 \\ # batchsize --pretrained dna_r10.4.1_e8.2_400bps_hac@v5.0.0 \\ # Existing model, you can select from the models provided by ONT, or pass in the directory where other models are located --directory dataset_dir/ \\ # Folder containing chunks.npy, etc. model_dir/ This command initiates the training process. Let\u0026rsquo;s break down the key components:\nbonito train: This is the main command to start the training of a Bonito model. --config config.toml: This specifies the configuration file for the model. This file defines various parameters like the network architecture, number of states for CRF, input/label configurations, learning rate, and more. The config.toml file was described in detail earlier. --device cuda:0: This argument tells Bonito to use the first CUDA-enabled GPU (if available). If you have multiple GPUs, you can specify a different ID (e.g., cuda:1). If you want to train on CPU, you can use cpu as an argument, but training on GPU will be significantly faster. --epochs 5: This sets the number of training epochs, indicating how many times the entire training dataset will be passed through the model. --lr 5e-4: This sets the learning rate for the optimizer. A lower learning rate can result in finer tuning of the weights but may also require more training epochs. --batch 96: This specifies the batch size, i.e., the number of training examples that the model will process in each iteration. Larger batch sizes can utilize GPU resources more efficiently, but may also lead to memory issues, particularly with smaller GPUs. --pretrained dna_r10.4.1_e8.2_400bps_hac@v5.0.0: This crucial parameter specifies the model that will be used as a starting point. This leverages transfer learning, enabling you to train more quickly and effectively. You can use ONT\u0026rsquo;s pre-trained models, like the example provided (dna_r10.4.1_e8.2_400bps_hac@v5.0.0) or point to a custom pre-trained model. --directory dataset_dir/: This points to the directory containing the training dataset. Bonito expects the training data to be in the format explained in the \u0026ldquo;Dataset Structure\u0026rdquo; section. It will automatically load the chunks.npy, references.npy, and reference_lengths.npy from the provided directory, and potentially validation data from the validation_sets subfolder. model_dir/: Finally, model_dir/ is the directory where the trained model (including model weights) and training checkpoints will be saved. ","permalink":"https://blog.sparktour.me/en/posts/2024/09/25/a-look-at-nanopore-basecaller-bonito/","summary":"Bonito, named after the bonito fish, is a basecaller developed by Oxford Nanopore Technology. In this article, I will try to explain, in an easy-to-understand way, the data flow and data formats of Bonito, as well as some knowledge needed for the secondary development of Bonito (or even other nanopore sequencing basecallers).","title":"A Look at the Nanopore Basecaller: Bonito"},{"content":"This trip was another 4-day trip utilizing my summer weekend, departing for Seoul on Friday and returning Sunday night.\nThis article uses experimental HDR AVIF. Banding issues may occur in some browsers (commonly on Android). Please urge chromium to fix this. Pre-Trip Preparations Visa Compared to Japanese visas, Korean visas are relatively easy to apply for, and for university graduates, it\u0026rsquo;s practically a \u0026ldquo;click and get\u0026rdquo; process. University graduates only need a graduation certificate from CHSI (China Higher-education Student Information and Career Center) and their ID card to apply for a 5-year multiple-entry Korean visa. Visa applications can be submitted offline at various \u0026ldquo;Korea Visa Application Centers\u0026rdquo; (such as the Guangzhou Center). Postal applications are also possible (but require sending the original ID card and incur a small mailing fee; apply offline if you have concerns). As of summer 2024, no appointment is needed for offline applications; just go to the visa center after it opens in the morning and get a number.\nFlights My friend and I purchased Greater Bay Airlines tickets, HKG-ICN roundtrip for about 1100 CNY. For a detailed flight experience with Greater Bay Airlines, refer to this blog post: First Experience with Greater Bay Airlines: More Like a Budget Airline on the Hong Kong-Tokyo Route (hee.ink). In short, it\u0026rsquo;s a budget airline with pre-selectable seats and a complimentary bottle of water, similar to a full-service airline\u0026rsquo;s intra-European flight. It\u0026rsquo;s worth mentioning that upon checking in at the counter for our return flight, we were offered a free upgrade to emergency exit seats, which was a plus.\nAccommodation We booked a guesthouse near Seoul Station on Agoda (R Guesthouse Seoul Station). The stay was quite pleasant, costing about 190 USD for 3 nights.\nInternet/Power/Essentials I bought a SIM card from a random seller on Taobao for about 20-30 CNY for 3 days. While advertised as unlimited data, it was speed-capped at around 10Mbps, which was sufficient.\nKorea uses 220V/60Hz power, similar to mainland China. The outlets are European standard, so a European adapter purchased online, paired with a charger usable in mainland China, works perfectly.\nPayment Credit cards are accepted almost everywhere except for subways and buses. I only used the Korean Won I exchanged to top up my transportation card. The T-Money card can be used on subways and buses in Seoul and Busan and is available at subway entrances in the airport and some convenience stores. T-Money also offers an HCE card emulation app, KOREA TOUR CARD Tmoney, downloadable on some Android phones. This app allows top-ups with foreign credit cards (with a fee).\nNavigation Due to Korea\u0026rsquo;s restrictions on geographic information, Google Maps and Apple Maps don\u0026rsquo;t function optimally for route planning in Korea, with significant POI omissions. I recommend downloading a local Korean map app like Naver Map (website is in Korean only, but the app has Chinese, English, and Japanese versions). Naver Map is also useful for finding restaurants, as it has comprehensive reviews.\nItinerary Day 1 Hong Kong - Seoul Immigration in Seoul took about an hour (Korea still requires a handwritten arrival card), including fingerprinting. After immigration, you can take the slower but cheaper AREX All Stop Train (similar to a subway, you can buy a T-money card at a nearby vending machine), or the faster AREX Express Train (more expensive, but can be purchased cheaper on OTA websites).\nThat evening, we ate at Cheiljemyunso near Seoul Station, having naengmyeon (cold noodles) and dumplings. I didn\u0026rsquo;t expect ice cubes in the naengmyeon, which might not be suitable for those with sensitive stomachs, but the chilled noodles were indeed chewier.\nNaengmyeon Set Later, we went to N Seoul Tower. Combined tickets for the cable car and tower access can be purchased on OTA websites. Unfortunately, it was cloudy, so we only saw the evening sky, no sunset.\nSeoul Station Bus Hub Namsan Cable Car Seoul Tower and Night View Namsan Cable Car Station Seoul Station Bus Hub at Night Day 2 Busan Early next morning, we took the KTX train to Busan from Seoul Station. KTX tickets can be purchased on some OTA websites (like Trip.com, with a fee) or through the \u0026ldquo;Korail Korea Rail Ticket\u0026rdquo; mini-program on WeChat/Alipay (no fee). The purchase process is similar to mainland China: select the train, seat, fill in your name, and pay. Most tickets can be fully refunded up to 24 hours before departure (OTAs might charge a fee).\nSeoul Station KTX Platform Boarding the KTX is similar to Europe. No pre-boarding ticket check is required; just go directly to the platform and wait. The conductor might randomly check tickets onboard; just show the QR code on your ticket.\nKTX Train Car After arriving at Busan Station, we went to the Cheongsapo area. There\u0026rsquo;s a tram and a small monorail-like train that offers scenic views.\nBusan Bus (Most buses in Korea are Hyundai) View from the Train You can search for Cheongsapo Station (해운대블루라인파크 청사포정거장) for navigation. Take a bus from the bus stop outside Busan Station (get off near an SK dormitory and walk about 10 minutes).\nFishing Boats and Sea Fog Breakwater and Lighthouse If you don\u0026rsquo;t want to take the train, you can stroll along the coastal walkway. It was quite foggy when we went, but it cleared up around 10 am. This coast is quite close to Tsushima Island in Japan (less than 100km). I wonder if it\u0026rsquo;s visible on a clear day.\nTram Capsule Train (Top Right) The coastal walkway leads to Mipo Beach, with street food stalls nearby. I had a typical Korean hot pot at the food court of Shinsegae Department Store Centum City for lunch.\nMipo Beach Street Food Stalls and Shops I spent the afternoon wandering around the city center.\nLotte Department Store Subway Vendors Busan Subway (Similar to Beijing Subway Stations Built in the 1990s) We returned to Seoul on the evening KTX.\nSafari Ad in Seoul Station Since there were only fast food options near the station, we tried convenience store ready-made meals and sundae (blood sausage) from a nearby stall (the name was something like \u0026ldquo;Locomotive Tteokbokki,\u0026rdquo; but it was too spicy for me).\nCheese Sweet and Spicy Rice from a Convenience Store (Korean sauces seemed to all have this sweet and spicy flavor, which got a bit tiring after a few days) Day 3 Seoul Cheong Wa Dae (Blue House) and Gyeongbokgung Palace We visited Cheong Wa Dae and Gyeongbokgung Palace. Since the presidential office and residence have moved out of Cheong Wa Dae, it\u0026rsquo;s been open to the public since 2023. Advance reservations are required on the website.\nCheong Wa Dae Exterior Painting of the Korean Peninsula inside Cheong Wa Dae Presidential Residence Gyeongbokgung Palace is south of Cheong Wa Dae and can be reached on foot. Its architectural style is similar to Greater China\u0026rsquo;s. A major difference from ancient Chinese palaces is that Gyeongbokgung\u0026rsquo;s grounds are unpaved, primarily sand and earth.\nGyeongbokgung Palace Gwanghwamun Gate Statue of Admiral Yi Sun-sin facing Gwanghwamun Gate (이순신 장군 동상) We had beef and glass noodle soup for lunch at a roadside restaurant (Geumseonggwan Naju Gomtang 금성관 나주곰탕). I found it delicious, but my friend thought the portion was too small.\nBeef and Glass Noodle Soup The War Memorial of Korea We spent the afternoon at the War Memorial of Korea, which primarily presents the Korean perspective on the Korean War.\nFlags of UN Participating Countries Outside the War Memorial Painting inside the War Memorial depicting Pyongyang citizens welcoming Syngman Rhee We explored the Hongdae shopping district in the evening and had Korean BBQ at (Yukmong Hongdae Main Branch 육몽 홍대본점, reservations are recommended on Naver Map) (about 700 CNY for two).\nDay 4 Seoul - Hong Kong Distant View of Victoria Harbour The weather and visibility were excellent during our return flight, and we had a great view of Victoria Harbour from the plane.\nClose View of Victoria Harbour Sunset from the Airport Bus ","permalink":"https://blog.sparktour.me/en/posts/2024/08/01/2024-korea-trip/","summary":"\u003cp\u003eThis trip was another 4-day trip utilizing my summer weekend, departing for Seoul on Friday and returning Sunday night.\u003c/p\u003e\n\n \n\u003cdiv class=\"callout callout-info\"\u003e\n    This article uses \u003ca href=\"https://zhuanlan.zhihu.com/p/630463136\"\u003eexperimental HDR AVIF\u003c/a\u003e.  Banding issues may occur in some browsers (commonly on Android). Please urge \u003ca href=\"https://issues.chromium.org/issues/328687167\"\u003echromium\u003c/a\u003e to fix this.\n\u003c/div\u003e\n\n\u003ch1 id=\"pre-trip-preparations\"\u003ePre-Trip Preparations\u003c/h1\u003e\n\u003ch2 id=\"visa\"\u003eVisa\u003c/h2\u003e\n\u003cp\u003eCompared to Japanese visas, Korean visas are relatively easy to apply for, and for university graduates, it\u0026rsquo;s practically a \u0026ldquo;click and get\u0026rdquo; process.  University graduates only need a \u003cstrong\u003egraduation certificate from CHSI (China Higher-education Student Information and Career Center) and their ID card\u003c/strong\u003e to apply for a 5-year multiple-entry Korean visa.  Visa applications can be submitted offline at various \u0026ldquo;Korea Visa Application Centers\u0026rdquo; (such as the \u003ca href=\"https://www.visaforkorea-gz.com/\"\u003eGuangzhou Center\u003c/a\u003e).  Postal applications are also possible (but require sending the original ID card and incur a small mailing fee; apply offline if you have concerns). As of summer 2024, no appointment is needed for offline applications; just go to the visa center after it opens in the morning and get a number.\u003c/p\u003e","title":"Korea Trip: A Typical Northeast Asian Metropolis"},{"content":"This weekend trip was sparked by my friend getting a student discount on a hkexpress flight, with round-trip tickets for each of us costing just 1300HKD. Considering our limited travel time, we decided to stick to the Kansai region of Japan, focusing on Osaka and Kyoto.\nThis article contains experimental HDR AVIF image, which may cause color banding issues in some browsers (commonly seen on Android). This is a known browser issue. Pre-Trip Preparations Visa University/graduate students or graduates within three years in Mainland China can apply for a single-entry visa using their student ID and a report from the China Higher Education Student Information and Credit System (CHSI, 学信网). Since Japan has started issuing e-visas, some travel agencies in Guangdong don\u0026rsquo;t even require sending your passport, and all documents can be uploaded online. After uploading your documents, you will receive your evisa within 7-10 working days. It is valid for three months and allows for a 15-day stay.\nFlight My friend purchased student tickets from hkexpress during a promotion, costing around 1300HKD/person round-trip. However, you should note that hkexpress is a low-cost carrier. There are no free meals or drinks on board, and they discourage bringing your own food (although they are not strict about it in practice). Also, the seat spacing on hkexpress is slightly smaller than full-service airlines. On their A320/A321neo aircraft, the seatbacks are not adjustable.\nHotel My friend and I booked a capsule hotel in Osaka (details below) and a regular hotel in Kyoto on booking.com.\nMobile Network/Power/Essentials to Bring I bought a SIM card on Fliggy, which was a random selection. A 4-day (natural days) / 2GB-per-day package cost around 25 yuan. I noticed that many merchants sell Joytel SIM cards. This card seems to have multiple IMSI capabilities and can automatically switch IMSIs based on your location to avoid roaming charges. It connects to Softbank\u0026rsquo;s network in Japan, and the speed is decent, around 40Mbps.\nThe Kansai region of Japan uses 100V/50Hz power. If you only need to charge your phone or laptop, most chargers support wide voltage. However, be aware that some chargers (like Baseus Gan Pro 3) and adapters with power plugs (similar to power strips) might only have a voltage range of 110V-240V or 200V-240V. In Kansai, where the voltage is 100V, they might not start due to low voltage. My Gan Pro 3 charger encountered this problem, but my other Apple-branded charger worked fine.\nPayment Traffic cards can be used on trains, subways, and buses. Most convenience stores accept credit cards, traffic cards, WeChat Pay, Alipay, and cash. Larger restaurants accept credit cards, WeChat Pay, and Alipay. Temples and some small restaurants may only accept cash. If you are not eating anything too expensive and only encounter a few cash-only restaurants, 10,000 yen per person should be enough.\nFor transportation cards, I recommend using an iPhone to get a Suica card (Japan also has an IC Card Alliance, making transportation cards nationwide). You can recharge Suica with cash or a credit card via Apple Pay. You can also use UnionPay cards issued in mainland China.\nItinerary You can refer to the map below. We only had two full days during our weekend trip, so we spent half a day in Osaka and the rest in Kyoto.\nDay 1 Kansai Airport - Osaka My friend and I both flew from Shenzhen to Hong Kong for our connection to Japan. Currently, you can use your passport for self-service customs clearance at the Shenzhen port, and no border control officers will intervene to force you to use the manual lane or check your passport. You still need to fill out an immigration declaration form and use the manual lane when entering the Hong Kong side, but you can use self-service for airport departure.\nSunset over the Pacific Ocean Kyoto Railway Museum Kobe Airport After arriving at Kansai Airport, you can take the Airport Rapid Service (HARUKA) to the city center. Consider purchasing tickets online in advance from some online travel agents (OTAs), which are usually cheaper than buying them at the ticket machines. If you don\u0026rsquo;t purchase online, you can buy tickets at the ticket machines using cash or your transportation card.\nHARUKA Train Car Tennoji Capsule Hotel I stayed at the Grand Sauna Shinsaibashi （グランドサウナ心斎橋） that night. The hotel offers small single rooms without toilets (pictured below). It is quite quiet once you close the curtains at night. The hotel also has a hot spring pool, a sauna, and a bathhouse, but be aware that the bathhouse stalls do not have curtains, making it more like a traditional northern Chinese bathhouse.\nCapsule Hotel Single Room Capsule Hotel Public Restroom After checking in, my friend and I went for a walk around Shinsaibashi and Dotonbori. However, it was late, and most of the shops on both sides of Shinsaibashi were closed. We ended up having dinner and a late-night snack at an Ichiran Ramen restaurant next to Shinsaibashi.\nShinsaibashi-suji Shinsaibashi Intersection Dotonbori Ichiran Ramen Ordering at Ichiran Ramen is incredibly friendly for social anxiety sufferers. When you enter, you first use the self-service ordering machine. After receiving your ticket, you join the queue. Once you enter the internal booths, you hand the ticket to the staff inside. You don\u0026rsquo;t need to say a word throughout the entire process.\nDay 2 Osaka - Kyoto Stop Sign by the Roadside. Many stop signs in Japan don\u0026rsquo;t have STOP, only \u0026ldquo;止まれ\u0026rdquo;. Self-Service Parking Lot by the Roadside. The highway is above it. Osaka Castle View of Osaka Castle from \u0026ldquo;Honmaru Japanese Garden\u0026rdquo; (a small garden next to the castle) Osaka Castle was the residence of Toyotomi Hideyoshi and the center of the Toyotomi government during the Azuchi-Momoyama period of national unification. Later, Tokugawa Ieyasu destroyed the Toyotomi clan in two Battles of Osaka (Winter Siege and Summer Siege). After that, the Edo Shogunate made Osaka Castle a key base for controlling the daimyō in western Japan. However, the Osaka Castle keep we see today is a \u0026ldquo;replica\u0026rdquo; built in 1930 (reinforced concrete structure). The keep requires a ticket to enter. You can purchase tickets online in advance, which is slightly cheaper than buying them on-site. Inside, there are some exhibitions and paintings related to Toyotomi Hideyoshi. On the roof, there is an observation deck with views of surrounding Osaka buildings.\nOsaka Castle After visiting the keep, you can head north from Osaka Castle to Osaka Castle Park Station and take a train to Osaka Station.\nUmeda Department Store, Osaka Station Osaka Station (Entrance near Umeda Department Store) For lunch, we went to Umeda Department Store (near Osaka Station) and ate at an eel rice restaurant (Unagi-no Nakasho Links Umeda). Based on Google review recommendations, we ordered their white-grilled eel rice and traditional grilled eel rice. We found that the white-grilled or grilled eel tasted good with one or two pieces, but it became a bit too greasy after that. It might be better to share an order with a friend. It cost around 4300JPY per person. White-Grilled Eel Rice After lunch, we went to the nearby electronics store ( Yodobashi Multimedia Umeda Store) to browse. The style of the promotional boards and the store itself felt very different from electronics stores in mainland China, giving a sense of \u0026ldquo;it\u0026rsquo;s Japan when you see it.\u0026rdquo; We wanted to go to the bottom floor to ask if they had tax-free phones, but the lower floor seemed to be full of contract phones, and they weren\u0026rsquo;t tax-free, so we gave up.\nSmall Appliance Section Audiovisual Disc Section From Osaka Station to Kyoto, you can take any train that is not HARUKA, which takes about half an hour to get to Kyoto Station.\nKyoto Railway Museum The Kyoto Railway Museum is just one train stop from Kyoto Station. The museum displays several locomotive heads and carriages. You can even board a 0-series Shinkansen.\nThe museum has a demonstration ticket machine where you can print out a magnetic ticket for \u0026ldquo;Kyoto Railway Museum Station\u0026rdquo; In the evening, we bought a box of \u0026ldquo;Kobe beef rice\u0026rdquo; (around 1300JPY) from a bento shop at Kyoto Station. The heating method is similar to self-heating rice, and the taste is similar to beef rice from Yoshinoya/Sukiya: Kobe Beef Rice Bento Evening Snapshots We found a ramen restaurant ( Daikoku Ramen Tofukuji Store) near Tofukuji Station and had a late-night ramen. The taste was decent, and it was very affordable. A basic ramen only cost 500+JPY, and they only accepted cash.\nRamen for Late Night Day 3 Kyoto Kiyomizu-dera Temple Following a guide on Xiaohongshu, we got an early start (meaning we left at 07:45 and reached the mountain gate by 08:30) and visited Kiyomizu-dera Temple first. The temple was indeed less crowded in the morning, making the experience much better. Entrance to Kiyomizu-dera requires a ticket, which it seems you can only purchase on-site at the ticket office.\nKiyomizu-dera Temple Inside the main hall, you can buy charms and draw lots (Japanese lot-drawing is different from Chinese methods. The lot box is opaque, and the drawer shakes the box before a lot falls out of a hole. In contrast, Chinese methods require shaking the box until a lot falls out). After drawing a lot, they will give you a piece of paper, which you can use to check the fortune online.\nStructure Built into the Mountain Yasaka Shrine Yasaka Shrine Taxi on the Road at the Main Entrance Fushimi Inari Shrine Fushimi Inari Shrine is famous for its thousand torii gates. However, unless you go very early, it will be difficult to capture photos like those in travel books because the path under the torii gates is extremely crowded.\nThousands of Torii Gates You can also buy charms and draw lots at Fushimi Inari Shrine. It is said that the \u0026ldquo;lucky\u0026rdquo; rate of the lots here is higher than at Kiyomizu-dera.\nLarge Torii Gate at the Entrance Daytime Snapshots For lunch, we went to Kaiten-zushi Ginza Onodera Kyoto Store for sushi. This is a conveyor belt sushi restaurant run by a Michelin-starred restaurant (you can consider it a budget version. From my observation, the prices are about double that of Genki Sushi, but it tastes a lot better). The restaurant\u0026rsquo;s seating is similar to conveyor belt sushi, but customers actually order using tablets at their seats, and the sushi is delivered via conveyor belt. The interesting thing about this restaurant is that you can choose whether to add wasabi to the sushi during preparation, making it taste better than dipping it afterwards. Also, based on Google reviews, it\u0026rsquo;s recommended to arrive early, as some ingredients may be unavailable later in the day.\nDay 4 Return to Hong Kong Tickets from Kyoto to Kansai Airport are cheaper when purchased from OTAs. After purchasing, you need to scan the QR code at a green machine with a passport reader to redeem your ticket. You can refer to the JR West article for the redemption process. In the morning, we took the HARUKA to Kansai Airport as planned and returned to Hong Kong. However, due to a malfunction on another train on the route (apparently someone was hit), the train was delayed by about an hour. Our reserved seats had to be downgraded to the non-reserved section.\nReturn to Kansai Airport Onaruto Bridge Hong Kong-Zhuhai-Macau Bridge. You can faintly see Zhuhai and the HZM Bridge artificial island on the left. ","permalink":"https://blog.sparktour.me/en/posts/2024/05/25/2024-japan-kansai-trip/","summary":"\u003cp\u003eThis weekend trip was sparked by my friend getting a student discount on a hkexpress flight, with round-trip tickets for each of us costing just 1300HKD.  Considering our limited travel time, we decided to stick to the Kansai region of Japan, focusing on Osaka and Kyoto.\u003c/p\u003e\n\n \n\u003cdiv class=\"callout callout-info\"\u003e\n    This article contains experimental HDR AVIF image, which may cause color banding issues in some browsers (commonly seen on Android). This is a known browser issue.\n\u003c/div\u003e\n\n\u003ch1 id=\"pre-trip-preparations\"\u003ePre-Trip Preparations\u003c/h1\u003e\n\u003ch2 id=\"visa\"\u003eVisa\u003c/h2\u003e\n\u003cp\u003eUniversity/graduate students or graduates within three years in Mainland China can apply for a single-entry visa using their student ID and a report from the China Higher Education Student Information and Credit System (CHSI, 学信网). Since Japan has started issuing e-visas, some travel agencies in Guangdong don\u0026rsquo;t even require sending your passport, and all documents can be uploaded online.  After uploading your documents, you will receive your evisa within 7-10 working days.  It is valid for three months and allows for a 15-day stay.\u003c/p\u003e","title":"A Weekend Trip to Kansai, Japan"},{"content":"Many people applying for Schengen visas have heard of the Visa Information System (VIS). VIS allows Schengen countries to exchange visa data. It consists of a central IT system and the communication infrastructure connecting this central system to national systems. It processes data and decisions related to applications for short-stay visas for visiting or transiting the Schengen area. The system can perform biometric matching (mainly fingerprints) for identification and verification purposes. A common use in Schengen visa applications is to store applicants\u0026rsquo; fingerprints (so that applicants only need to provide them once every 5 years).\nThe introduction of VIS also mentions that \u0026ldquo;Data is kept in the VIS for five years. This retention period is calculated from the expiry date of the visa issued, the date of the decision to refuse a visa or the date of the decision to amend a visa issued. Any person has the right to be informed about his/her data in the VIS. Any person may request rectification of inaccurate data concerning him/her and deletion of unlawfully recorded data.\u0026rdquo; However, it is difficult to find information online about how individuals can obtain this data from immigration authorities. In this article, I attempt to apply to the French Consulate General in China for personal data from a previous Schengen visa application, and also attempt to answer the rumor of whether \u0026ldquo;travel plans and other supporting documents submitted are stored in VIS\u0026rdquo;.\nSubmitting a Data Export Request Taking France as an example, according to CNIL (similar to the Office of the Privacy Commissioner for Personal Data in Hong Kong), if the applicant resides outside of France, the corresponding data export request should be submitted to the local embassy. Therefore, I first sent an email to the visa-related consultation mailbox of the French Consulate General in Guangzhou (visas.canton-FSLT@diplomatie.gouv.fr, which can be found at https://cn.ambafrance.org/-Consulat-Canton- ) ( The automatic reply email from the French Consulate mentions that consultation must include full name, date of birth, passport number and phone number, otherwise it may not be replied, I am not sure if this is necessary):\nDear Consular Officer,\nI hope this message finds you well. My name is [NAME] (Date of Birth [DOB]), Passport Number [PN]), and I applied for a Schengen visa through the French Consulate in Guangzhou (VISA No. FRAXXXXX). In line with my rights and following the instructions from CNIL (Commission Nationale de l’Informatique et des Libertés https://www.cnil.fr/en/visa-information-system-vis ), I wish to access the information about me entered into the VIS and any other national data system that stores information related to my visa application and entry/exit record.\nCould you kindly guide me on:\n​ • The appropriate contact or department for this request.\n​ • Any specific documents I should provide for verification.\n​ • The necessary procedures I should follow.\nI truly appreciate your assistance and patience in this matter.\nA few days later, I received a reply from the Consulate mentioning that I need to send a letter to the Consulate, including a photocopy of my passport, a photocopy of my ID card and a signed application, and they will forward my request to France (Please send us a formal signed mail stating your request with a photocopy of your passport and identification and we will forward this to the headquaters in France).\nThen, I prepared a photocopy of my passport, a photocopy of my ID card, a photocopy of my visa (black and white is enough), and a letter applying for data export. The data export application letter was written based on the data export applicationPDF of Slovenia:\nDear Officer,\nAccording to Art. 38 of the Regulation (EC) No 767/2008 of the European Parliament and of the Council of 9 July 2008 concerning the Visa Information System (VIS) and the exchange of data between Member States on short-stay visas (VIS Regulation) in connection with Art. 15 of the Regulation (EU) 2016/679 of the European Parliament and of the Council of 27 April 2016 on the protection of natural persons with regard to the processing of personal data and on the free movement of such data, and repealing Directive 95/46/EC (General Data Protection Regulation), I hereby demand:\n- Information about the personal data relating to me being processed in the Visa Information System (VIS).\n(If EES is established in the future, you can also apply for your entry and exit data here)\nThen I attached my personal information: name, passport, address, date of birth, nationality, visa number\nI sent these materials by registered mail and sent an email to remind the Consulate.\nReceiving the Exported Data After one month, I received another email from the Consulate, with a PDF attached, which contains the exported VIS data.\nFile Cover The file includes 5 chapters: photo, applicant\u0026rsquo;s basic information, applicant\u0026rsquo;s citizenship, travel document information, visa information (fields with information are marked with a *, but personal information is hidden):\nOriginal English Translation or Brief Explanation Information N° Number FRA* Pays autorité de saisie Authority of the receiving country China (Central Authority) Lieu autorité de saisie Place of reception Guangzhou Nom autorité de saisie Name of the receiving institution Ministry of Foreign Affairs Type autorité de saisie Type of receiving institution Consulate Lieu dépôt Place of application submission Guangzhou Pays dépôt Country where the application was submitted China (Central Authority) Date demande Request date * Type demande visa Type of visa request Statut Status Visa Issued Motif séjour Reason for stay Durée prévue du séjour / transit Expected duration of stay/transit État membre responsable Responsible member state France Autorité représentée Authority represented Exemption prise empreintes Fingerprint exemption No Prise d\u0026rsquo;empreintes impossible Unable to collect fingerprints No Raisons absence empreintes Reasons for lack of fingerprints Personne invitante Inviter Nom Name * Prénom First name * Adresse Address Compagnie invitante Inviting company Nom compagnie invitante Company name Hotel where you stayed Adresse compagnie invitante Company address * * Prénom personne à contacter Contact person\u0026rsquo;s first name * Détails du Séjour Details of the Stay Destination principale Main destination Date arrivée Arrival date * Date prévue départ Expected departure date * Frontière première entrée prévue Expected first entry border Route prévue transit Planned transit route 3. Etat civil du demandeur Civil status of the applicant Nom Surname * Nom de naissance Name at birth Ancien noms de famille Previous surnames Prénoms Given names * Sexe Gender * Age Age * Date naissance Date of birth * Ville naissance City of birth * Pays naissance Country of birth China Nationalité actuelle Current nationality Chinese Nationalité naissance Nationality at birth Profession Profession * Nom employeur Employer name Nom établissement scolaire School name Adresse Address Nom autorité parentale / tuteur Name of parent/guardian Prénom autorité parentale / tuteur First name of parent/guardian 4. Document de voyage Travel document Type Type Ordinary passport N° Number * Pays de délivrance Issuing country Date délivrance Issuing date * Ressortissant Nationality Date fin de validité Expiration date * Original English Translation or Brief Explanation Information Visa Visa Visa Statut Status Visa émis Pays autorité de délivrance Authority of the issuing country CHINE (Autorité centrale) Nom autorité de délivrance Name of the issuing institution Ministère des Affaires Étrangères Lieu autorité de délivrance Place of the issuing institution Canton Type autorité de délivrance Type of issuing institution Poste Consulaire Date délivrance Issuing date * Lieu délivrance Place of issue Canton Pays délivrance Country of issue CHINE (Autorité centrale) Etat membre responsable Responsible member state FRANCE Autorité représentée Authority represented Date création décision Decision creation date * N° Number FRA* Délivrance sur feuillet séparé Issued on separate sheet FAUX Territoire autorisé à circulation Territory authorized for circulation ETATS SCHENGEN Valable pour Valid for ETATS SCHENGEN Type Type (C: Short stay) C : court séjour Date début validité Start date of validity * Date fin de validité Expiration date * Durée de validité Duration of validity * Nombre entrées autorisées Number of permitted entries Plusieurs Durée séjour autorisé Allowed duration of stay * Conclusion It can be seen that the exported information from VIS only includes the applicant\u0026rsquo;s own document information and the information of the inviter in the application country. It does not include more information about the travel plan, flight booking and other attachments submitted during the application. However, it is not excluded that the embassy/consulate that reviews the application will store these attachments separately in other places (but at least they should not be shared with other Schengen review institutions, nor will they be displayed to border control officers at ports of entry).\n","permalink":"https://blog.sparktour.me/en/posts/2024/04/10/export-schengen-vis-info/","summary":"\u003cp\u003eMany people applying for Schengen visas have heard of the \u003ca href=\"https://home-affairs.ec.europa.eu/policies/schengen-borders-and-visa/visa-information-system_en\"\u003eVisa Information System (VIS)\u003c/a\u003e. VIS allows \u003ca href=\"https://home-affairs.ec.europa.eu/policies/schengen-borders-and-visa/schengen-area_en\"\u003eSchengen countries\u003c/a\u003e to exchange visa data. It consists of a central IT system and the communication infrastructure connecting this central system to national systems. It processes data and decisions related to applications for short-stay visas for visiting or transiting the Schengen area. The system can perform biometric matching (mainly fingerprints) for identification and verification purposes. A common use in Schengen visa applications is to store applicants\u0026rsquo; fingerprints (so that applicants only need to provide them once every 5 years).\u003c/p\u003e","title":"Exporting Your Personal Data from the Schengen Visa Information System (VIS)"},{"content":" The second phase of the Sha Tau Kok Open Plan will commence on January 1, 2024. In the first stage, up to 1,000 visitors per day will be allowed to visit the entire Sha Tau Kok area except Chung Ying Street after applying for a Closed Area Permit online. This will give more people the opportunity to learn about the history, culture, and natural landscape of Sha Tau Kok and nearby outlying islands, and promote cultural and ecological tourism.\nApplying for a Closed Area Permit As Sha Tau Kok is located in the Frontier Closed Area of Hong Kong, you need to apply for a Closed Area Permit before you can visit. The permit application can be found on the Hong Kong Police Force website (https://www.es.police.gov.hk/). Click on e-Services - Frontier Closed Area Permit to apply. Visitors are required to apply with the actual travel document they will be using to enter Hong Kong.\nIf you are applying with a Mainland Travel Permit for Hong Kong and Macao Residents (commonly known as Home Return Permit), you need to submit the front and back of the permit (the endorsement needs to be valid at the time of submission) and a simple itinerary.\nTo continue processing your application for a Sha Tau Kok Closed Area Individual Visit Permit, please provide the following supplementary documents for our reference.\nPlease provide the endorsement on the back of your Mainland Travel Permit for Hong Kong and Macao Residents Entry certificate or other supplementary information related to your visit to Hong Kong (e.g. train tickets/flight tickets/hotel booking records/or other itinerary information) If you are unable to provide the required supplementary information, this application will be cancelled.\nIf you really don\u0026rsquo;t know how to write an itinerary, you can refer to the table below:\nTime Location Transportation -08:00 Shenzhen Futian Port - Lok Ma Chau Spur Line Control Point (Lok Ma Chau MTR Station), arrive in Hong Kong Walk -08:15 Lok Ma Chau MTR Station - Sheung Shui MTR Station MTR -09:00 Sheung Shui - Sha Tau Kok KMB Bus 78K -17:00 Visit Sha Tau Kok: Visit Cape of Sha Tau Kok, Sha Tau Kok Pier, Sun Moon Pavilion, Fish Lantern Plaza, Sha Tau Kok Old Fire Station, Chung Ying Street Garden, Salmon House, Sha Tau Kok Mirror in Mirror and other attractions Walk -18:00 Return to Sheung Shui Station KMB Bus 78K -18:30 Sheung Shui MTR Station - Lok Ma Chau MTR Station MTR -19:00 Lok Ma Chau Spur Line Control Point - Shenzhen Futian Port, return to Shenzhen Walk Although the website says that the permit will be issued within 3 working days, if the information is complete, it can basically be issued within one working day.\nSample permit Getting to Sha Tau Kok You can take KMB bus 78/78K/78S from Sheung Shui Station (around 8HKD, but less frequent, about every half an hour), or minibus 55K (around 11HKD, departs when full, more frequent).\n55K minibus stop Before entering the Sha Tau Kok closed area, police will board the vehicle to check closed area permits and identification documents. The closed area permit does not have to be printed, an electronic version is also acceptable, as long as the police can scan the QR code.\nSha Tau Kok Road Checkpoint before entering the closed area KMB bus 78K at Sha Tau Kok Bus Stop, for buses, the police will check passengers\u0026rsquo; closed area permits when they get off Inside the Sha Tau Kok Closed Area Chung Ying Street Garden Chung Ying Street Garden (newly opened check-in attraction) Chung Ying Street Police Post Currently the only checkpoint connecting Chung Ying Street. On the other side of the checkpoint is Chung Ying Street (but mainly under the jurisdiction of the Mainland). Unfortunately, holders of the Hong Kong side closed area tourist permit cannot enter the Mainland side of Chung Ying Street.\nCheckpoint on the Mainland side (old photo) Checkpoint on the Hong Kong side No tourists allowed Closed Sun Lou Street Police Post, after crossing the riverbed is the Mainland Sha Tau Kok River Riverbed Estuary, opposite in the near distance is the Sha Tau Kok Museum on the Shenzhen side Cape of Sha Tau Kok, the buoys on the ground should be the boundary between the Mainland and Hong Kong KCR Sha Tau Kok Station Ruins A train model is placed Sha Tau Kok Chuen stk-estate Leaving Sha Tau Kok by Water After exploring Sha Tau Kok, besides taking a bus/minibus to leave, you can also take the \u0026ldquo;Sha Tau Kok - Lai Chi Wo/Ap Chau/Kat O\u0026rdquo; kaito ferry to leave Sha Tau Kok by water. After arriving at Kat O, you can return by the same boat, or take the \u0026ldquo;Ma Liu Shui - Kat O/Ap Chau\u0026rdquo; ferry directly back to Ma Liu Shui Pier (but this ferry only operates on weekends and holidays, with only one trip per day).\nYantian Port as seen from the boat Ap Chau References Sha Tau Kok One-Day Tour: Must-Visit Attractions in the Open Area | Hong Kong Tourism Board (discoverhongkong.com) Second Phase of Sha Tau Kok Open Plan to Start on 1 January Next Year (with photos) ","permalink":"https://blog.sparktour.me/en/posts/2024/02/05/2024-sha-tau-kok-visit/","summary":"\u003cblockquote\u003e\n\u003cp\u003eThe second phase of the Sha Tau Kok Open Plan will commence on January 1, 2024. In the first stage, up to 1,000 visitors per day will be allowed to visit the entire Sha Tau Kok area except Chung Ying Street after applying for a Closed Area Permit online. This will give more people the opportunity to learn about the history, culture, and natural landscape of Sha Tau Kok and nearby outlying islands, and promote cultural and ecological tourism.\u003c/p\u003e","title":"One-day trip to Sha Tau Kok Port Closed Area"},{"content":"This article describes the process of configuring Keycloak for passwordless login using passkeys, webauthn, and OTP (One-Time Password). Some configurations in this article may require Keycloak 23 or higher to function properly.\nConfiguring the Authentication Section In Keycloak\u0026rsquo;s Authentication - Flow menu, duplicate the browser flow. We\u0026rsquo;ll name the copy browser with optional webauth and otp.\nDuplicate Browser Flow In the new flow, delete browser password form and all steps/flows below it:\ndelete old form First, add a step, select username Form, and set it to required:\nBelow, add a subflow and name it passwordless or password or otp:\nadd-subflow Within the passwordless or password or otp subflow, add three steps: Password Form, WebAuthn Passwordless Authenticator, and OTP Form. These three steps correspond to password authentication, passkey/webauthn authentication, and OTP code (six-digit two-factor authentication) respectively. Set these three steps as alternative, meaning users can choose any one of the three methods to log in.\nThe final result after adding all steps should look like this:\nAuthentication Flow Bind Flow Click on Action in the upper right corner of the flow and bind the newly created flow to the browser flow (browser login):\nbind-flow Enable webauthn in required actions In Authentication-Required actions, enable Webauthn Register Passwordless:\nenable-webauth Using passkey to log in Add a passkey In the Signing in section of the account panel, you\u0026rsquo;ll see a new Passwordless option. Click Set up Security key to set up your Passkey.\nset-security-key Test Passkey login After entering your account information, you will see the login method interface:\nsign-in-screen Click Security Key to log in using Passkey.\nchoose-method Misc If users are required to set up a passkey/OTP, the Set as default action option in Required Actions needs to be checked.\nReferences https://www.youtube.com/watch?v=PPoaPsfYGwQ ","permalink":"https://blog.sparktour.me/en/posts/2024/01/24/add-passkey-webauth-otp-support-to-keycloak/","summary":"\u003cp\u003eThis article describes the process of configuring Keycloak for passwordless login using passkeys, webauthn, and OTP (One-Time Password). Some configurations in this article may require \u003ca href=\"https://www.keycloak.org/docs/latest/release_notes/index.html#passkeys-support\"\u003eKeycloak 23\u003c/a\u003e or higher to function properly.\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"configuring-the-authentication-section\"\u003eConfiguring the Authentication Section\u003c/h2\u003e\n\u003cp\u003eIn Keycloak\u0026rsquo;s \u003ccode\u003eAuthentication - Flow\u003c/code\u003e menu, duplicate the browser flow.  We\u0026rsquo;ll name the copy \u003ccode\u003ebrowser with optional webauth and otp\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003e\u003cfigure\u003e\n    \u003cimg loading=\"lazy\" src=\"https://assets.sparktour.me/img/blog/2024/add-passkey-webauth-otp-support-to-keycloak/dup-browser-flow.webp\" alt=\"Duplicate Browser Flow\"  /\u003e\n    \u003cfigcaption\u003eDuplicate Browser Flow\u003c/figcaption\u003e\n\u003c/figure\u003e\n\u003c/p\u003e\n\u003cp\u003eIn the new flow, delete \u003ccode\u003ebrowser password form\u003c/code\u003e and all steps/flows below it:\u003c/p\u003e","title":"Add optional passkey/webauth/OTP login to Keycloak"},{"content":"Recently, our laboratory acquired eight NVMe SSDs, which we connected to a server via PCIe adapter cards and configured into a RAID using ZFS. To enable rapid access to the storage pool from other servers in the lab, I picked up two ConnectX-4 CX4121A 10GbE network cards from a second-hand platform to link two servers, and set up NFS over RDMA.\nThe seller on the second-hand platform did not include optical modules, so I randomly purchased two 10G Huawei modules, costing about 15-20 RMB each.\nDriver Installation I visited NVIDIA\u0026rsquo;s official website to download the NVIDIA Firmware Tools (MFT). Given that our laboratory uses Ubuntu, I downloaded the package mft-4.25.0-62-x86_64-deb.tgz.\nAfter downloading, I ran the install.sh from the installation package.\nOnce installed, I started the MST by running mst start, and checked the card status with mst status, which also showed the NIC corresponding to the optical card on the computer.\n# mst status MST modules: ------------ MST PCI module is not loaded MST PCI configuration module loaded MST devices: ------------ /dev/mst/mt4117_pciconf0 - PCI configuration cycles access. domain:bus:dev.fn=0000:04:00.0 addr.reg=88 data.reg=92 cr_bar.gw_offset=-1 Chip revision is: 00 For network cards solely used for server interconnection, static IPs and routes can be configured for both servers.\nFirmware Update I went to NVIDIA’s firmware download page to download the appropriate zip file (note the distinction between Ethernet and IB cards).\nAfter finding the device (/dev/mst prefix), I used flint -d \u0026lt;device_name\u0026gt; -i \u0026lt;binary image\u0026gt; burn to flash the firmware.\nInstalling MLNX_OFED Although I purchased Ethernet cards, the RDMA kernel modules from Mellanox required installing the MLNX_OFED package provided for IB cards. I directly downloaded the latest MLNX_OFED_LINUX-23.07-0.5.0.0-ubuntu22.04-x86_64.tgz from Nvidia’s website, without opting for the LTS version.\nAfter extracting, I ran:\n./mlnxofedinstall Then, I manually installed the NFS-RDMA kernel module, typically found at ./DEBS/mlnx-**nfs**rdma-dkms_23.04-OFED.23.04.0.5.3.1_all.deb. Alternatively, find . | grep nfs | grep .deb can be used to locate it. Installation is done via dpkg -i ./DEBS/mlnx-**nfs**rdma-dkms_23.04-OFED.23.04.0.5.3.1_all.deb. Patience is required as DKMS needs to build the kernel module.\nNFS Server Installation The NFS Server was installed on one server end:\napt install nfs-kernel-server systemctl start nfs-kernel-server.service Before starting NFS, it’s necessary to mount the corresponding kernel module and add the RDMA port to NFS’s portlist:\n/sbin/modprobe rpcrdma echo \u0026#39;rdma 20049\u0026#39; | tee /proc/fs/nfsd/portlist For automatic execution later, the /lib/systemd/system/nfs-kernel-server.service file can be edited to include ExecStartPre and ExecStartPost.\n[Unit] Description=NFS server and services DefaultDependencies=no Requires=network.target proc-fs-nfsd.mount Requires=nfs-mountd.service Wants=rpcbind.socket network-online.target Wants=rpc-statd.service nfs-idmapd.service Wants=rpc-statd-notify.service Wants=nfsdcld.service After=network-online.target local-fs.target After=proc-fs-nfsd.mount rpcbind.socket nfs-mountd.service After=nfs-idmapd.service rpc-statd.service After=nfsdcld.service Before=rpc-statd-notify.service # GSS services dependencies and ordering Wants=auth-rpcgss-module.service After=rpc-gssd.service gssproxy.service rpc-svcgssd.service [Service] Type=oneshot RemainAfterExit=yes ExecStartPre=-/usr/sbin/exportfs -r ExecStartPre=/sbin/modprobe rpcrdma ExecStart=/usr/sbin/rpc.nfsd ExecStartPost=/bin/bash -c \u0026#34;sleep 3 \u0026amp;\u0026amp; echo \u0026#39;rdma 20049\u0026#39; | tee /proc/fs/nfsd/portlist\u0026#34; ExecStop=/usr/sbin/rpc.nfsd 0 ExecStopPost=/usr/sbin/exportfs -au ExecStopPost=/usr/sbin/exportfs -f ExecReload=-/usr/sbin/exportfs -r [Install] WantedBy=multi-user.target Subsequently, systemctl daemon-reload and restart the NFS service. At this point, the NFS listening port should display both the standard 2049 and RDMA\u0026rsquo;s 20049.\n# cat /proc/fs/nfsd/portlist rdma 20049 rdma 20049 tcp 2049 tcp 2049 Exposing Mount Directories Edit /etc/exports,\nor if using a ZFS filesystem, the following command can allow access to the pool-name pool from the 7.0.115.0/24 network:\nzfs set sharenfs=\u0026#34;rw=@7.0.115.0/24,no_root_squash,async\u0026#34; pool-name After executing exportfs -v, the exposed directories should be visible:\n# exportfs -v /data/pool-name 7.0.115.0/24(async,wdelay,hide,no_subtree_check,mountpoint,sec=sys,rw,secure,no_root_squash,no_all_squash) Client Operations The client also needs to load rpcrdma before mounting, which can be included in the ExecStartPre= of the systemctl configuration:\nmodprobe rpcrdma Then proceed with mounting:\nmount 7.0.115.1:/data/pool-name /data/pool-name -o rdma,port=20049,async,noatime,nodiratime -vvvv If all goes well, the following can be added to /etc/fstab:\n7.0.115.1:/data/pool-name /data/pool-name nfs rdma,port=20049,async,noatime,nodiratime 0 0 Speed Test I used fio to test the sequential write speed:\nfio --name=testfile --directory=/data/pool-name/speedtest --size=2G --numjobs=10 --rw=write --bs=1000M --ioengine=libaio --fdatasync=1 --runtime=60 --time_based --group_reporting --eta-newline=1s The write speed was able to max out the 10G network card (1078MiB/s), and no traffic was visible on the network card during the test via iftop, indicating that NFS traffic was being directly transmitted over RDMA.\ntestfile: (groupid=0, jobs=10): err= 0: pid=3968057: Thu Aug 24 08:00:00 2023 write: IOPS=1, BW=1078MiB/s (1130MB/s)(67.4GiB/64006msec); 0 zone resets slat (msec): min=328, max=6801, avg=3973.96, stdev=1633.37 clat (nsec): min=1780, max=12590, avg=3690.00, stdev=1745.87 lat (msec): min=328, max=6801, avg=3973.96, stdev=1633.37 clat percentiles (nsec): | 1.00th=[ 1784], 5.00th=[ 2064], 10.00th=[ 2192], 20.00th=[ 2800], | 30.00th=[ 2928], 40.00th=[ 3088], 50.00th=[ 3280], 60.00th=[ 3408], | 70.00th=[ 3824], 80.00th=[ 4576], 90.00th=[ 4896], 95.00th=[ 6688], | 99.00th=[12608], 99.50th=[12608], 99.90th=[12608], 99.95th=[12608], | 99.99th=[12608] bw ( MiB/s): min=19984, max=20000, per=100.00%, avg=19997.62, stdev= 0.93, samples=64 iops : min= 16, max= 20, avg=19.40, stdev= 0.23, samples=64 lat (usec) : 2=2.90%, 4=71.01%, 10=24.64%, 20=1.45% fsync/fdatasync/sync_file_range: sync (nsec): min=20, max=9970, avg=597.50, stdev=1058.05 sync percentiles (nsec): | 1.00th=[ 20], 5.00th=[ 50], 10.00th=[ 110], 20.00th=[ 161], | 30.00th=[ 231], 40.00th=[ 382], 50.00th=[ 470], 60. 00th=[ 532], | 70.00th=[ 612], 80.00th=[ 708], 90.00th=[ 948], 95.00th=[ 1464], | 99.00th=[ 9920], 99.50th=[ 9920], 99.90th=[ 9920], 99.95th=[ 9920], | 99.99th=[ 9920] cpu : usr=1.00%, sys=7.62%, ctx=1122377, majf=0, minf=141 IO depths : 1=233.3%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, \u0026gt;=64=0.0% submit : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, \u0026gt;=64=0.0% complete : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, \u0026gt;=64=0.0% issued rwts: total=0,69,0,0 short=92,0,0,0 dropped=0,0,0,0 latency : target=0, window=0, percentile=100.00%, depth=1 Run status group 0 (all jobs): WRITE: bw=1078MiB/s (1130MB/s), 1078MiB/s-1078MiB/s (1130MB/s-1130MB/s), io=67.4GiB (72.4GB), run=64006-64006msec References https://network.nvidia.com/files/doc-2020/pb-connectx-4-lx-en-card.pdf\nhttps://forums.developer.nvidia.com/t/how-to-use-nfs-over-rdma-with-mlnx-ofed-solution/207263\nhttps://docs.oracle.com/cd/E23824_01/html/821-1448/gayne.html\n","permalink":"https://blog.sparktour.me/en/posts/2023/08/24/mount-nfs-via-rdma-on-mlnx-card/","summary":"\u003cp\u003eRecently, our laboratory acquired eight NVMe SSDs, which we connected to a server via PCIe adapter cards and configured into a RAID using ZFS. To enable rapid access to the storage pool from other servers in the lab, I picked up two ConnectX-4 CX4121A 10GbE network cards from a second-hand platform to link two servers, and set up NFS over RDMA.\u003c/p\u003e\n\u003cp\u003eThe seller on the second-hand platform did not include optical modules, so I randomly purchased two 10G Huawei modules, costing about 15-20 RMB each.\u003c/p\u003e","title":"Mount NFS via RDMA on Mellanox Card"},{"content":"I recently obtained several \u0026ldquo;removable eSIM cards\u0026rdquo; from esim.me from a friend in a group chat. In short, these eSIM cards are manufactured in the form of ordinary SIM cards, so they can be directly inserted into any mobile phone that supports physical SIM cards, and profiles can be added to the eSIM cards through the Android app provided by esim.me.\nAlthough esim.me differentiates the prices of these eSIM cards based on the number of profiles that each eSIM card can join, when I later searched for blog posts online, some people mentioned that the hardware of these eSIM cards at different price points is exactly the same, and esim.me only imposed software restrictions on cards at different price points through the mobile configuration app. And if these eSIM cards are inserted into LTE modules that support eSIM, profiles can be directly added and deleted through the Windows eSIM management interface. However, the current LTE modules that support eSIM are mainly Quectel\u0026rsquo;s RM-50xQ series (used price 550 yuan) and Dell\u0026rsquo;s dw5821e (used price 300 yuan) / dw5829e modules. It\u0026rsquo;s obviously not cost-effective to purchase these LTE modules just to configure the eSIM card.\nUpdate at Sep 2024: Users with removable eSIMs can consider using MiniLPA, which has more complete functionality than the demonstration-oriented LPAdesktop provided by truephone. Truphone/LPAdesktop After further searching on the Internet, I came across the desktop software Truphone/LPAdesktop, whose manual mentions that it can configure these eSIM cards through a PC/SC smart card reader. And the current smart card readers on the market generally only cost around 30-50 yuan, which is much more affordable than buying an LTE module.\nEnvironment Preparation One PC/SC reader (you can search for smart card reader/PCSC reader/health insurance card reader on Taobao). The reader looks similar to the card writing device in the telecom business hall. Generally, readers that support the PC/SC generic driver are driver-free under Windows and Mac. If you need to connect the reader under Linux, you can refer to this article to configure it. Mainly, you need to install pcscd and add the vendorID and productID of the reader. JRE environment Compilation and Installation Refer to the instructions on Github to compile using docker-compose. It\u0026rsquo;s important to note that the webcam component in LPADesktop https://github.com/sarxos/webcam-capture/ is not compatible with arm devices. If you need to run it on arm devices, you can consider commenting out the components related to webcam (I have modified a version without the webcam component, which can be downloaded at https://github.com/sparkcyf/LPAdesktop/releases/)\nUsage After installing the JRE, run java -jar LPA-1.0.0.0-jar-with-dependencies.jar in the directory:\nProgram UI After confirming that the program can recognize the reader, click connect to see the information of the eSIM and the currently installed profiles:\neSIM Card Information Right-click on different profiles to activate/deactivate/delete profiles.\nIf you need to add a new profile, you can click on download in the lower right corner, and then manually enter the profile information:\nAdd Profile If the string obtained by scanning the configuration QR code is similar to 1$prod.smdp-plus.rsp.goog$052X-UFXS-CQIY-PNGL, then fill in the Matching id as 052X-UFXS-CQIY-PNGL and the server url as prod.smdp-plus.rsp.goog.\nOther If you have a relatively new, rooted Android device around, you can also try using PeterCxy/OpenEUICC software to configure it directly on your phone. Someone has already made a magisk module for it: https://github.com/AndroPlus-org/magisk-module-openeuicc\nReferences eSIM.me SIM Card with Windows | zero log\neSIM.me を Windows 11 の LPA で使用する\nPeterCxy/OpenEUICC\n","permalink":"https://blog.sparktour.me/en/posts/2022/11/20/configure-esim-me-card-with-pc-sc-reader/","summary":"\u003cp\u003eI recently obtained several \u0026ldquo;removable eSIM cards\u0026rdquo; from esim.me from a friend in a group chat. In short, these eSIM cards are manufactured in the form of ordinary SIM cards, so they can be directly inserted into any mobile phone that supports physical SIM cards, and profiles can be added to the eSIM cards through the Android app provided by esim.me.\u003c/p\u003e\n\u003cp\u003eAlthough esim.me differentiates the prices of these eSIM cards based on the number of profiles that each eSIM card can join, when I later searched for blog posts online, some people mentioned that the hardware of these eSIM cards at different price points is exactly the same, and esim.me only imposed software restrictions on cards at different price points through the mobile configuration app. And if these eSIM cards are inserted into LTE modules that support eSIM, profiles can be directly added and deleted through the Windows eSIM management interface. However, the current LTE modules that support eSIM are mainly Quectel\u0026rsquo;s RM-50xQ series (used price 550 yuan) and Dell\u0026rsquo;s dw5821e (used price 300 yuan) / dw5829e modules. It\u0026rsquo;s obviously not cost-effective to purchase these LTE modules just to configure the eSIM card.\u003c/p\u003e","title":"Configure esim.me SIM Card with PC/SC Smart Card Reader"},{"content":"In many parts of the world, mobile phone numbers are increasingly intertwined with online services and personal identity. This is particularly true in mainland China, where a single user may find themselves managing multiple phone numbers for various applications and platforms. While solutions like telegram-sms and SMS-forwarder have emerged to address the inconvenience of managing multiple physical SIM cards, they come with limitations. These apps, typically installed on smartphones, are often hampered by aggressive background process management common on Android devices, leading to unreliable SMS forwarding. Furthermore, the practice of keeping older devices powered on long-term for this purpose introduces safety concerns, such as battery swelling. Perhaps the most significant limitation is the inability to handle phone calls; these apps only address SMS. This article details a project where the author, using an EC20 cellular module and a blend of software tools like asterisk, to overcame these limitations. The setup allows for SMS messaging through instant messaging applications like Telegram, and makes and receives phone calls over the internet using SIP clients, providing a more robust and flexible solution.\nOther Solutions the Author Investigated Multi-SIM Box (多卡宝) A popular SIM card hosting solution one or two years ago, it could hold four cards and have two cards on standby simultaneously, forwarding SMS and calls using its own app. According to FCCID\u0026rsquo;s PDF, it uses a Qualcomm Snapdragon 210 processor, commonly found in some 4G feature phones. Therefore, the author suspects the multi-SIM box used a modified Android system. However, in the second half of 2021, multi-SIM boxes were removed from domestic e-commerce platforms, likely due to regulatory reasons (possibly being used for telecom fraud?). Also, because SMS and voice data must go through a third-party server, there are some security concerns.\nGOIP Devices Commonly known as \u0026ldquo;cat pools,\u0026rdquo; these devices are too expensive for the author to afford.\nMaterials and Costs EC20 and Peripherals ec20-taobao A 4G card from Quectel that supports LTE Cat4 and uses the Snapdragon X5 LTE Modem. This card has several versions, some of which only support internet access and not calls or SMS. If you need to send/receive SMS and make calls, try to purchase the top-tier EC20CEFAG-512-SGNS, with a mini-pcie interface. It costs about 200 RMB from Quectel\u0026rsquo;s Taobao store, or about 50-60 RMB on Xianyu (a second-hand market).\nEach card also requires a mini PCIE to USB adapter card with a SIM slot, which costs about 25 RMB. Search for \u0026ldquo;4G module adapter board Mini PCIE to USB\u0026rdquo; on Taobao. The card slot usually takes a Mini SIM, if you only have a nano SIM, you may need to buy a SIM adapter.\nAdditionally, you\u0026rsquo;ll need to buy some IPEX to SMA adapter cables and SMA interface 4G antennas, which can be found by searching those keywords on Taobao.\nVM Host The requirements are not high; generally, you just need a USB port and a wired network port. It\u0026rsquo;s recommended to install a virtualization system like PVE or ESXi. (Raspberry Pi may not work due to insufficient power). The author bought a second-hand Optiplex 3050mff with an i3-6100T, 8GB of RAM, and a 256GB SSD for about 600 RMB.\nConfiguring the EC20 Verifying the EC20 Can Read the SIM Card Disable the SIM card\u0026rsquo;s PIN, insert it into the card slot, connect the EC20 to the antenna, and power it on. You should then see several ttyUSB ports in /dev:\nttyUSB0 ttyUSB1 PCM voice, GPS signal ttyUSB2 Control commands ttyUSB3 Use minicom to open the ttyUSB2 port:\nminicom -D /dev/ttyUSB2 # Enter ATI to check the EC20\u0026#39;s version: ATI Quectel EC20F Revision: EC20CEFAGR06A15M4G If everything is normal, you can reset the EC20 first to prevent the previous user from having set incorrect configurations (but do not reset the EC20 too frequently, as the reset operation can wear out the dongle\u0026rsquo;s flash memory):\nReset module at+qprtpara=3 Restart AT+CFUN=1,1 After resetting and restarting, you can check if the SIM card has registered successfully using the following commands (the example below is for China Unicom; the same applies to other carriers):\nAT+COPS? +COPS: 0,0,\u0026#34;CHN-UNICOM\u0026#34;,7 AT+QNWINFO +QNWINFO: \u0026#34;FDD LTE\u0026#34;,\u0026#34;46001\u0026#34;,\u0026#34;LTE BAND 3\u0026#34;,1650 AT+QENG=\u0026#34;servingcell\u0026#34; +QENG: \u0026#34;servingcell\u0026#34;,\u0026#34;CONNECT\u0026#34;,\u0026#34;LTE\u0026#34;,\u0026#34;FDD\u0026#34;,460,01 Configuring VoLTE With major carriers gradually phasing out 2G and 3G, configuring VoLTE for the dongle is becoming increasingly necessary. The following procedure refers to this PDF:\nEnable IMS AT+QCFG=\u0026#34;ims\u0026#34;,1 View mbn files in the dongle AT+QMBNCFG=\u0026#34;List\u0026#34; +QMBNCFG: \u0026#34;List\u0026#34;,0,1,1,\u0026#34;ROW_Generic_3GPP\u0026#34;,0x05010824,201806201 +QMBNCFG: \u0026#34;List\u0026#34;,1,0,0,\u0026#34;OpenMkt-Commercial-CU\u0026#34;,0x05011510,201911151 +QMBNCFG: \u0026#34;List\u0026#34;,2,0,0,\u0026#34;OpenMkt-Commercial-CT\u0026#34;,0x0501131C,201911141 +QMBNCFG: \u0026#34;List\u0026#34;,3,0,0,\u0026#34;Volte_OpenMkt-Commercial-CMCC\u0026#34;,0x05012011,201904261 # Although it lists VoLTE configuration files for China Mobile, China Unicom, and China Telecom, using the default automatic selection of CU/CT/CMCC cannot register VoLTE. After a long period of experimentation, the author found that forcing the selection of ROW_Generic_3GPP is necessary to register VoLTE successfully. Disable automatic mbn selection AT+QMBNCFG=\u0026#34;AutoSel\u0026#34;,0 Deactivate current mbn at+qmbncfg=\u0026#34;deactivate\u0026#34; Force selection of 3gpp AT+QMBNCFG=\u0026#34;select\u0026#34;,\u0026#34;ROW_Generic_3GPP\u0026#34; Restart AT+CFUN=1,1 You can check the mbn selection status again. If the second and third digits of ROW_Generic_3GPP are both 1, it indicates that the dongle has selected this configuration. AT+QMBNCFG=\u0026#34;List\u0026#34; +QMBNCFG: \u0026#34;List\u0026#34;,0,1,1,\u0026#34;ROW_Generic_3GPP\u0026#34;,0x05010824,201806201 +QMBNCFG: \u0026#34;List\u0026#34;,1,0,0,\u0026#34;OpenMkt-Commercial-CU\u0026#34;,0x05011510,201911151 +QMBNCFG: \u0026#34;List\u0026#34;,2,0,0,\u0026#34;OpenMkt-Commercial-CT\u0026#34;,0x0501131C,201911141 +QMBNCFG: \u0026#34;List\u0026#34;,3,0,0,\u0026#34;Volte_OpenMkt-Commercial-CMCC\u0026#34;,0x05012011,201904261 After restarting, check the IMS status AT+QCFG=\u0026#34;ims\u0026#34; If it returns +QCFG: \u0026#34;ims\u0026#34;,1,1, it\u0026#39;s enabled. If it returns +QCFG: \u0026#34;ims\u0026#34;,1,0, it\u0026#39;s not enabled. Optional (Activate UAC Digital Audio) Refer to https://github.com/IchthysMaranatha/asterisk-chan-quectel/discussions/2:\nAT+QCFG=\u0026#34;usbcfg\u0026#34;,0x2C7C,0x0125,1,1,1,1,1,0,1 This command will also open an adb daemon. You can use adb shell to enter the module\u0026rsquo;s built-in Android system. If the system has a password (whether or not it has a password does not affect subsequent configurations), you can use adb pull to pull the dongle\u0026rsquo;s /etc/passwd, remove the root password, and then push it back.\nAfter activation, you can check if there is an Android device by using aplay -L.\ndmix:CARD=Android,DEV=0 Android, USB Audio Direct sample mixing device Installing the Asterisk Virtual Machine FreePBX\u0026rsquo;s built-in Asterisk is tightly coupled with FreePBX configurations, making it difficult for the author to use. Also, CentOS doesn\u0026rsquo;t seem to be able to read the dongle\u0026rsquo;s UAC interface. Therefore, the author configured a simple Asterisk system based on a discussion by the Quectel channel driver author. The author uses Debian 11 here and installs the Asterisk 16 included in the package manager. After installing Asterisk, remember to pass through the dongle\u0026rsquo;s USB interface into the virtual machine.\nInstalling Asterisk and Some Dependencies apt update apt install asterisk asterisk-dev adb git autoconf automake libsqlite3-dev build-essential libasound2-dev alsa-utils Downloading asterisk-chan-quectel: git clone https://github.com/IchthysMaranatha/asterisk-chan-quectel cd asterisk-chan-quectel ./bootstrap ./configure --with-astversion=16 make make install Then, copy uac/quectel.conf to /etc/asterisk. Restart Asterisk using systemctl restart asterisk.\nEnter Asterisk\u0026rsquo;s CLI interface using asterisk -rvvv and enter quectel show devices. You should see the identified dongle, including its IMEI and the SIM card\u0026rsquo;s IMSI:\n# asterisk -rvvv Asterisk 16.16.1~dfsg-1+deb11u1, Copyright (C) 1999 - 2018, Digium, Inc. and others. Created by Mark Spencer \u0026lt;markster@digium.com\u0026gt; Asterisk comes with ABSOLUTELY NO WARRANTY; type \u0026#39;core show warranty\u0026#39; for details. This is free software, with components licensed under the GNU General Public License version 2 and other licenses; you are welcome to redistribute it under certain conditions. Type \u0026#39;core show license\u0026#39; for details. ========================================================================= Connected to Asterisk 16.16.1~dfsg-1+deb11u1 currently running on debian-asterisk (pid = 1403) debian-asterisk*CLI\u0026gt; quectel show devices ID Group State RSSI Mode Submode Provider Name Model Firmware IMEI IMSI Number quectel0 0 Free 27 0 0 CHN-UNICOM EC20F EC20CEFAGR06A15M4 86XXXXX 46XXXXX Unknown debian-asterisk*CLI\u0026gt; Configuring the Dialplan Directly refer to the post written by the driver author and download the sipext.zip from that post. Extract it and place the files in /etc/asterisk. At the same time, modify /etc/asterisk/extensions.conf (please do not copy directly! Modify according to your situation and the driver author\u0026rsquo;s post):\n[incoming-mobile] ;exten =\u0026gt; _.,1,Dial(SIP/70/100) ;same =\u0026gt; n,Hangup() exten =\u0026gt; sms,1,Verbose(Incoming SMS from ${CALLERID(num)} ${BASE64_DECODE(${SMS_BASE64})}) ;store exten =\u0026gt; sms,n,System(echo \u0026#39;${STRFTIME(${EPOCH},,%Y-%m-%d %H:%M:%S)} - ${QUECTELNAME} - ${CALLERID(num)}: ${BASE64_DECODE(${SMS_BASE64})}\u0026#39; \u0026gt;\u0026gt; /var/log/asterisk/sms.txt) ;for tg bot use exten =\u0026gt; sms,n,System(echo \u0026#39;${STRFTIME(${EPOCH},,%Y-%m-%d %H:%M:%S)} - ${QUECTELNAME} - ${CALLERID(num)}\\n${BASE64_DECODE(${SMS_BASE64})}\u0026#39; \u0026gt;\u0026gt; /var/log/asterisk/unread_sms/${STRFTIME(${EPOCH},,%Y%m%d%H%M%S)}-${CALLERID(num)}.txt) exten =\u0026gt; sms,n,Hangup() exten =\u0026gt; ussd,1,Verbose(Incoming USSD: ${BASE64_DECODE(${USSD_BASE64})}) exten =\u0026gt; ussd,n,System(echo \u0026#39;${STRFTIME(${EPOCH},,%Y-%m-%d %H:%M:%S)} - ${QUECTELNAME}: ${BASE64_DECODE(${USSD_BASE64})}\u0026#39; \u0026gt;\u0026gt; /var/log/asterisk/ussd.txt) exten =\u0026gt; ussd,n,Hangup() exten =\u0026gt; _.,1,Dial(SIP/70/100) exten =\u0026gt; s,n,Hangup() [Outbound-1001] exten =\u0026gt; _.,1,Dial(Quectel/quectel0/${EXTEN}) same =\u0026gt; n,Hangup() After modifying, restart Asterisk again.\nTesting Sending and Receiving SMS You can try sending an SMS to 10010 at this point to test sending and receiving messages:\nSending SMS (send \u0026ldquo;cxll\u0026rdquo; to 10010) asterisk -rx \u0026#39;quectel sms quectel0 10010 \u0026#34;cxll\u0026#34;\u0026#39; Receiving SMS According to the previous dialplan, after receiving an SMS, Asterisk will directly write the SMS content into /var/log/asterisk/sms.txt, which will look something like this:\ntail -f /var/log/asterisk/sms.txt 2022-10-01 00:00:00 - quectel0 - 10010: 【权益领取提醒】尊敬的用户，您已获得2个月视频会员体验资格（原价15元/月），腾讯、爱奇艺、优酷、芒果TV、QQ音乐等20款会员每月任选1款，点击 https://u.10010.cn 即可参与(活动规则详见页面说明，限48小时内参与，短信转发无效，已办理请忽略)。如需屏蔽，请在“广东联通”官方公众号内回复“TD”，首次关注可领4GB流量【广东联通】 If you need to further forward the SMS, just read this file, or modify the output format of the SMS in the dialplan.\nUsing a Telegram Bot for Self-Service SMS Sending and Receiving The following scripts are all written with ChatGPT, and the author has not encountered any obvious problems using them for the time being:\nSending SMS Systemd service:\n[Unit] Description=Outbound SMS service for TG-SMS Wants=network-online.target After=network-online.target [Service] Type=simple ExecStart=/opt/tg-sms/outbound/.venv/bin/python3 /opt/tg-sms/outbound/outbound-sms.py Restart=on-failure RestartSec=5 User=asterisk [Install] WantedBy=multi-user.target Script (you need to install the old version of python-telegram-bot pip install python-telegram-bot==13.15):\nfrom telegram import Update, ForceReply from telegram.ext import Updater, CommandHandler, MessageHandler, Filters, CallbackContext # We\u0026#39;ll use a dictionary to store each user\u0026#39;s state. user_data = {} # List of allowed user/group IDs. ALLOWED_IDS = [11111111] def send(update: Update, context: CallbackContext) -\u0026gt; None: if update.message.chat_id not in ALLOWED_IDS: update.message.reply_text(\u0026#39;您没有权限使用这个 bot。\u0026#39;) return if len(context.args) != 1: update.message.reply_text(\u0026#39;请按照以下格式发送命令：/send \u0026lt;phone_number\u0026gt;\u0026#39;) return user_data[update.message.chat_id] = {\u0026#39;phone_number\u0026#39;: context.args[0]} update.message.reply_text(\u0026#39;请输入您要发送的信息：\u0026#39;, reply_markup=ForceReply()) def cancel(update: Update, context: CallbackContext) -\u0026gt; None: user_data.pop(update.message.chat_id, None) update.message.reply_text(\u0026#39;操作已取消。\u0026#39;) def handle_message(update: Update, context: CallbackContext) -\u0026gt; None: if update.message.chat_id not in user_data: return if \u0026#39;message\u0026#39; not in user_data[update.message.chat_id]: user_data[update.message.chat_id][\u0026#39;message\u0026#39;] = update.message.text update.message.reply_text(\u0026#39;请确认信息：\\n手机号：{}\\n信息：{}\u0026#39;.format(user_data[update.message.chat_id][\u0026#39;phone_number\u0026#39;], user_data[update.message.chat_id][\u0026#39;message\u0026#39;]), reply_markup=ForceReply()) else: confirmation = update.message.text if confirmation.lower() == \u0026#39;yes\u0026#39;: import os result = os.popen(\u0026#39;asterisk -rx \\\u0026#39;quectel sms quectel0 {} \u0026#34;{}\u0026#34;\\\u0026#39;\u0026#39;.format(user_data[update.message.chat_id][\u0026#39;phone_number\u0026#39;], user_data[update.message.chat_id][\u0026#39;message\u0026#39;])).read() update.message.reply_text(\u0026#39;命令执行结果：\\n{}\u0026#39;.format(result)) else: update.message.reply_text(\u0026#39;操作已取消。\u0026#39;) user_data.pop(update.message.chat_id, None) def main() -\u0026gt; None: updater = Updater(token=\u0026#39;your_token\u0026#39;, use_context=True) dispatcher = updater.dispatcher dispatcher.add_handler(CommandHandler(\u0026#34;send\u0026#34;, send)) dispatcher.add_handler(CommandHandler(\u0026#34;cancel\u0026#34;, cancel)) dispatcher.add_handler(MessageHandler(Filters.text \u0026amp; ~Filters.command, handle_message)) updater.start_polling() updater.idle() if __name__ == \u0026#39;__main__\u0026#39;: main() Receiving SMS import requests import sys import urllib.parse import re # extract verify code def extract_verification_code(sms_text): # 定位到“验证码”关键词 keyword_index = sms_text.find(\u0026#39;验证码\u0026#39;) if keyword_index == -1: return None # 从关键词后开始匹配4-6位的数字 match = re.search(r\u0026#39;(\\d{4,6})\u0026#39;, sms_text[keyword_index:]) if match: return match.group(1) return None # tg tg_bot_token = \u0026#34;\u0026#34; tg_send_msg_url = \u0026#34;https://api.telegram.org/bot\u0026#34;+tg_bot_token+\u0026#34;/sendMessage\u0026#34; tg_receive_msg_url = \u0026#34;https://api.telegram.org/bot\u0026#34;+tg_bot_token+\u0026#34;/getUpdates\u0026#34; # wecom wecom_send_msg_url = \u0026#34;https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=your-key\u0026#34; bark_send_msg_url = \u0026#34;https://api.day.app/bark-token/\u0026#34; def incoming_sms_tg(msg_text): send_body = {} send_body[\u0026#39;chat_id\u0026#39;] = \u0026#39;11111111\u0026#39; send_body[\u0026#39;text\u0026#39;] = msg_text requests.post(tg_send_msg_url, json=send_body) def incoming_sms_wecom(msg_text): send_body = {} send_body[\u0026#39;msgtype\u0026#39;] = \u0026#39;text\u0026#39; send_body[\u0026#39;text\u0026#39;] = {} send_body[\u0026#39;text\u0026#39;][\u0026#39;content\u0026#39;] = msg_text requests.post(wecom_send_msg_url, json=send_body) def incoming_sms_bark(msg_text): requests.get(bark_send_msg_url + urllib.parse.quote_plus(msg_text) + \u0026#34;?copy=\u0026#34; + extract_verification_code(msg_text)) def incoming(): msg_text = sys.argv[1] incoming_sms_wecom(msg_text) incoming_sms_bark(msg_text) incoming_sms_tg(msg_text) incoming() Installing the FreePBX Virtual Machine Download the FreePBX ISO image from the official FreePBX website (it appears to be a CentOS 7 system): https://www.freepbx.org/downloads/. Install the system using the image, choosing freepbx 16 with asterisk 18 during the installation. After installation, access the virtual machine\u0026rsquo;s IP in a browser and set the initial administrator password (you can temporarily not open the firewall at the beginning for easy configuration).\nAdding an Extension Number In Applications - Extensions, click \u0026ldquo;add extension\u0026rdquo; - SIP extension, and add an extension with the number 200 (the number is arbitrary as long as it doesn\u0026rsquo;t clash with the numbers in the Asterisk virtual machine):\n添加 sip extensions Keep the rest as default, click \u0026ldquo;submit,\u0026rdquo; and then click the apply config button in the upper right corner.\nAdding a Trunk Before adding, first, follow the instructions in the previous post, modify /etc/asterisk/sip.conf in the Asterisk virtual machine, changing the host=192.168.x.x of the bottom 70 extension to the IP of the FreePBX virtual machine, and restart Asterisk.\nIn FreePBX, under Connectivity - Trunks, add a SIP Trunk. Configure it as follows, with other settings at default:\nRename outbound CallerID to the number in asterisk VM (70) Change SIP server to the ip of asterisk VM Routing In Connectivity - Outbound Routes, create a new route and forward all outbound routes to the SIP trunk created in the previous step:\noutbound-route In Connectivity - Inbound Routes, create a new route and forward all inbound routes to the extension number set above:\ninbound-route If you connect multiple extensions or multiple dongles in the future and need to route calls based on the user, you can configure the above DID and CallerID to filter calls in detail.\nTesting Calls Download a free version of zoiper. When adding an account, enter the username as extension number@FreePBX's IP, and the password as the one set above (make sure you do not enter it incorrectly; FreePBX has fail2ban enabled by default. Entering the SIP password incorrectly will also trigger fail2ban, and you will need to manually delete the iptables rules).\nAfter confirming registration, try calling 10010 or your own phone via Zoiper to test if voice and DTMF tones are recognized. If an incoming call to the dongle\u0026rsquo;s number comes into FreePBX, it will be directly transferred to the extension, at which point Zoiper will give you a prompt. You can answer the call at that point.\nPort Forwarding, SIP Push, etc. For SIP, in addition to forwarding the default SIP port (5201, you can view this in FreePBX settings under settings - asterisk sip setting), you also need to forward RTP ports. If you only want to forward one port, you can consider using an IAX2 extension, referring to EC20 Module + Issabel for VoIP - Hanako Blog. For SIP Push (displaying a push notification on your phone when a call is received), currently only Zoiper provides a more convenient way to configure it, but it requires payment. Refer to How to Get Rid of the SIM Card From Your Phone – IAM-LC for details.\nUsing the Module for Internet Access If the SIM card you\u0026rsquo;re using has a data plan, you can also configure the module for internet access. This ensures that SMS forwarding and calls can continue normally if the machine\u0026rsquo;s wired/wireless network goes down.\nFirst, after connecting to the serial port, enter AT+QCFG=\u0026quot;usbnet\u0026quot;,1 to set the usbnet mode to ECM (1 for ECM, 2 for NDIS, and 3 for RNDIS).\nThen, restart the module using AT+CFUN=1,1 and check ip a. You should see an interface similar to enxe2eeabcd123. You can run dhclient directly on this interface to obtain a v4 or v6 address. If you\u0026rsquo;re concerned about the interface name changing frequently, you can refer to this question to rename the interface based on the MAC address to something more manageable like quectel-usbX.\n3: quectel-usb0: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1500 qdisc fq_codel state UNKNOWN group default qlen 1000 link/ether ff:ff:ff:ff:ff:ff brd ff:ff:ff:ff:ff:ff inet 192.168.225.41/24 brd 192.168.225.255 scope global dynamic quectel-usb0 valid_lft 28802sec preferred_lft 28802sec inet6 2408::/64 scope global dynamic mngtmpaddr valid_lft forever preferred_lft forever inet6 fe80::/64 scope link valid_lft forever preferred_lft forever Misc When the SIP client is not open (or in background), calls to the dongle will indicate that the user is busy. You need to use the SIP push method mentioned in the previous section or keep the client open to receive calls normally. References The EC20 AT command set can be downloaded from https://www.quectel.com/ProductDownload/EC20.html. Quectel driver on Asterisk: https://github.com/IchthysMaranatha/asterisk-chan-quectel/ https://gao.md/blog/2014/10/05/sms-gateway-setup-huawei-e1750-asterisk-chan-dongle/ https://iam.lc/2024/01/how-to-get-rid-of-sim.ping https://forums.quectel.com/t/ec25-e-mini-additional-mbn-files/13473/2 ","permalink":"https://blog.sparktour.me/en/posts/2022/10/08/quectel-ec20-asterisk-freepbx-gsm-gateway/","summary":"\u003cp\u003eIn many parts of the world, mobile phone numbers are increasingly intertwined with online services and personal identity. This is particularly true in mainland China, where a single user may find themselves managing multiple phone numbers for various applications and platforms. While solutions like \u003ca href=\"https://github.com/telegram-sms/telegram-sms-china\"\u003etelegram-sms\u003c/a\u003e and \u003ca href=\"https://github.com/pppscn/SmsForwarder\"\u003eSMS-forwarder\u003c/a\u003e have emerged to address the inconvenience of managing multiple physical SIM cards, they come with limitations. These apps, typically installed on smartphones, are often hampered by aggressive background process management common on Android devices, leading to unreliable SMS forwarding. Furthermore, the practice of keeping older devices powered on long-term for this purpose introduces safety concerns, such as battery swelling. Perhaps the most significant limitation is the inability to handle phone calls; these apps only address SMS. This article details a project where the author, using an EC20 cellular module and a blend of software tools like asterisk, to overcame these limitations. The setup allows for SMS messaging through instant messaging applications like Telegram, and makes and receives phone calls over the internet using SIP clients, providing a more robust and flexible solution.\u003c/p\u003e","title":"Using EC20 Module, Asterisk, and FreePBX for SMS Forwarding and VoIP"},{"content":"Graduation Trip Under the \u0026lsquo;Dynamic Zero-COVID Policy\u0026rsquo; - Qinghai-Gansu Grand Tour The initial idea for my graduation trip came about at the end of 2021. Back then, the plan was to visit Shanghai and the surrounding areas of Zhejiang. However, with the lockdown in Shanghai and the tightening of restrictions in various regions, by April-May 2022, most cities were requiring individuals to quarantine in place if there was even a single confirmed COVID-19 case in their district. We once thought our graduation trip might be ruined. However, with the \u0026ldquo;Nine Prohibitions\u0026rdquo; policy introduced by the State Council in June (specifically, the two prohibitions that impacted our trip were: \u0026ldquo;Do not arbitrarily expand the scope of travel restrictions from medium- and high-risk areas to other areas\u0026rdquo; and \u0026ldquo;Do not impose mandatory dissuasion, isolation, or other restrictive measures on people from low-risk areas\u0026rdquo;), entry policies in various regions were relaxed. So, we gradually finalized our plan to travel to Tibet in early June. However, with the emergence of new cases in Shenzhen around June 18th, to avoid unnecessary trouble, we ultimately opted to travel to Qinghai and Gansu, where the control policies were relatively loose at the time. With the release of the Ninth Edition of the Diagnosis and Treatment Protocol, which explicitly stated that \u0026ldquo;isolation of individuals entering from low-risk areas is not allowed,\u0026rdquo; we finally confirmed our graduation trip plan - a chartered car tour along the Qinghai-Gansu circuit.\nTravel itinerary This article contains embedded Google My Maps and Amap. Google My Maps may require a suitable network environment to display properly, while Amap may require disabling certain ad-blocking software to display correctly. Map Pre-trip Preparations Our group of five found a travel agency on Mafengwo and booked a seven-seater car for seven days (D3-D9 in the itinerary) based on their recommended route (Itinerary link, The driver mentioned we could book directly with him for a lower price than the travel agency. Zhang\u0026rsquo;s phone number: 13897503462, WeChat available). The car model was a SAIC Maxus G10 Plus, about three years old.\nAltitude Sickness Xining has an altitude of around 2500 meters, and the highest point we stayed at during the entire trip was Chaka Salt Lake, slightly above 3000 meters. If you\u0026rsquo;re worried about altitude sickness, you can refer to this answer and purchase some acetazolamide (In Hong Kong, this medication is directly called \u0026ldquo;altitude sickness,\u0026rdquo; but you need to read the instructions yourself. I experienced a slight side effect of finger numbness after taking it; while the widely known medication Rhodiola rosea seemed ineffective and even caused one of our companions to vomit).\nAerial Photography Drone Drone flying is allowed in most scenic spots in Qinghai, while it\u0026rsquo;s explicitly prohibited in most of Gansu. However, in reality, people were flying drones in Gansu\u0026rsquo;s attractions without any intervention, probably because there were so few people that the security guards didn\u0026rsquo;t bother to manage it.\nItinerary Planning Since Xining still required a \u0026ldquo;three-day, two-test\u0026rdquo; policy for people coming from districts with confirmed cases before our departure, we added an extra day in Xining to accommodate potential policy changes. This arrangement also allowed us to visit Ta\u0026rsquo;er Temple on D2 before returning to downtown Xining.\nWhen we set off, we also planned to visit Lanzhou for three days after the Qinghai-Gansu circuit. However, due to the increased number of cases in Lanzhou after July 8th, to avoid lockdowns, we decided to return directly from Xining and booked a hotel near Xining Airport, bypassing downtown Xining.\nD1 Xining We arrived at Xining Airport on the first morning and underwent on-arrival nucleic acid testing. We took a taxi to our homestay around 1-2 PM. There were very few arrivals at the airport (perhaps due to the morning time), and the queue for nucleic acid testing outside was less than ten people at times.\nOn the plane Entrance to the Xining Airport Expressway, where individuals with non-Xining license plates were required to undergo nucleic acid testing after passing the toll booth After lunch on the first afternoon, we visited the Qinghai Provincial Museum. The main exhibits naturally focused on cultural relics from various dynasties within Qinghai Province. What impressed me the most was that, perhaps due to the dry and sandy conditions in Qinghai, there were well-preserved pottery pieces dating back to the Han Dynasty and even the Warring States period.\nQinghai Provincial Museum Exhibition introduction In the afternoon, we took a bus to Nanshan Park (Xining\u0026rsquo;s buses support China Transportation Union (TU) and UnionPay cards). The mountain wasn\u0026rsquo;t very high, but since the buildings in Xining are generally not tall, we could see a panoramic view of the city from the top.\nAn advertising wall next to Nanshan Park View of downtown Xining from the mountaintop The weather on D1 was excellent, with mostly blue skies. Unfortunately, due to dust later on, the weather throughout the circuit wasn\u0026rsquo;t as clear.\nPhoenix Pavilion Following the homestay owner\u0026rsquo;s recommendation, we had dinner at Yifude Kang Rou in the evening. Their main dishes are pit-cooked lamb/beef/chicken, which involves simmering the meat, potatoes, and vermicelli in a pot until the sauce thickens. It\u0026rsquo;s worth mentioning that a soda series called \u0026ldquo;Dayao Soda\u0026rdquo; is also common in restaurants in Xining and Gansu, with flavors like orange, lychee, and original. The orange soda tastes similar to Fanta, the lychee flavor is like typical lychee drinks, and the original soda, according to my companions, tastes like cold medicine\u0026hellip;\nAfter dinner, we also tried the Qinghai old yogurt (the kind with a yellow milk skin). However, the original yogurt was too sour for our taste. We preferred the improved version with sugar added during the production process.\nQinghai old yogurt Health Code Qinghai uses a health code called \u0026ldquo;Credit Health Code,\u0026rdquo; which sounds a bit strange as it seems to mix epidemic prevention with personal credit. However, compared to Guangdong\u0026rsquo;s health code, Qinghai\u0026rsquo;s code supports Alipay, WeChat, and UnionPay, which is better than Guangdong\u0026rsquo;s strong binding between the health code and WeChat. Entering scenic spots generally requires scanning a venue code, while restaurants and small shops are less strict and don\u0026rsquo;t enforce scanning.\nD2 Ta\u0026rsquo;er Temple, Lianhu Park Ta\u0026rsquo;er Temple Ta\u0026rsquo;er Temple is about 30 km away from downtown Xining, not too far but not too close either. This meant that if we wanted to visit, we basically had to dedicate the entire day to it. So, we rented a car for the day and visited Ta\u0026rsquo;er Temple and the nearby Lianhu Park.\nAt Ta\u0026rsquo;er Temple, we hired an official tour guide (160 RMB for five people, about 1.5-2 hours). The guide was very thorough and provided a great experience. Before the tour ended, we asked him if the nearby Tibetan Culture Museum was worth visiting, and he said it wasn\u0026rsquo;t particularly interesting, so we skipped it.\nThe eight stupas at the entrance of Ta\u0026rsquo;er Temple, showing that there weren\u0026rsquo;t many tourists Bodhi tree Lianhu Park After visiting Ta\u0026rsquo;er Temple, we had lunch in the nearby county town. We randomly chose \u0026ldquo;Huangzhong District Lusa\u0026rsquo;er Wanju Hotpot,\u0026rdquo; and the quality was decent. After lunch, we went to Lianhu Park next door. Lianhu is essentially a reservoir, but the sun was too scorching, and we retreated back to the car within ten minutes of reaching the dam.\nThe dam and lake of Lianhu Reservoir Sunset seen from the car For dinner, we went to Yiranxuan Tea Restaurant. Their specialties are scrambled eggs with sand leek and covered bowl tea. The sand leek tastes a bit like flavorless crown daisy, which I found alright; the covered bowl tea is green tea with red dates, goji berries, and sugar, so it\u0026rsquo;s quite sweet.\nD3 Qinghai Lake The driver\u0026rsquo;s Maxus MPV On the third day, the driver picked us up, and our seven-day chartered car journey began. In the morning, we headed to Qinghai Lake, first visiting a private attraction by the lake with some rapeseed flowers and lavender, with an entrance fee of 40 RMB per person. Ignoring the weather, the photo opportunities were quite good.\nArchway at Qinghai Lake Rapeseed flowers in the private attraction (left), and awkward-looking planted ones growing on the right Aerial view, with Qinghai Lake in the background Yaks by the lake (for tourist photos) Afterwards, we went to the Erlangjian Scenic Area. The main attraction there is a boat tour around the lake (about 10 km), but my companions didn\u0026rsquo;t find it appealing, so we didn\u0026rsquo;t go. The lakeside was still quite beautiful.\nStone stele at Erlangjian Lakeside, with a naval mine testing base in the distance Birds by the lake We had lunch at Dicos within the scenic area (prices were about 1.2-2.5 times higher than regular stores). We later discovered that most major attractions in Qinghai and Gansu have a Dicos, and there was even a Mixue Bingcheng in Erlangjian Scenic Area.\nThe afternoon of D2 was mainly spent driving to Chaka Town (near Chaka Salt Lake).\nYaks crossing the road The highest point we passed was Xiangpi Mountain, with an altitude of 3817 meters.\nXiangpi Mountain From this point onwards, our meals were basically whatever the driver ate. We had dinner on D2 at Yingcai Specialty Stir-fry and Pit-cooked Meat in Chaka Town. The driver recommended the off-menu lamb pilaf, which was affordable and generous. The other lamb and beef dishes were also quite good.\nPilaf Sunset (sunsets are late in Qinghai and Gansu, around 8:30 PM) D4 Chaka Salt Lake, Emerald Lake Chaka Salt Lake Chaka Salt Lake was originally an industrial base for salt production. It gained popularity around 2015 due to its white landscape. (Incidentally, a few days after our visit, Chaka Salt Lake was exposed by the media for charging for sightseeing cars, resulting in the scenic area canceling the 30 RMB ticket for the sightseeing car upon entry.)\nVisitors can walk on the salt lake. It\u0026rsquo;s recommended to purchase a combined ticket for the train and shoe covers (the 108 RMB one). The small train operates along the dam-like structure protruding in the map above. Since salt is white and reflects sunlight, even on a cloudy day like the one shown below, the light is still very intense. Bringing sunglasses would make the experience more comfortable.\nThe dam of the salt lake is also made of salt Train crossing Small train Salt precipitated from supersaturated solution on the salt lake Abandoned telephone pole Abandoned railway tracks Industrial train Emerald Lake After lunch, the afternoon itinerary involved driving to Dachaidan and visiting Emerald Lake nearby. Emerald Lake is also a salt lake, but perhaps due to certain minerals in the lake, its water is more greenish or blue. We arrived at Emerald Lake close to 8 PM, with soft lighting. The photos turned out great if we focused on just the lake (due to the heavy dust in the air, even during sunset, the sky appeared pale).\nEmerald Lake, with deeper water and less salt compared to Chaka. The roadbed next to it is still mainly soil Green salt lake Texture of the salt lake Salt cave, covered with salt precipitated from supersaturated solution Aerial view of Emerald Lake, with more prominent colors Panoramic view, showing the greener lakes with higher salinity and the bluer ones with lower salinity “Alien ruins” We had dinner at Yagubai Roasted Lamb in Dachaidan, which offered some barbecue and pit-cooked dishes.\nD5 U-shaped Highway, Water Yadan, Yadan Landforms U-shaped Highway This day\u0026rsquo;s route was a loop, with our accommodation still in Dachaidan. We first passed by the U-shaped highway, essentially a road with very sharp vertical bends. It seems to have gained popularity on platforms like Xiaohongshu. Here\u0026rsquo;s a photo:\nU-shaped highway U-shaped highway, wider angle shot with a phone Up close, we saw many daring tourists standing in the middle of the road taking pictures. Numerous large trucks, perhaps frightened, kept honking their horns as they passed through this section (very scary, bro .webp).\nDaring tourists Water Yadan Water Yadan, as the name suggests, is a combination of Yadan landforms and water. The water seems to have accumulated due to the diversion of nearby rivers. With no outflowing rivers, Water Yadan is also a saltwater lake, with a light blue color similar to Emerald Lake.\nYadan landforms, showing significant erosion by water Boat with Yadan landforms in the background Water Yadan and boats on the water, showing the less-than-ideal weather with a pale blue sky despite being sunny Panoramic view Yadan Landforms These are the typical Yadan landforms on land, commonly seen along the S314 highway on our return journey.\nYadan landforms Since we were entering Gansu the next day, we took a nucleic acid test at Dachaidan People\u0026rsquo;s Hospital in the afternoon of D5. The mixed testing cost 5 RMB.\nQueue for nucleic acid testing at the entrance of Dachaidan People\u0026rsquo;s Hospital, where we waited for almost half an hour D6 Dachaidan-Dunhuang, Yangguan Pass, \u0026ldquo;Encore Dunhuang\u0026rdquo; Show We spent most of the day on D6 driving, mainly enjoying the scenery along the way.\nCamels on the highway G215 Highway passing through Dangjinshan Yangguan Pass The seven-page-long list of \u0026ldquo;medium- and high-risk areas\u0026rdquo; at the entrance of Yangguan Pass After arriving in Dunhuang in the afternoon, we visited Yangguan Pass. Apart from a few beacon tower ruins, the Yangguan scenic area is mostly comprised of newly constructed buildings:\nNewly constructed buildings Beacon tower ruins Yangguan ancient site stele, with the desert behind \u0026ldquo;Encore Dunhuang\u0026rdquo; Show In the evening, we watched the \u0026ldquo;Encore Dunhuang\u0026rdquo; (unofficial introduction webpage) show. You can usually get tickets at a discounted price from the chartered car driver or local taxi drivers. (Dunhuang has three shows: \u0026ldquo;Silk Road Flower Rain,\u0026rdquo; \u0026ldquo;Encore Dunhuang,\u0026rdquo; and \u0026ldquo;Dunhuang Grand Ceremony.\u0026rdquo; You can find posts comparing these shows on Xiaohongshu, like this one, or this Zhihu question).\nTranslation from Xiaohongshu 🌸 Silk Road Flower Rain\nSilk Road Flower Rain is an older show, having achieved success as early as 1989. Creating such a stage play at that time was definitely a rarity, and the media reviews were highly positive. The stage is mainly set in the Tang Dynasty, using the Silk Road and Dunhuang murals as inspiration. The story tells the tale of the joys and sorrows of Ying Niang and her father, the painter Shenbi Zhang, and it highly praises the long-standing friendship between the people of China and the Western Regions. Silk Road Flower Rain has been performed around 3,000 times, with over 4 million viewers, and is known as the \u0026ldquo;Swan Lake of the East.\u0026rdquo; It was also performed at the 2008 Beijing Olympics, the 60th National Day in 2009, and the 2010 World Expo.\nAddress: Dunhuang Grand Theatre, 2713 Wenbo East Road, Dunhuang City, Gansu Province\nTransportation: It\u0026rsquo;s recommended to take the theatre\u0026rsquo;s shuttle bus. You can inquire about the specific waiting location and time when purchasing tickets. A taxi ride from downtown Dunhuang costs around 20 RMB. Show time: 8:30 PM, duration: 80 minutes.\n🌸 Encore Dunhuang\nEncore Dunhuang is a relatively new show, having premiered in 2016. This show was born with a halo, heavily promoted with director Wang Chaoge as its selling point. The performance is divided into three different theatrical spaces that require moving around to watch, with each space representing a scene. The actors perform right next to the audience, creating a unique experience that allows visitors to understand Dunhuang culture.\nThe entire performance is based on real history, and both the performance style and viewing format enhance the audience\u0026rsquo;s appreciation and enjoyment.\nPerformance location: Encore Dunhuang Theatre, west of the Mogao Caves Digital Center\nDuration: 90 minutes, 1 show per day during the off-season at 8 PM. During peak season, there are shows throughout the day, with a fixed show from 8:00 PM to 9:30 PM. Tickets are priced uniformly nationwide.\n🌸 Dunhuang Grand Ceremony\nDunhuang Grand Ceremony is a live-action performance with love as its main theme, recreating the historical culture and customs of another major Dunhuang town through the actors\u0026rsquo; performances. The show is divided into 6 chapters: \u0026ldquo;Prologue: Soul of the Desert,\u0026rdquo; Act 1 \u0026ldquo;Meditation: Mingsha Mountain,\u0026rdquo; Act 2 \u0026ldquo;Departure: Dunhuang City,\u0026rdquo; Act 3 \u0026ldquo;Love Bond: Mogao Caves,\u0026rdquo; Act 4 \u0026ldquo;Beauty: Crescent Moon Spring,\u0026rdquo; and \u0026ldquo;Epilogue: Dream Dunhuang.\u0026rdquo;\nDunhuang Grand Ceremony is performed outdoors and features impressive 3D lighting effects. The audience seats rotate 360 degrees and move back and forth, which is a rare stage setup these days.\nAddress: 200 meters inside Dunhuang Villa, Dunyue Road, 4 km from downtown Dunhuang.\n🌛 So, how do you choose? ❓\nFirst, there\u0026rsquo;s the ticket price difference. Encore Dunhuang has a novel stage format and a completely new setup. The ticket price difference compared to the other two shows is only a few dozen RMB. In terms of distance, all three shows are near scenic areas, so distance shouldn\u0026rsquo;t be a major concern. As for performance type, Silk Road Flower Rain is a pure stage play focusing on friendship and family, Encore Dunhuang showcases historical stories, while Dunhuang Grand Ceremony centers around a love story. It depends on your personal preference for the type of show.\n—— https://www.xiaohongshu.com/discovery/item/606ee42e0000000001029e0a\n\u0026ldquo;Encore Dunhuang\u0026rdquo; is a relatively new show (seemingly starting in 2016). The performance venue is located opposite the Mogao Caves Visitor Center. The novel aspect is that the show is divided into four acts, each using a different performance space. The audience stands below the stage and can move around freely as the plot unfolds. However, some of my friends found the dialogue a bit too sentimental, giving them goosebumps.\nFirst act, audience surrounding a T-shaped stage First act Second act, a wall built in reference to the Mogao Caves Third act, looking at the ancient scenes above and below through glass Fourth act, more traditional performance style similar to the Spring Festival Gala D7 Mogao Caves, Mingsha Mountain Mogao Caves You need to book tickets in advance for the Mogao Caves to have a chance of getting a ticket that allows you to see eight caves and the digital film. Otherwise, you can only buy emergency tickets that allow you to see four caves. Generally, you need to book tickets 30 days in advance. However, due to Gansu\u0026rsquo;s epidemic control measures and the low number of tourists, we managed to get tickets about 10 days in advance for this trip. Tickets can only be booked through https://www.mgk.org.cn/ticket. We visited the Mogao Caves on the morning and afternoon of D7. Upon entering the visitor center, tourists are first shown a regular film and a dome film. The regular film is a documentary about the history of the Mogao Caves, well-made but a bit dated, with aerial shots taken from a helicopter, resulting in shaky footage. The dome film is a guided tour of several caves based on 3D scanned models of the Mogao Caves.\nAfter watching the films, a bus took us to the interior of the scenic area. Photography is not allowed inside the Mogao Caves, so the photos below are all exterior views of the cliffs. (You can view the interior scenes on the \u0026ldquo;Digital Dunhuang\u0026rdquo; website developed by the Mogao Caves\u0026rsquo; official management.)\nMogao Caves cliff face Mogao Caves Cave eaves outside Cave 96 in the middle section of the Mogao Caves (again, the weather wasn\u0026rsquo;t great, so the sky is just light blue) Mingsha Mountain and Crescent Moon Spring Mingsha Mountain and Crescent Moon Spring are located within the same scenic area. The management has installed wooden ladders on Mingsha Mountain, allowing visitors to climb up (you can also climb by stepping on the sand, but it\u0026rsquo;s very tiring). If you go in the afternoon, you can watch the sunset from the top.\nSand dunes of Mingsha Mountain Mingsha Mountain and some paid activities within the scenic area: camel riding, powered paragliding, off-road vehicles, and helicopter rides Panoramic view of Mingsha Mountain and Crescent Moon Spring at sunset Crescent Moon Spring lit up after sunset Crescent Moon Spring at night It was almost 10 PM by the time we descended the mountain. We also visited the Shazhou Night Market at 11 PM, and it seemed to have recovered quite well in terms of visitor traffic.\nShazhou Night Market D8 Zhangye, Rainbow Mountains We started our return journey through Gansu on D8. With the continuous increase in cases in Lanzhou, epidemic prevention inspections along the way also became stricter. We were required to undergo a nucleic acid test upon leaving Jiuquan and had to show our travel itinerary and health code at every city border.\nRainbow Mountains The Rainbow Mountains are a group of Danxia landforms. Due to the different colors of the strata, they display a \u0026ldquo;rainbow\u0026rdquo; of colors under sunlight. Unfortunately, there was no sun when we visited, so the photos turned out rather bland.\nRainbow Mountains Rainbow Mountains Rainbow Mountains D9 Menyuan Rapeseed Flowers, Qilian Mountains, Return to Xining Airport D9 was also on our way back to Xining. We passed through Menyuan, where there were some rapeseed flower fields to see:\nRapeseed flower field Rapeseed flowers seen from Mount Daban Bianmen Expressway under construction Flocks of sheep on the highway Winding road on G227 National Highway Epidemic Prevention Checkpoint at the Provincial Border Finally, at the provincial border between Gansu and Qinghai, the Gansu side had set up two checkpoints, one for checking health codes and the other for nucleic acid testing. Since the checkpoints were directly on the road with insufficient parking space on the side, we waited in line for an hour at each checkpoint. By the time we arrived at the hotel near Xining Airport, it was already around 10 PM. Our seven-day chartered car journey had come to an end.\nCheckpoint for nucleic acid testing at the provincial border Traffic jam caused by nucleic acid testing and health code checks Afterword During the trip, I noticed that there were significantly fewer tourists compared to my previous visit to Northwest China a few years ago. I asked many locals about this year\u0026rsquo;s tourist flow (including but not limited to taxi drivers in Xining and Dunhuang, the chartered car driver, the tour guide at Ta\u0026rsquo;er Temple, and restaurant owners). It seems that the seemingly strict control policies have become a major obstacle for inter-provincial travel. Additionally, regarding policies, despite the State Council\u0026rsquo;s \u0026ldquo;Nine Prohibitions,\u0026rdquo; we still encountered situations along the way where we were required to take a nucleic acid test before proceeding, and inter-provincial tests were not recognized, among other \u0026ldquo;excessive measures.\u0026rdquo; I hope that next year these situations won\u0026rsquo;t occur anymore, and we can plan our travels freely without being affected by such sudden policy changes.\nDisclaimer This article is part of a personal travel blog and is not intended to promote any scenic spots or travel agencies. The author does not receive any benefits from the scenic spots or travel agencies mentioned in the article. The article is based on the author\u0026rsquo;s personal experience and is for reference only. The author does not guarantee the accuracy, completeness, or timeliness of the content. Please refer to the official website or official account of the scenic spot for the latest information.\n","permalink":"https://blog.sparktour.me/en/posts/2022/07/18/qinghai-gansu-trip-2022/","summary":"\u003ch1 id=\"graduation-trip-under-the-dynamic-zero-covid-policy---qinghai-gansu-grand-tour\"\u003eGraduation Trip Under the \u0026lsquo;Dynamic Zero-COVID Policy\u0026rsquo; - Qinghai-Gansu Grand Tour\u003c/h1\u003e\n\u003cp\u003eThe initial idea for my graduation trip came about at the end of 2021. Back then, the plan was to visit Shanghai and the surrounding areas of Zhejiang. However, with the \u003ca href=\"https://en.wikipedia.org/wiki/2022_Shanghai_lockdown\"\u003elockdown in Shanghai\u003c/a\u003e and the tightening of restrictions in various regions, by April-May 2022, most cities were requiring individuals to quarantine in place if there was even a single confirmed COVID-19 case in their district. We once thought our graduation trip might be ruined. However, with the \u0026ldquo;Nine Prohibitions\u0026rdquo; policy introduced by the State Council in June (specifically, the two prohibitions that impacted our trip were: \u0026ldquo;Do not arbitrarily expand the scope of travel restrictions from medium- and high-risk areas to other areas\u0026rdquo; and \u0026ldquo;Do not impose mandatory dissuasion, isolation, or other restrictive measures on people from low-risk areas\u0026rdquo;), entry policies in various regions were relaxed. So, we gradually finalized our plan to travel to Tibet in early June. However, with the emergence of new cases in Shenzhen around June 18th, to avoid unnecessary trouble, we ultimately opted to travel to Qinghai and Gansu, where the control policies were relatively loose at the time. With the release of the \u003ca href=\"https://www.nhc.gov.cn/yzygj/s7653p/202203/41c249d49d11431d83f3801d7889f355.shtml\"\u003eNinth Edition of the Diagnosis and Treatment Protocol\u003c/a\u003e, which explicitly stated that \u0026ldquo;isolation of individuals entering from low-risk areas is not allowed,\u0026rdquo; we finally confirmed our graduation trip plan - a chartered car tour along the Qinghai-Gansu circuit.\u003c/p\u003e","title":"Graduation Trip Under the 'Dynamic Zero-COVID Policy' - Qinghai-Gansu Grand Tour"},{"content":"In order to activate cross-border roaming service for my classmate\u0026rsquo;s phone, I recently took the time to visit Ma Tso Lung again (the last time was two years ago). Due to the impact of the border closure, compared to August 2019, the number of people going to Ma Tso Lung has significantly increased. The way to get to Ma Tso Lung was slightly different from the last time. This time, I took the 51B minibus from Sheung Shui, which took only about half an hour compared to the two-hour walk in 2019.\nSheung Shui Station, due to the border closure, it has become the north-bound terminus of the East Rail Line, and the platform is empty Front of the train, there are parking markings for 9-car and 12-car trains on the platform Landmark North and Public Transport Interchange “Adhere to One Country, Two Systems, Hong Kong\u0026rsquo;s Prosperity and Progress” 51B minibus, with sectional fares. If you only take it to Sun Yee San Tsuen, remember to adjust the amount on the card reader to 6.9 before swiping Liu Pok Road Tourists taking pictures on the mountain, with Luohu in the background Drone and SEG Plaza (the iron tower on the roof has been removed) Shun Hing Square Police post Futian sunset Cheung Fu Centre and Lok Ma Chau Station (below), with a view of Shekou Port in the background Luohu and Futian Luohu close-up Sunset After sunset Luohu central area Luohu Port (below) and Wutong Mountain (the top of the mountain in the distance) Bus stop sign at Sun Yee San Tsuen bus stop Cooperative East Rail Line Extra - The Mountain Fire at Ma Tso Lung When reviewing the satellite images of Ma Tso Lung, I noticed that in the Ma Tso Lung satellite image taken by the Hong Kong government in 2021, the entire hill is devoid of any vegetation cover.\nIMG_60F98F4D83B2-1 However, looking at the satellite map taken by Google in November 2020, the entire hill is still green.\nI believe the traces of the mountain fire above are related to this mountain fire on December 31, 2020. However, I have to marvel at the speed of vegetation recovery, as there were no traces of the mountain fire when I visited again more than half a year later.\n","permalink":"https://blog.sparktour.me/en/posts/2021/09/22/visit-ma-tso-lung-again-2021/","summary":"\u003cp\u003eIn order to activate cross-border roaming service for my classmate\u0026rsquo;s phone, I recently took the time to visit Ma Tso Lung again (the last time was \u003ca href=\"https://blog.sparktour.me/posts/2019/09/09/trip-to-border-of-sz-and-hk/\"\u003etwo years ago\u003c/a\u003e). Due to the impact of the border closure, compared to August 2019, the number of people going to Ma Tso Lung has significantly increased. The way to get to Ma Tso Lung was slightly different from the last time. This time, I took the \u003ca href=\"https://hkbus.fandom.com/wiki/%E6%96%B0%E7%95%8C%E5%B0%88%E7%B6%AB%E5%B0%8F%E5%B7%B451B%E7%B7%9A\"\u003e51B minibus\u003c/a\u003e from Sheung Shui, which took only about half an hour compared to the two-hour walk in 2019.\u003c/p\u003e","title":"Visit to Ma Tso Lung Again in 2021"},{"content":"@sparkcyf Major in EE, postgraduate student in SUSTech.\nStudent assistant of SUSTech CCSE and maintainer of SUSTech Open Source Mirrors.\nContact me via\u0026hellip; KeyBase\nEmail me@sparktour.me\nAmateur radio or DMR Callsign: BA7LKC\nDMR ID: 4603443\nFlight Map Airlines Flown Airlines Flown ","permalink":"https://blog.sparktour.me/en/about/","summary":"\u003ch1 id=\"sparkcyf\"\u003e@sparkcyf\u003c/h1\u003e\n\u003cp\u003eMajor in EE, postgraduate student in \u003ca href=\"https://www.sustech.edu.cn/en\"\u003eSUSTech\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eStudent assistant of \u003ca href=\"https://hpc.sustech.edu.cn/\"\u003eSUSTech CCSE\u003c/a\u003e and maintainer of \u003ca href=\"https://mirrors.sustech.edu.cn/\"\u003eSUSTech Open Source Mirrors\u003c/a\u003e.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"contact-me-via\"\u003eContact me via\u0026hellip;\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://keybase.io/sparkcyf\"\u003eKeyBase\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"email\"\u003eEmail\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"mailto:me@sparktour.me\"\u003eme@sparktour.me\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"amateur-radio-or-dmr\"\u003e\u003ca href=\"https://en.wikipedia.org/wiki/Amateur_radio\"\u003eAmateur radio\u003c/a\u003e or \u003ca href=\"https://en.wikipedia.org/wiki/Digital_mobile_radio\"\u003eDMR\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eCallsign: BA7LKC\u003c/p\u003e\n\u003cp\u003eDMR ID: 4603443\u003c/p\u003e\n\u003ch3 id=\"flight-map\"\u003eFlight Map\u003c/h3\u003e\n\u003ciframe width=\"100%\" height=\"400\" src=\"https://assets.sparktour.me/img/blog/misc/flight-map-sparktour.html\" frameborder=\"0\"\u003e\u003c/iframe\u003e\n\u003ch3 id=\"airlines-flown\"\u003eAirlines Flown\u003c/h3\u003e\n\u003cp\u003e\u003cfigure\u003e\n    \u003cimg loading=\"lazy\" src=\"https://assets.sparktour.me/img/blog/misc/airlines-flew/airlines_flew.webp\" alt=\"Airlines Flown\"  /\u003e\n    \u003cfigcaption\u003eAirlines Flown\u003c/figcaption\u003e\n\u003c/figure\u003e\n\u003c/p\u003e\n\u003ciframe width=\"100%\" height=\"450\" src=\"https://embed.windy.com/embed2.html?lat=22.322\u0026lon=114.197\u0026detailLat=22.550\u0026detailLon=114.060\u0026width=650\u0026height=450\u0026zoom=9\u0026level=surface\u0026overlay=wind\u0026product=ecmwf\u0026menu=\u0026message=\u0026marker=true\u0026calendar=now\u0026pressure=\u0026type=map\u0026location=coordinates\u0026detail=true\u0026metricWind=m%2Fs\u0026metricTemp=%C2%B0C\u0026radarRange=-1\" frameborder=\"0\"\u003e\u003c/iframe\u003e","title":"About"},{"content":"Friends 友链 liziwl soaked.in whexy yuantong infiWang Xuyang John Zhao ","permalink":"https://blog.sparktour.me/en/friends/","summary":"\u003ch1 id=\"friends-友链\"\u003eFriends 友链\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://liziwl.cn/en/\"\u003eliziwl\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://soaked.in/\"\u003esoaked.in\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.whexy.com/\"\u003ewhexy\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://yuantong.me/\"\u003eyuantong\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.infi.wang/\"\u003einfiWang\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://ysfhtxn.github.io/\"\u003eXuyang John Zhao\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","title":"Friends"}]