<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>使用FXO卡配合asterisk及freepbx将固定电话信号转为VoIP | Sparktour's Blog</title><meta name=keywords content="tech,tdm410p,asterisk,freepbx,sip,fxo"><meta name=description content="在本篇文章中，笔者尝试使用TDM410p FXO卡和freepbx，将固定电话的信号转换为了VoIP（SIP）协议，并使用SIP话机接打电话。

所需硬件

FXO卡一块，比较便宜的解决方案是TDM410p，红色的是FXO卡（接墙上的电话线），绿色的是FXS卡（接电话机终端），我们所需的是FXO卡，购买前需要注意有些卡是PCI接口的，可能需要另外买PCI转PCIe的转接卡。淘宝上的单口FXO卡大约200元一块。笔者买了某淘宝店的单口FXO组合板（一张PCI接口的单口FXO卡，和一张PCI转PCIe转接卡组合在了一起）
主机一台，由于TDM410p的硬件规格太老，似乎无法在PVE上进行pcie直通，因此笔者用了一台旧电脑直接安装了FreePBX发行版。（根据网上的讨论，fxo及freepbx对机器的性能要求很低，甚至十多年前的酷睿2+2G内存都能正常运行）
*（可选）*若干台IP电话，可在闲鱼上以「思科/Cisco IP电话」之类的关键词搜索。大概能搜到60-100元一台的CP7900或CP8900系列的电话机，价格甚至比某些接RJ11的传统电话机还便宜。

配置
FXO卡
FXO卡的硬件是通过dahdi进行驱动的，freepbx已经自带了这些驱动，理论上插上fxo卡之后，dahdi就能识别出来了。同时，我们也可以通过dahdi_scan来验证一下："><meta name=author content="sparktour"><link rel=canonical href=https://blog.sparktour.me/posts/2022/10/14/voip-fxo-via-asterisk-freepbx-dahdi/><link crossorigin=anonymous href=/assets/css/stylesheet.93f625d739f1d6a5c6f20c146bc6a8d26b233492b34b2220c54b12fd46a04ded.css integrity="sha256-k/Yl1znx1qXG8gwUa8ao0msjNJKzSyIgxUsS/UagTe0=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.sparktour.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.sparktour.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.sparktour.me/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.sparktour.me/apple-touch-icon.png><link rel=mask-icon href=https://blog.sparktour.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://blog.sparktour.me/posts/2022/10/14/voip-fxo-via-asterisk-freepbx-dahdi/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://blog.sparktour.me/scss/callout.css><link rel=stylesheet href=https://s4.zstatic.net/ajax/libs/disqusjs/3.0.2/styles/disqusjs.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-6EJ4YX1XZ8"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6EJ4YX1XZ8")}</script><meta property="og:url" content="https://blog.sparktour.me/posts/2022/10/14/voip-fxo-via-asterisk-freepbx-dahdi/"><meta property="og:site_name" content="Sparktour's Blog"><meta property="og:title" content="使用FXO卡配合asterisk及freepbx将固定电话信号转为VoIP"><meta property="og:description" content="在本篇文章中，笔者尝试使用TDM410p FXO卡和freepbx，将固定电话的信号转换为了VoIP（SIP）协议，并使用SIP话机接打电话。
所需硬件 FXO卡一块，比较便宜的解决方案是TDM410p，红色的是FXO卡（接墙上的电话线），绿色的是FXS卡（接电话机终端），我们所需的是FXO卡，购买前需要注意有些卡是PCI接口的，可能需要另外买PCI转PCIe的转接卡。淘宝上的单口FXO卡大约200元一块。笔者买了某淘宝店的单口FXO组合板（一张PCI接口的单口FXO卡，和一张PCI转PCIe转接卡组合在了一起） 主机一台，由于TDM410p的硬件规格太老，似乎无法在PVE上进行pcie直通，因此笔者用了一台旧电脑直接安装了FreePBX发行版。（根据网上的讨论，fxo及freepbx对机器的性能要求很低，甚至十多年前的酷睿2+2G内存都能正常运行） *（可选）*若干台IP电话，可在闲鱼上以「思科/Cisco IP电话」之类的关键词搜索。大概能搜到60-100元一台的CP7900或CP8900系列的电话机，价格甚至比某些接RJ11的传统电话机还便宜。 配置 FXO卡 FXO卡的硬件是通过dahdi进行驱动的，freepbx已经自带了这些驱动，理论上插上fxo卡之后，dahdi就能识别出来了。同时，我们也可以通过dahdi_scan来验证一下："><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-14T12:00:00+00:00"><meta property="article:modified_time" content="2024-04-14T21:54:57+08:00"><meta property="article:tag" content="Tech"><meta property="article:tag" content="Tdm410p"><meta property="article:tag" content="Asterisk"><meta property="article:tag" content="Freepbx"><meta property="article:tag" content="Sip"><meta property="article:tag" content="Fxo"><meta property="og:image" content="https://assets.sparktour.me/img/blog/misc/about-bg.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://assets.sparktour.me/img/blog/misc/about-bg.jpg"><meta name=twitter:title content="使用FXO卡配合asterisk及freepbx将固定电话信号转为VoIP"><meta name=twitter:description content="在本篇文章中，笔者尝试使用TDM410p FXO卡和freepbx，将固定电话的信号转换为了VoIP（SIP）协议，并使用SIP话机接打电话。

所需硬件

FXO卡一块，比较便宜的解决方案是TDM410p，红色的是FXO卡（接墙上的电话线），绿色的是FXS卡（接电话机终端），我们所需的是FXO卡，购买前需要注意有些卡是PCI接口的，可能需要另外买PCI转PCIe的转接卡。淘宝上的单口FXO卡大约200元一块。笔者买了某淘宝店的单口FXO组合板（一张PCI接口的单口FXO卡，和一张PCI转PCIe转接卡组合在了一起）
主机一台，由于TDM410p的硬件规格太老，似乎无法在PVE上进行pcie直通，因此笔者用了一台旧电脑直接安装了FreePBX发行版。（根据网上的讨论，fxo及freepbx对机器的性能要求很低，甚至十多年前的酷睿2+2G内存都能正常运行）
*（可选）*若干台IP电话，可在闲鱼上以「思科/Cisco IP电话」之类的关键词搜索。大概能搜到60-100元一台的CP7900或CP8900系列的电话机，价格甚至比某些接RJ11的传统电话机还便宜。

配置
FXO卡
FXO卡的硬件是通过dahdi进行驱动的，freepbx已经自带了这些驱动，理论上插上fxo卡之后，dahdi就能识别出来了。同时，我们也可以通过dahdi_scan来验证一下："><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.sparktour.me/posts/"},{"@type":"ListItem","position":2,"name":"使用FXO卡配合asterisk及freepbx将固定电话信号转为VoIP","item":"https://blog.sparktour.me/posts/2022/10/14/voip-fxo-via-asterisk-freepbx-dahdi/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"使用FXO卡配合asterisk及freepbx将固定电话信号转为VoIP","name":"使用FXO卡配合asterisk及freepbx将固定电话信号转为VoIP","description":"在本篇文章中，笔者尝试使用TDM410p FXO卡和freepbx，将固定电话的信号转换为了VoIP（SIP）协议，并使用SIP话机接打电话。\n所需硬件 FXO卡一块，比较便宜的解决方案是TDM410p，红色的是FXO卡（接墙上的电话线），绿色的是FXS卡（接电话机终端），我们所需的是FXO卡，购买前需要注意有些卡是PCI接口的，可能需要另外买PCI转PCIe的转接卡。淘宝上的单口FXO卡大约200元一块。笔者买了某淘宝店的单口FXO组合板（一张PCI接口的单口FXO卡，和一张PCI转PCIe转接卡组合在了一起） 主机一台，由于TDM410p的硬件规格太老，似乎无法在PVE上进行pcie直通，因此笔者用了一台旧电脑直接安装了FreePBX发行版。（根据网上的讨论，fxo及freepbx对机器的性能要求很低，甚至十多年前的酷睿2+2G内存都能正常运行） *（可选）*若干台IP电话，可在闲鱼上以「思科/Cisco IP电话」之类的关键词搜索。大概能搜到60-100元一台的CP7900或CP8900系列的电话机，价格甚至比某些接RJ11的传统电话机还便宜。 配置 FXO卡 FXO卡的硬件是通过dahdi进行驱动的，freepbx已经自带了这些驱动，理论上插上fxo卡之后，dahdi就能识别出来了。同时，我们也可以通过dahdi_scan来验证一下：\n","keywords":["tech","tdm410p","asterisk","freepbx","sip","fxo"],"articleBody":"在本篇文章中，笔者尝试使用TDM410p FXO卡和freepbx，将固定电话的信号转换为了VoIP（SIP）协议，并使用SIP话机接打电话。\n所需硬件 FXO卡一块，比较便宜的解决方案是TDM410p，红色的是FXO卡（接墙上的电话线），绿色的是FXS卡（接电话机终端），我们所需的是FXO卡，购买前需要注意有些卡是PCI接口的，可能需要另外买PCI转PCIe的转接卡。淘宝上的单口FXO卡大约200元一块。笔者买了某淘宝店的单口FXO组合板（一张PCI接口的单口FXO卡，和一张PCI转PCIe转接卡组合在了一起） 主机一台，由于TDM410p的硬件规格太老，似乎无法在PVE上进行pcie直通，因此笔者用了一台旧电脑直接安装了FreePBX发行版。（根据网上的讨论，fxo及freepbx对机器的性能要求很低，甚至十多年前的酷睿2+2G内存都能正常运行） *（可选）*若干台IP电话，可在闲鱼上以「思科/Cisco IP电话」之类的关键词搜索。大概能搜到60-100元一台的CP7900或CP8900系列的电话机，价格甚至比某些接RJ11的传统电话机还便宜。 配置 FXO卡 FXO卡的硬件是通过dahdi进行驱动的，freepbx已经自带了这些驱动，理论上插上fxo卡之后，dahdi就能识别出来了。同时，我们也可以通过dahdi_scan来验证一下：\n[root@freepbx]# dahdi_scan [1] active=yes alarms=OK description=Wildcard TDM410P name=WCTDM/0 manufacturer=Digium devicetype=Wildcard TDM410P location=PCI Bus 03 Slot 01 basechan=1 totchans=4 irq=0 type=analog port=1,FXO port=2,none port=3,none port=4,none 在freepbx网页界面的Connectivity-DAHDI Configuration，在弹出的提示里点enable，然后重载asterisk和dahdi。\n如果确认卡能识别出来的话，随后运行dahdi_genconf -vv，dahdi会生成asterisk需要的一些channel配置文件（如/etc/asterisk/dahdi-channels.conf），我们还需要在/etc/asterisk/chan_dahdi_channels_custom.conf里添加一行#include dahdi-channels.conf （这行很可能在freepbx重载的时候被删掉，如果遇到了打出电话的时候提示no channel available之类的错误的话，可以检查一下）。\n#include dahdi-channels.conf 此时我们可以在命令行界面进入asterisk的命令行（asterisk -rvvv），检查一下dahdi的channel运行状态：\nfreepbx*CLI\u003e dahdi show channels Chan Extension Context Language MOH Interpret Blocked In Service Description pseudo default default Yes 1 from-analog cn default Yes 修改callerid的识别方式 这一步主要是为了让asterisk能识别出打进来电话的callerid（呼叫方的电话号码），一般中国大陆使用的callerid广播方法主要是FSK和DTMF两种。如果不清楚运营商用的是哪种callerid的话，可以用dahdi_monitor 1 -v -r rx.wav -t tx.wav的命令对FXO口录音，随后给FXO口对应的电话打一个电话，并用软件观察录制的波形。具体的波形例子可以在这个链接里找到。由于笔者这边的运营商使用的是FSK（特征是先有若干个小峰，0.5秒左右后跟着一个一个听起来很像宽带拨号声音的音频），因此我们需要在DAHDI Configuration的页面右边的Global Settings里添加（或修改）以下项目：\ncidsignalling=bell cidstart=ring opermode=CHINA 随后在System Settings里面把tone reigon改成China，添加：\ndefaultzone=cn loadzone=cn 保存并重启asterisk和dahdi，如果不放心也可以在命令行运行fwconsole restart重启整个freepbx服务。\n随后的配置和笔者的上一篇文章类似，添加extension（分机），trunk（选dahdi trunk），inbound route和outbound route即可。\n连接Cisco IP电话（可选） 为cisco ip电话建立的extension（分机）需要用chan_sip（而不是pjsp）建立才能正常拨打和接听电话。chan_sipe可以在freepbx的Settings-Advanced settings-SIP Channel Driver里启用（设置成both即可）。 升级电话为SIP固件 先去Cisco的支持网站下载固件（需要注册一个免费的账号，下载固件选择SIP固件，zip结尾的）。\n下载后解压为如下形式：\n. ├── BOOT894x.0-0-2-0.bin.sgn ├── SIP894x.9-4-2SR3-1.bin1.sgn ├── SIP894x.9-4-2SR3-1.bin10.sgn ├── SIP894x.9-4-2SR3-1.bin11.sgn ├── SIP894x.9-4-2SR3-1.bin2.sgn ├── SIP894x.9-4-2SR3-1.bin3.sgn ├── SIP894x.9-4-2SR3-1.bin4.sgn ├── SIP894x.9-4-2SR3-1.bin5.sgn ├── SIP894x.9-4-2SR3-1.bin6.sgn ├── SIP894x.9-4-2SR3-1.bin7.sgn ├── SIP894x.9-4-2SR3-1.bin8.sgn ├── SIP894x.9-4-2SR3-1.bin9.sgn ├── SIP894x.9-4-2SR3-1.loads 随后在此文件夹里新建一个名为XMLDefault.cnf.xml的文件，内容如下，并把需要升级的电话机型号那一行的内容改成上面固件的前缀（比如笔者需要用上面的固件升级CP 8945，那就修改SIP894x.9-4-2SR3-1这一行，并把内容改成SIP894x.9-4-2SR3-1）：\nAUTO-REG disabled true false 0 0 0 Default true ","wordCount":"3339","inLanguage":"zh","image":"https://assets.sparktour.me/img/blog/misc/about-bg.jpg","datePublished":"2022-10-14T12:00:00Z","dateModified":"2024-04-14T21:54:57+08:00","author":{"@type":"Person","name":"sparktour"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.sparktour.me/posts/2022/10/14/voip-fxo-via-asterisk-freepbx-dahdi/"},"publisher":{"@type":"Organization","name":"Sparktour's Blog","logo":{"@type":"ImageObject","url":"https://blog.sparktour.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.sparktour.me/ accesskey=h title="Sparktour's Blog (Alt + H)">Sparktour's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://blog.sparktour.me/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://blog.sparktour.me/archives title=Archive><span>Archive</span></a></li><li><a href=https://blog.sparktour.me/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.sparktour.me/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://blog.sparktour.me/about/ title=About><span>About</span></a></li><li><a href=https://blog.sparktour.me/friends/ title=Friends><span>Friends</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.sparktour.me/>主页</a>&nbsp;»&nbsp;<a href=https://blog.sparktour.me/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">使用FXO卡配合asterisk及freepbx将固定电话信号转为VoIP</h1><div class=post-meta><span title='2022-10-14 12:00:00 +0000 UTC'>2022-10-14</span>&nbsp;·&nbsp;<span title='2024-04-14 21:54:57 +0800 +0800'>更新于: 2024-04-14</span>&nbsp;·&nbsp;7 分钟&nbsp;·&nbsp;sparktour</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e6%89%80%e9%9c%80%e7%a1%ac%e4%bb%b6 aria-label=所需硬件>所需硬件</a></li><li><a href=#%e9%85%8d%e7%bd%ae aria-label=配置>配置</a><ul><li><a href=#fxo%e5%8d%a1 aria-label=FXO卡>FXO卡</a></li><li><a href=#%e4%bf%ae%e6%94%b9callerid%e7%9a%84%e8%af%86%e5%88%ab%e6%96%b9%e5%bc%8f aria-label=修改callerid的识别方式>修改callerid的识别方式</a></li></ul></li><li><a href=#%e8%bf%9e%e6%8e%a5cisco-ip%e7%94%b5%e8%af%9d%e5%8f%af%e9%80%89 aria-label="连接Cisco IP电话（可选）">连接Cisco IP电话（可选）</a><ul><li><a href=#%e5%8d%87%e7%ba%a7%e7%94%b5%e8%af%9d%e4%b8%basip%e5%9b%ba%e4%bb%b6 aria-label=升级电话为SIP固件>升级电话为SIP固件</a></li><li><a href=#%e4%b8%8b%e5%8f%91sip%e9%85%8d%e7%bd%ae aria-label=下发SIP配置>下发SIP配置</a></li></ul></li><li><a href=#%e5%8f%82%e8%80%83 aria-label=参考>参考</a></li></ul></div></details></div><div class=post-content><p>在本篇文章中，笔者尝试使用TDM410p FXO卡和freepbx，将固定电话的信号转换为了VoIP（SIP）协议，并使用SIP话机接打电话。</p><h2 id=所需硬件>所需硬件<a hidden class=anchor aria-hidden=true href=#所需硬件>#</a></h2><ul><li>FXO卡一块，比较便宜的解决方案是TDM410p，红色的是FXO卡（接墙上的电话线），绿色的是FXS卡（接电话机终端），我们所需的是<strong>FXO卡</strong>，购买前需要注意有些卡是PCI接口的，可能需要另外买PCI转PCIe的转接卡。淘宝上的单口FXO卡大约200元一块。笔者买了某淘宝店的单口FXO组合板（一张PCI接口的单口FXO卡，和一张PCI转PCIe转接卡组合在了一起）</li><li>主机一台，由于TDM410p的硬件规格太老，似乎<a href=https://forum.proxmox.com/threads/pci-passthrough-problems.20728/>无法在PVE上进行pcie直通</a>，因此笔者用了一台旧电脑直接安装了<a href=https://www.freepbx.org/downloads/>FreePBX发行版</a>。（根据网上的讨论，fxo及freepbx对机器的性能要求很低，甚至十多年前的酷睿2+2G内存都能正常运行）</li><li>*（可选）*若干台IP电话，可在闲鱼上以「思科/Cisco IP电话」之类的关键词搜索。大概能搜到60-100元一台的<a href=https://www.cisco.com/c/en/us/products/collaboration-endpoints/unified-ip-phone-7900-series/index.html>CP7900</a>或<a href=https://www.cisco.com/c/en/us/products/collaboration-endpoints/unified-ip-phone-8900-series/index.html>CP8900</a>系列的电话机，价格甚至比某些接RJ11的传统电话机还便宜。</li></ul><h2 id=配置>配置<a hidden class=anchor aria-hidden=true href=#配置>#</a></h2><h3 id=fxo卡>FXO卡<a hidden class=anchor aria-hidden=true href=#fxo卡>#</a></h3><p>FXO卡的硬件是通过<a href=https://wiki.asterisk.org/wiki/display/DAHDI/DAHDI>dahdi</a>进行驱动的，freepbx已经自带了这些驱动，理论上插上fxo卡之后，dahdi就能识别出来了。同时，我们也可以通过<code>dahdi_scan</code>来验证一下：</p><pre tabindex=0><code>[root@freepbx]# dahdi_scan 
[1]
active=yes
alarms=OK
description=Wildcard TDM410P
name=WCTDM/0
manufacturer=Digium
devicetype=Wildcard TDM410P
location=PCI Bus 03 Slot 01
basechan=1
totchans=4
irq=0
type=analog
port=1,FXO
port=2,none
port=3,none
port=4,none
</code></pre><p>在freepbx网页界面的Connectivity-DAHDI Configuration，在弹出的提示里点enable，然后重载asterisk和dahdi。</p><p>如果确认卡能识别出来的话，随后运行<code>dahdi_genconf -vv</code>，dahdi会生成asterisk需要的一些channel配置文件（如<code>/etc/asterisk/dahdi-channels.conf</code>），我们还需要在<code>/etc/asterisk/chan_dahdi_channels_custom.conf</code>里添加一行<code>#include dahdi-channels.conf </code>（这行很可能在freepbx重载的时候被删掉，如果遇到了打出电话的时候提示<code>no channel available</code>之类的错误的话，可以检查一下）。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1>#include dahdi-channels.conf </span>
</span></span></code></pre></div><p>此时我们可以在命令行界面进入asterisk的命令行（<code>asterisk -rvvv</code>），检查一下dahdi的channel运行状态：</p><pre tabindex=0><code>freepbx*CLI&gt; dahdi show channels
Chan Extension       Context         Language   MOH Interpret        Blocked    In Service Description
pseudo                 default                    default                         Yes
1                 from-analog     cn         default                         Yes
</code></pre><h3 id=修改callerid的识别方式>修改callerid的识别方式<a hidden class=anchor aria-hidden=true href=#修改callerid的识别方式>#</a></h3><p>这一步主要是为了让asterisk能识别出打进来电话的callerid（呼叫方的电话号码），一般中国大陆使用的callerid广播方法主要是FSK和DTMF两种。<strong>如果不清楚运营商用的是哪种callerid的话，可以用<code>dahdi_monitor 1 -v -r rx.wav -t tx.wav</code>的命令对FXO口录音，随后给FXO口对应的电话打一个电话，并用软件观察录制的波形。具体的波形例子可以在<a href=https://groups.google.com/g/asterisk-tw/c/pfb3IlN6bbk>这个链接</a>里找到</strong>。由于笔者这边的运营商使用的是FSK（特征是先有若干个小峰，0.5秒左右后跟着一个一个听起来很像宽带拨号声音的音频），因此我们需要在DAHDI Configuration的页面右边的Global Settings里添加（或修改）以下项目：</p><pre tabindex=0><code>cidsignalling=bell
cidstart=ring
opermode=CHINA
</code></pre><p>随后在System Settings里面把tone reigon改成China，添加：</p><pre tabindex=0><code>defaultzone=cn
loadzone=cn
</code></pre><p>保存并重启asterisk和dahdi，如果不放心也可以在命令行运行<code>fwconsole restart</code>重启整个freepbx服务。</p><p>随后的配置和笔者的上一篇文章类似，添加extension（分机），trunk（选dahdi trunk），inbound route和outbound route即可。</p><h2 id=连接cisco-ip电话可选>连接Cisco IP电话（可选）<a hidden class=anchor aria-hidden=true href=#连接cisco-ip电话可选>#</a></h2><div class="callout callout-warning">为cisco ip电话建立的extension（分机）需要用chan_sip（而不是pjsp）建立才能正常拨打和接听电话。chan_sipe可以在freepbx的Settings-Advanced settings-SIP Channel Driver里启用（设置成both即可）。</div><h3 id=升级电话为sip固件>升级电话为SIP固件<a hidden class=anchor aria-hidden=true href=#升级电话为sip固件>#</a></h3><p>先去<a href=https://software.cisco.com/download/home>Cisco的支持网站</a>下载固件（需要注册一个免费的账号，下载固件选择SIP固件，zip结尾的）。</p><p>下载后解压为如下形式：</p><pre tabindex=0><code>.
├── BOOT894x.0-0-2-0.bin.sgn
├── SIP894x.9-4-2SR3-1.bin1.sgn
├── SIP894x.9-4-2SR3-1.bin10.sgn
├── SIP894x.9-4-2SR3-1.bin11.sgn
├── SIP894x.9-4-2SR3-1.bin2.sgn
├── SIP894x.9-4-2SR3-1.bin3.sgn
├── SIP894x.9-4-2SR3-1.bin4.sgn
├── SIP894x.9-4-2SR3-1.bin5.sgn
├── SIP894x.9-4-2SR3-1.bin6.sgn
├── SIP894x.9-4-2SR3-1.bin7.sgn
├── SIP894x.9-4-2SR3-1.bin8.sgn
├── SIP894x.9-4-2SR3-1.bin9.sgn
├── SIP894x.9-4-2SR3-1.loads
</code></pre><p>随后在此文件夹里新建一个名为<code>XMLDefault.cnf.xml</code>的文件，内容如下，并把需要升级的电话机型号那一行的内容改成上面固件的前缀（比如笔者需要用上面的固件升级CP 8945，那就修改<code>&lt;loadInformation585 model="Cisco 8945">SIP894x.9-4-2SR3-1&lt;/loadInformation585></code>这一行，并把内容改成<code>SIP894x.9-4-2SR3-1</code>）：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Default&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;autoRegistrationName&gt;</span>AUTO-REG<span class=nt>&lt;/autoRegistrationName&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;autoRegistration&gt;</span>disabled<span class=nt>&lt;/autoRegistration&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;selfProvisioningSecureMode&gt;</span>true<span class=nt>&lt;/selfProvisioningSecureMode&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;adminProvisionMode&gt;</span>false<span class=nt>&lt;/adminProvisionMode&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;ipAddressMode&gt;</span>0<span class=nt>&lt;/ipAddressMode&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;ipPreferenceModeControl&gt;</span>0<span class=nt>&lt;/ipPreferenceModeControl&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;ipMediaAddressFamilyPreference&gt;</span>0<span class=nt>&lt;/ipMediaAddressFamilyPreference&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;callManagerGroup&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;name&gt;</span>Default<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;tftpDefault&gt;</span>true<span class=nt>&lt;/tftpDefault&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;members&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;member</span>  <span class=na>priority=</span><span class=s>&#34;0&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;callManager&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;name&gt;</span>cucmpub1<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;description&gt;</span>cucmpub1<span class=nt>&lt;/description&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;ports&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;ethernetPhonePort&gt;</span>2000<span class=nt>&lt;/ethernetPhonePort&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;sipPort&gt;</span>5060<span class=nt>&lt;/sipPort&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;securedSipPort&gt;</span>5061<span class=nt>&lt;/securedSipPort&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;mgcpPorts&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;listen&gt;</span>2427<span class=nt>&lt;/listen&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;keepAlive&gt;</span>2428<span class=nt>&lt;/keepAlive&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/mgcpPorts&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/ports&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;processNodeName&gt;</span>cucmpub1<span class=nt>&lt;/processNodeName&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/callManager&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/member&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/members&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/callManagerGroup&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;TVS&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;members&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;member</span>  <span class=na>priority=</span><span class=s>&#34;0&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;port&gt;</span>2445<span class=nt>&lt;/port&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;address&gt;</span>cucmpub1<span class=nt>&lt;/address&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/member&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/members&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/TVS&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation548</span>  <span class=na>model=</span><span class=s>&#34;Cisco 6911&#34;</span><span class=nt>&gt;</span>SCCP6911.9-3-1-SR2-3<span class=nt>&lt;/loadInformation548&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation497</span>  <span class=na>model=</span><span class=s>&#34;Cisco 6961&#34;</span><span class=nt>&gt;</span>SCCP69xx.9-4-1-3SR2<span class=nt>&lt;/loadInformation497&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation614</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence Profile 52 Dual (C60)&#34;</span><span class=nt>&gt;&lt;/loadInformation614&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation616</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence Profile 65 Dual (C90)&#34;</span><span class=nt>&gt;&lt;/loadInformation616&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation558</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence 400&#34;</span><span class=nt>&gt;&lt;/loadInformation558&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation557</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence 200&#34;</span><span class=nt>&gt;&lt;/loadInformation557&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation628</span>  <span class=na>model=</span><span class=s>&#34;IMS-integrated Mobile (Basic)&#34;</span><span class=nt>&gt;&lt;/loadInformation628&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation30006</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7970&#34;</span><span class=nt>&gt;</span>SCCP70.9-4-2SR1-1S<span class=nt>&lt;/loadInformation30006&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation684</span>  <span class=na>model=</span><span class=s>&#34;Cisco 8851&#34;</span><span class=nt>&gt;</span>sip88xx.11-5-1-18<span class=nt>&lt;/loadInformation684&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation593</span>  <span class=na>model=</span><span class=s>&#34;Cisco Cius&#34;</span><span class=nt>&gt;&lt;/loadInformation593&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation520</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence 1100&#34;</span><span class=nt>&gt;&lt;/loadInformation520&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation592</span>  <span class=na>model=</span><span class=s>&#34;Cisco 3905&#34;</span><span class=nt>&gt;</span>CP3905.9-4-1SR2-2<span class=nt>&lt;/loadInformation592&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36217</span>  <span class=na>model=</span><span class=s>&#34;Cisco 8811&#34;</span><span class=nt>&gt;</span>sip88xx.11-5-1-18<span class=nt>&lt;/loadInformation36217&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36225</span>  <span class=na>model=</span><span class=s>&#34;Cisco 8865&#34;</span><span class=nt>&gt;</span>sip8845_65.11-5-1-18<span class=nt>&lt;/loadInformation36225&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36213</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7811&#34;</span><span class=nt>&gt;</span>sip78xx.11-5-1-18<span class=nt>&lt;/loadInformation36213&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation645</span>  <span class=na>model=</span><span class=s>&#34;Universal Device Template&#34;</span><span class=nt>&gt;&lt;/loadInformation645&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36207</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence MX700&#34;</span><span class=nt>&gt;&lt;/loadInformation36207&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation115</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7941&#34;</span><span class=nt>&gt;</span>SCCP41.9-4-2SR1-1S<span class=nt>&lt;/loadInformation115&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation480</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence 3200&#34;</span><span class=nt>&gt;&lt;/loadInformation480&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation648</span>  <span class=na>model=</span><span class=s>&#34;Cisco Unified Communications for RTX&#34;</span><span class=nt>&gt;&lt;/loadInformation648&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation30016</span>  <span class=na>model=</span><span class=s>&#34;Cisco IP Communicator&#34;</span><span class=nt>&gt;&lt;/loadInformation30016&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36043</span>  <span class=na>model=</span><span class=s>&#34;Cisco DX70&#34;</span><span class=nt>&gt;&lt;/loadInformation36043&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation30032</span>  <span class=na>model=</span><span class=s>&#34;SCCP gateway virtual phone&#34;</span><span class=nt>&gt;&lt;/loadInformation30032&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation496</span>  <span class=na>model=</span><span class=s>&#34;Cisco 6941&#34;</span><span class=nt>&gt;</span>SCCP69xx.9-4-1-3SR2<span class=nt>&lt;/loadInformation496&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation610</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence Profile 42 (C20)&#34;</span><span class=nt>&gt;&lt;/loadInformation610&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36227</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence MX800 Dual&#34;</span><span class=nt>&gt;&lt;/loadInformation36227&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation478</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence 1000&#34;</span><span class=nt>&gt;&lt;/loadInformation478&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation308</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7961G-GE&#34;</span><span class=nt>&gt;</span>SCCP41.9-4-2SR1-1S<span class=nt>&lt;/loadInformation308&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation540</span>  <span class=na>model=</span><span class=s>&#34;Cisco 8961&#34;</span><span class=nt>&gt;</span>sip8961.9-4-2SR2-2<span class=nt>&lt;/loadInformation540&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation309</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7941G-GE&#34;</span><span class=nt>&gt;</span>SCCP41.9-4-2SR1-1S<span class=nt>&lt;/loadInformation309&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation613</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence Profile 52 (C60)&#34;</span><span class=nt>&gt;&lt;/loadInformation613&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation30019</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7936&#34;</span><span class=nt>&gt;</span>cmterm_7936.3-3-21-0<span class=nt>&lt;/loadInformation30019&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation481</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence 500-37&#34;</span><span class=nt>&gt;&lt;/loadInformation481&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation12</span>  <span class=na>model=</span><span class=s>&#34;Cisco ATA 186&#34;</span><span class=nt>&gt;</span>ATA030204SCCP090202A<span class=nt>&lt;/loadInformation12&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36216</span>  <span class=na>model=</span><span class=s>&#34;Cisco 8821&#34;</span><span class=nt>&gt;&lt;/loadInformation36216&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation412</span>  <span class=na>model=</span><span class=s>&#34;Cisco 3951&#34;</span><span class=nt>&gt;</span>SIP3951.8-1-4a<span class=nt>&lt;/loadInformation412&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation690</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence MX300 G2&#34;</span><span class=nt>&gt;&lt;/loadInformation690&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation583</span>  <span class=na>model=</span><span class=s>&#34;Generic Multiple Screen Room System&#34;</span><span class=nt>&gt;&lt;/loadInformation583&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation365</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7921&#34;</span><span class=nt>&gt;</span>CP7921G-1.4.6.3<span class=nt>&lt;/loadInformation365&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation30035</span>  <span class=na>model=</span><span class=s>&#34;IP-STE&#34;</span><span class=nt>&gt;&lt;/loadInformation30035&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation586</span>  <span class=na>model=</span><span class=s>&#34;Cisco 8941&#34;</span><span class=nt>&gt;</span>SCCP894x.9-4-2SR2-2<span class=nt>&lt;/loadInformation586&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation369</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7906&#34;</span><span class=nt>&gt;</span>SCCP11.9-4-2SR1-1S<span class=nt>&lt;/loadInformation369&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation582</span>  <span class=na>model=</span><span class=s>&#34;Generic Single Screen Room System&#34;</span><span class=nt>&gt;&lt;/loadInformation582&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation30018</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7961&#34;</span><span class=nt>&gt;</span>SCCP41.9-4-2SR1-1S<span class=nt>&lt;/loadInformation30018&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation550</span>  <span class=na>model=</span><span class=s>&#34;Cisco ATA 187&#34;</span><span class=nt>&gt;</span>ATA187.9-2-3-1<span class=nt>&lt;/loadInformation550&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation608</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence Codec C40&#34;</span><span class=nt>&gt;&lt;/loadInformation608&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36210</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence IX5000&#34;</span><span class=nt>&gt;&lt;/loadInformation36210&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation681</span>  <span class=na>model=</span><span class=s>&#34;Cisco ATA 190&#34;</span><span class=nt>&gt;</span>ATA190.1-2-2-003<span class=nt>&lt;/loadInformation681&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation495</span>  <span class=na>model=</span><span class=s>&#34;Cisco 6921&#34;</span><span class=nt>&gt;</span>SCCP69xx.9-4-1-3SR2<span class=nt>&lt;/loadInformation495&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation633</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence Profile 42 (C40)&#34;</span><span class=nt>&gt;&lt;/loadInformation633&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation585</span>  <span class=na>model=</span><span class=s>&#34;Cisco 8945&#34;</span><span class=nt>&gt;</span>SIP894x.9-4-2SR3-1<span class=nt>&lt;/loadInformation585&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation689</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence MX200 G2&#34;</span><span class=nt>&gt;&lt;/loadInformation689&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation446</span>  <span class=na>model=</span><span class=s>&#34;Cisco 3911&#34;</span><span class=nt>&gt;</span>SIP3951.8-1-4a<span class=nt>&lt;/loadInformation446&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation682</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence SX10&#34;</span><span class=nt>&gt;&lt;/loadInformation682&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation606</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence Codec C90&#34;</span><span class=nt>&gt;&lt;/loadInformation606&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation521</span>  <span class=na>model=</span><span class=s>&#34;Transnova S3&#34;</span><span class=nt>&gt;&lt;/loadInformation521&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36241</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence DX70&#34;</span><span class=nt>&gt;&lt;/loadInformation36241&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation307</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7911&#34;</span><span class=nt>&gt;</span>SCCP11.9-4-2SR1-1S<span class=nt>&lt;/loadInformation307&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation659</span>  <span class=na>model=</span><span class=s>&#34;Cisco 8831&#34;</span><span class=nt>&gt;</span>sip8831.10-3-1SR2-2<span class=nt>&lt;/loadInformation659&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation30</span>  <span class=na>model=</span><span class=s>&#34;Analog Access&#34;</span><span class=nt>&gt;</span>A001C030<span class=nt>&lt;/loadInformation30&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation47</span>  <span class=na>model=</span><span class=s>&#34;Analog Access WS-X6624&#34;</span><span class=nt>&gt;</span>A00204000013<span class=nt>&lt;/loadInformation47&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation51</span>  <span class=na>model=</span><span class=s>&#34;Conference Bridge WS-X6608&#34;</span><span class=nt>&gt;</span>C00104000003<span class=nt>&lt;/loadInformation51&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation40</span>  <span class=na>model=</span><span class=s>&#34;Digital Access&#34;</span><span class=nt>&gt;</span>D001M022<span class=nt>&lt;/loadInformation40&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation43</span>  <span class=na>model=</span><span class=s>&#34;Digital Access WS-X6608&#34;</span><span class=nt>&gt;</span>D00404000032<span class=nt>&lt;/loadInformation43&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation42</span>  <span class=na>model=</span><span class=s>&#34;Digital Access+&#34;</span><span class=nt>&gt;</span>D00303010033<span class=nt>&lt;/loadInformation42&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation61</span>  <span class=na>model=</span><span class=s>&#34;H.323 Phone&#34;</span><span class=nt>&gt;&lt;/loadInformation61&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation7</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7960&#34;</span><span class=nt>&gt;</span>P0030801SR02<span class=nt>&lt;/loadInformation7&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation100</span>  <span class=na>model=</span><span class=s>&#34;Load Simulator&#34;</span><span class=nt>&gt;&lt;/loadInformation100&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation111</span>  <span class=na>model=</span><span class=s>&#34;Media Termination Point Hardware&#34;</span><span class=nt>&gt;</span>M00104000006<span class=nt>&lt;/loadInformation111&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation120</span>  <span class=na>model=</span><span class=s>&#34;MGCP Station&#34;</span><span class=nt>&gt;&lt;/loadInformation120&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation121</span>  <span class=na>model=</span><span class=s>&#34;MGCP Trunk&#34;</span><span class=nt>&gt;&lt;/loadInformation121&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation588</span>  <span class=na>model=</span><span class=s>&#34;Generic Desktop Video Endpoint&#34;</span><span class=nt>&gt;&lt;/loadInformation588&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation632</span>  <span class=na>model=</span><span class=s>&#34;Cisco Cius SP&#34;</span><span class=nt>&gt;&lt;/loadInformation632&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation647</span>  <span class=na>model=</span><span class=s>&#34;Cisco DX650&#34;</span><span class=nt>&gt;&lt;/loadInformation647&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation348</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7931&#34;</span><span class=nt>&gt;</span>SCCP31.9-4-2SR1-1S<span class=nt>&lt;/loadInformation348&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation627</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence MX300&#34;</span><span class=nt>&gt;&lt;/loadInformation627&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation635</span>  <span class=na>model=</span><span class=s>&#34;CTI Remote Device&#34;</span><span class=nt>&gt;&lt;/loadInformation635&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36235</span>  <span class=na>model=</span><span class=s>&#34;Cisco Spark Remote Device&#34;</span><span class=nt>&gt;&lt;/loadInformation36235&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation607</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence Codec C60&#34;</span><span class=nt>&gt;&lt;/loadInformation607&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation537</span>  <span class=na>model=</span><span class=s>&#34;Cisco 9951&#34;</span><span class=nt>&gt;</span>sip9951.9-4-2SR2-2<span class=nt>&lt;/loadInformation537&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation621</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7821&#34;</span><span class=nt>&gt;</span>sip78xx.11-5-1-18<span class=nt>&lt;/loadInformation621&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation431</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7937&#34;</span><span class=nt>&gt;</span>apps37sccp.1-4-5-7<span class=nt>&lt;/loadInformation431&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation376</span>  <span class=na>model=</span><span class=s>&#34;Nokia S60&#34;</span><span class=nt>&gt;&lt;/loadInformation376&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation375</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence&#34;</span><span class=nt>&gt;&lt;/loadInformation375&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation609</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence Quick Set C20&#34;</span><span class=nt>&gt;&lt;/loadInformation609&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation685</span>  <span class=na>model=</span><span class=s>&#34;Cisco 8861&#34;</span><span class=nt>&gt;</span>sip88xx.11-5-1-18<span class=nt>&lt;/loadInformation685&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation688</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence SX80&#34;</span><span class=nt>&gt;&lt;/loadInformation688&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation11</span>  <span class=na>model=</span><span class=s>&#34;Cisco VGC Virtual Phone&#34;</span><span class=nt>&gt;&lt;/loadInformation11&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation591</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence 1300-47&#34;</span><span class=nt>&gt;&lt;/loadInformation591&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation620</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence TX9200&#34;</span><span class=nt>&gt;&lt;/loadInformation620&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation10</span>  <span class=na>model=</span><span class=s>&#34;Cisco VGC Phone&#34;</span><span class=nt>&gt;&lt;/loadInformation10&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation484</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7925&#34;</span><span class=nt>&gt;</span>CP7925G-1.4.8.4<span class=nt>&lt;/loadInformation484&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation617</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence MX200&#34;</span><span class=nt>&gt;&lt;/loadInformation617&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation562</span>  <span class=na>model=</span><span class=s>&#34;Cisco Dual Mode for iPhone&#34;</span><span class=nt>&gt;&lt;/loadInformation562&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36239</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence DX80&#34;</span><span class=nt>&gt;&lt;/loadInformation36239&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation8</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7940&#34;</span><span class=nt>&gt;</span>P0030801SR02<span class=nt>&lt;/loadInformation8&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation479</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence 3000&#34;</span><span class=nt>&gt;&lt;/loadInformation479&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation30027</span>  <span class=na>model=</span><span class=s>&#34;Analog Phone&#34;</span><span class=nt>&gt;&lt;/loadInformation30027&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation622</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7841&#34;</span><span class=nt>&gt;</span>sip78xx.11-5-1-18<span class=nt>&lt;/loadInformation622&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation119</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7971&#34;</span><span class=nt>&gt;</span>SCCP70.9-4-2SR1-1S<span class=nt>&lt;/loadInformation119&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation626</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence SX20&#34;</span><span class=nt>&gt;&lt;/loadInformation626&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation596</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence TX1310-65&#34;</span><span class=nt>&gt;&lt;/loadInformation596&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation577</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7926&#34;</span><span class=nt>&gt;</span>CP7926G-1.4.8.4<span class=nt>&lt;/loadInformation577&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation564</span>  <span class=na>model=</span><span class=s>&#34;Cisco 6945&#34;</span><span class=nt>&gt;</span>SCCP6945.9-4-1-3SR2<span class=nt>&lt;/loadInformation564&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation604</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence EX60&#34;</span><span class=nt>&gt;&lt;/loadInformation604&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36042</span>  <span class=na>model=</span><span class=s>&#34;Cisco DX80&#34;</span><span class=nt>&gt;&lt;/loadInformation36042&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation437</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7975&#34;</span><span class=nt>&gt;</span>SCCP75.9-4-2SR1-1S<span class=nt>&lt;/loadInformation437&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36232</span>  <span class=na>model=</span><span class=s>&#34;Cisco 8851NR&#34;</span><span class=nt>&gt;</span>sip88xx.11-5-1-18<span class=nt>&lt;/loadInformation36232&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation547</span>  <span class=na>model=</span><span class=s>&#34;Cisco 6901&#34;</span><span class=nt>&gt;</span>SCCP6901.9-3-1-SR2-2<span class=nt>&lt;/loadInformation547&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation404</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7962&#34;</span><span class=nt>&gt;</span>SCCP42.9-4-2SR1-1S<span class=nt>&lt;/loadInformation404&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation435</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7945&#34;</span><span class=nt>&gt;</span>SCCP45.9-3-1SR4-1S<span class=nt>&lt;/loadInformation435&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation302</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7985&#34;</span><span class=nt>&gt;</span>cmterm_7985.4-1-7-0<span class=nt>&lt;/loadInformation302&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation612</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence Profile 52 (C40)&#34;</span><span class=nt>&gt;&lt;/loadInformation612&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation580</span>  <span class=na>model=</span><span class=s>&#34;Cisco E20&#34;</span><span class=nt>&gt;&lt;/loadInformation580&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation619</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence TX9000&#34;</span><span class=nt>&gt;&lt;/loadInformation619&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation575</span>  <span class=na>model=</span><span class=s>&#34;Cisco Dual Mode for Android&#34;</span><span class=nt>&gt;&lt;/loadInformation575&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation434</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7942&#34;</span><span class=nt>&gt;</span>SCCP42.9-4-2SR1-1S<span class=nt>&lt;/loadInformation434&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36224</span>  <span class=na>model=</span><span class=s>&#34;Cisco 8845&#34;</span><span class=nt>&gt;</span>sip8845_65.11-5-1SR1-1<span class=nt>&lt;/loadInformation36224&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation623</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7861&#34;</span><span class=nt>&gt;</span>sip78xx.11-5-1-18<span class=nt>&lt;/loadInformation623&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation30028</span>  <span class=na>model=</span><span class=s>&#34;ISDN BRI Phone&#34;</span><span class=nt>&gt;&lt;/loadInformation30028&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation358</span>  <span class=na>model=</span><span class=s>&#34;Cisco Unified Personal Communicator&#34;</span><span class=nt>&gt;&lt;/loadInformation358&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation642</span>  <span class=na>model=</span><span class=s>&#34;Carrier-integrated Mobile&#34;</span><span class=nt>&gt;&lt;/loadInformation642&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation503</span>  <span class=na>model=</span><span class=s>&#34;Cisco Unified Client Services Framework&#34;</span><span class=nt>&gt;&lt;/loadInformation503&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation590</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence 500-32&#34;</span><span class=nt>&gt;&lt;/loadInformation590&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation493</span>  <span class=na>model=</span><span class=s>&#34;Cisco 9971&#34;</span><span class=nt>&gt;</span>sip9971.9-4-2SR2-2<span class=nt>&lt;/loadInformation493&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation652</span>  <span class=na>model=</span><span class=s>&#34;Cisco Jabber for Tablet&#34;</span><span class=nt>&gt;&lt;/loadInformation652&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation335</span>  <span class=na>model=</span><span class=s>&#34;Motorola CN622&#34;</span><span class=nt>&gt;&lt;/loadInformation335&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation436</span>  <span class=na>model=</span><span class=s>&#34;Cisco 7965&#34;</span><span class=nt>&gt;</span>SCCP45.9-4-2SR1-1S<span class=nt>&lt;/loadInformation436&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation683</span>  <span class=na>model=</span><span class=s>&#34;Cisco 8841&#34;</span><span class=nt>&gt;</span>sip88xx.11-5-1-18<span class=nt>&lt;/loadInformation683&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation505</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence 1300-65&#34;</span><span class=nt>&gt;&lt;/loadInformation505&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation584</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence EX90&#34;</span><span class=nt>&gt;&lt;/loadInformation584&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation36208</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence MX800&#34;</span><span class=nt>&gt;&lt;/loadInformation36208&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation611</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence Profile 42 (C60)&#34;</span><span class=nt>&gt;&lt;/loadInformation611&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation634</span>  <span class=na>model=</span><span class=s>&#34;Cisco VXC 6215&#34;</span><span class=nt>&gt;&lt;/loadInformation634&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;loadInformation615</span>  <span class=na>model=</span><span class=s>&#34;Cisco TelePresence Profile 65 (C60)&#34;</span><span class=nt>&gt;&lt;/loadInformation615&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Default&gt;</span>
</span></span></code></pre></div><p>使用<a href=https://pjo2.github.io/tftpd64/>tftp64</a>或者linux上的其他tftp软件host这个文件夹，打开电话机，手动配置一下电话机下载配置的tftp服务器的ip，等待大概半分钟之后，电话机就会开始从tftp服务器下载配置文件，并开始升级（屏幕上会显示）。</p><h3 id=下发sip配置>下发SIP配置<a hidden class=anchor aria-hidden=true href=#下发sip配置>#</a></h3><p>给电话机下发SIP配置同样需要用到tftp服务器（笔者推荐使用freepbx发行版里centos自带的tftp服务器，修改一下<code>/etc/xinetd.d/tftp</code>，重启xinetd就可以使用了）。如果需要了解更多配置选项，可以查阅<a href=https://usecallmanager.nz/sepmac-cnf-xml.html>https://usecallmanager.nz/sepmac-cnf-xml.html</a>，此处笔者仅提供一个自己的Cisco电话机可用的配置：</p><p>首先新建一个<code>XMLDefault.cnf.xml</code>在，注意修改<code>processNodeName</code>和<code>loadInformation</code>一行（数字和固件号需要跟前文的那个xml匹配）</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; ?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;Default&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;callManagerGroup&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;members&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;member</span> <span class=na>priority=</span><span class=s>&#34;0&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;callManager&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&lt;ports&gt;</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&lt;ethernetPhonePort&gt;</span>2000<span class=nt>&lt;/ethernetPhonePort&gt;</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&lt;mgcpPorts&gt;</span>
</span></span><span class=line><span class=cl>                            <span class=nt>&lt;listen&gt;</span>2427<span class=nt>&lt;/listen&gt;</span>
</span></span><span class=line><span class=cl>                            <span class=nt>&lt;keepAlive&gt;</span>2428<span class=nt>&lt;/keepAlive&gt;</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&lt;/mgcpPorts&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&lt;/ports&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=c>&lt;!--FREEPBX SERVER IP GOES HERE--&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&lt;processNodeName&gt;</span>FREEPBX_IP<span class=nt>&lt;/processNodeName&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;/callManager&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/member&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/members&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/callManagerGroup&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--Cisco IP Phone Firmware--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;loadInformation585</span> <span class=na>model=</span><span class=s>&#34;Cisco 8945&#34;</span><span class=nt>&gt;</span>SIP894x.9-4-2SR3-1<span class=nt>&lt;/loadInformation585&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;authenticationURL&gt;&lt;/authenticationURL&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;directoryURL&gt;&lt;/directoryURL&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;idleURL&gt;&lt;/idleURL&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;informationURL&gt;&lt;/informationURL&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;messagesURL&gt;&lt;/messagesURL&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servicesURL&gt;&lt;/servicesURL&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Default&gt;</span>
</span></span></code></pre></div><p>随后新建一个<code>电话的hostname.cnf.xml</code>，电话的hostname可以在电话的网络设置里看到，hostname需要全大写，根据自己的情况修改一下SIP的端口（freepbx的chan_sip的端口默认是TCP/UDP5160，TLS5161）和用户名密码：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;device&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;deviceProtocol&gt;</span>SIP<span class=nt>&lt;/deviceProtocol&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;sshUserId&gt;</span>cisco<span class=nt>&lt;/sshUserId&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;sshPassword&gt;</span>cisco<span class=nt>&lt;/sshPassword&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;devicePool&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;dateTimeSetting&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;dateTemplate&gt;</span>Y.M.D<span class=nt>&lt;/dateTemplate&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;timeZone&gt;</span>China Standard/Daylight Time<span class=nt>&lt;/timeZone&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;ntps&gt;</span> 
</span></span><span class=line><span class=cl>            <span class=nt>&lt;ntp&gt;</span> 
</span></span><span class=line><span class=cl>               <span class=nt>&lt;name&gt;</span>time.apple.com<span class=nt>&lt;/name&gt;</span> 
</span></span><span class=line><span class=cl>               <span class=nt>&lt;ntpMode&gt;</span>Unicast<span class=nt>&lt;/ntpMode&gt;</span> 
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/ntp&gt;</span>         
</span></span><span class=line><span class=cl>         <span class=nt>&lt;/ntps&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/dateTimeSetting&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;callManagerGroup&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;members&gt;</span> 
</span></span><span class=line><span class=cl>            <span class=nt>&lt;member</span> <span class=na>priority=</span><span class=s>&#34;0&#34;</span><span class=nt>&gt;</span> 
</span></span><span class=line><span class=cl>               <span class=nt>&lt;callManager&gt;</span> 
</span></span><span class=line><span class=cl>                  <span class=nt>&lt;ports&gt;</span> 
</span></span><span class=line><span class=cl>                     <span class=nt>&lt;ethernetPhonePort&gt;</span>2000<span class=nt>&lt;/ethernetPhonePort&gt;</span> 
</span></span><span class=line><span class=cl>                     <span class=nt>&lt;sipPort&gt;</span>5160<span class=nt>&lt;/sipPort&gt;</span> 
</span></span><span class=line><span class=cl>                     <span class=nt>&lt;securedSipPort&gt;</span>5161<span class=nt>&lt;/securedSipPort&gt;</span> 
</span></span><span class=line><span class=cl>                  <span class=nt>&lt;/ports&gt;</span> 
</span></span><span class=line><span class=cl>            <span class=nt>&lt;processNodeName&gt;</span>10.20.18.222<span class=nt>&lt;/processNodeName&gt;</span>
</span></span><span class=line><span class=cl>               <span class=nt>&lt;/callManager&gt;</span> 
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/member&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;/members&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/callManagerGroup&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/devicePool&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;sipProfile&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;sipProxies&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;backupProxy&gt;&lt;/backupProxy&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;backupProxyPort&gt;</span>5160<span class=nt>&lt;/backupProxyPort&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;emergencyProxy&gt;&lt;/emergencyProxy&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;emergencyProxyPort&gt;&lt;/emergencyProxyPort&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;outboundProxy&gt;&lt;/outboundProxy&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;outboundProxyPort&gt;&lt;/outboundProxyPort&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;registerWithProxy&gt;</span>true<span class=nt>&lt;/registerWithProxy&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/sipProxies&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;sipCallFeatures&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;cnfJoinEnabled&gt;</span>true<span class=nt>&lt;/cnfJoinEnabled&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;callForwardURI&gt;</span>x-serviceuri-cfwdall<span class=nt>&lt;/callForwardURI&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;callPickupURI&gt;</span>x-cisco-serviceuri-pickup<span class=nt>&lt;/callPickupURI&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;callPickupListURI&gt;</span>x-cisco-serviceuri-opickup<span class=nt>&lt;/callPickupListURI&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;callPickupGroupURI&gt;</span>x-cisco-serviceuri-gpickup<span class=nt>&lt;/callPickupGroupURI&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;meetMeServiceURI&gt;</span>x-cisco-serviceuri-meetme<span class=nt>&lt;/meetMeServiceURI&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;abbreviatedDialURI&gt;</span>x-cisco-serviceuri-abbrdial<span class=nt>&lt;/abbreviatedDialURI&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;rfc2543Hold&gt;</span>false<span class=nt>&lt;/rfc2543Hold&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;callHoldRingback&gt;</span>2<span class=nt>&lt;/callHoldRingback&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;localCfwdEnable&gt;</span>true<span class=nt>&lt;/localCfwdEnable&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;semiAttendedTransfer&gt;</span>true<span class=nt>&lt;/semiAttendedTransfer&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;anonymousCallBlock&gt;</span>2<span class=nt>&lt;/anonymousCallBlock&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;callerIdBlocking&gt;</span>2<span class=nt>&lt;/callerIdBlocking&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;dndControl&gt;</span>0<span class=nt>&lt;/dndControl&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;remoteCcEnable&gt;</span>true<span class=nt>&lt;/remoteCcEnable&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/sipCallFeatures&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;sipStack&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;sipInviteRetx&gt;</span>6<span class=nt>&lt;/sipInviteRetx&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;sipRetx&gt;</span>10<span class=nt>&lt;/sipRetx&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;timerInviteExpires&gt;</span>180<span class=nt>&lt;/timerInviteExpires&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;timerRegisterExpires&gt;</span>3600<span class=nt>&lt;/timerRegisterExpires&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;timerRegisterDelta&gt;</span>5<span class=nt>&lt;/timerRegisterDelta&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;timerKeepAliveExpires&gt;</span>120<span class=nt>&lt;/timerKeepAliveExpires&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;timerSubscribeExpires&gt;</span>120<span class=nt>&lt;/timerSubscribeExpires&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;timerSubscribeDelta&gt;</span>5<span class=nt>&lt;/timerSubscribeDelta&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;timerT1&gt;</span>500<span class=nt>&lt;/timerT1&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;timerT2&gt;</span>4000<span class=nt>&lt;/timerT2&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;maxRedirects&gt;</span>70<span class=nt>&lt;/maxRedirects&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;remotePartyID&gt;</span>false<span class=nt>&lt;/remotePartyID&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;userInfo&gt;</span>None<span class=nt>&lt;/userInfo&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/sipStack&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;autoAnswerTimer&gt;</span>1<span class=nt>&lt;/autoAnswerTimer&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;autoAnswerAltBehavior&gt;</span>false<span class=nt>&lt;/autoAnswerAltBehavior&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;autoAnswerOverride&gt;</span>true<span class=nt>&lt;/autoAnswerOverride&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;transferOnhookEnabled&gt;</span>false<span class=nt>&lt;/transferOnhookEnabled&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;enableVad&gt;</span>false<span class=nt>&lt;/enableVad&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;dtmfAvtPayload&gt;</span>101<span class=nt>&lt;/dtmfAvtPayload&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;dtmfDbLevel&gt;</span>3<span class=nt>&lt;/dtmfDbLevel&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;dtmfOutofBand&gt;</span>avt<span class=nt>&lt;/dtmfOutofBand&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;alwaysUsePrimeLine&gt;</span>false<span class=nt>&lt;/alwaysUsePrimeLine&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;alwaysUsePrimeLineVoiceMail&gt;</span>false<span class=nt>&lt;/alwaysUsePrimeLineVoiceMail&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;kpml&gt;</span>3<span class=nt>&lt;/kpml&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;phoneLabel&gt;</span>Cisco 8945<span class=nt>&lt;/phoneLabel&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;stutterMsgWaiting&gt;</span>1<span class=nt>&lt;/stutterMsgWaiting&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;callStats&gt;</span>true<span class=nt>&lt;/callStats&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;silentPeriodBetweenCallWaitingBursts&gt;</span>10<span class=nt>&lt;/silentPeriodBetweenCallWaitingBursts&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;disableLocalSpeedDialConfig&gt;</span>false<span class=nt>&lt;/disableLocalSpeedDialConfig&gt;</span> 
</span></span><span class=line><span class=cl>    <span class=nt>&lt;sipLines&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;line</span> <span class=na>button=</span><span class=s>&#34;1&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;featureID&gt;</span>9<span class=nt>&lt;/featureID&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;featureLabel&gt;</span>5111<span class=nt>&lt;/featureLabel&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;proxy&gt;</span>USECALLMANAGER<span class=nt>&lt;/proxy&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;port&gt;</span>5160<span class=nt>&lt;/port&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;name&gt;</span>SIP_USERNAME<span class=nt>&lt;/name&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;displayName&gt;</span>DISPLAYNAME<span class=nt>&lt;/displayName&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;autoAnswer&gt;</span>
</span></span><span class=line><span class=cl>          <span class=nt>&lt;autoAnswerEnabled&gt;</span>2<span class=nt>&lt;/autoAnswerEnabled&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/autoAnswer&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;callWaiting&gt;</span>3<span class=nt>&lt;/callWaiting&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;authName&gt;</span>SIP_USERNAME<span class=nt>&lt;/authName&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;authPassword&gt;</span>SIP_PASSWORD<span class=nt>&lt;/authPassword&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;sharedLine&gt;</span>false<span class=nt>&lt;/sharedLine&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;messageWaitingLampPolicy&gt;</span>1<span class=nt>&lt;/messageWaitingLampPolicy&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;messagesNumber&gt;</span>*97<span class=nt>&lt;/messagesNumber&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;ringSettingIdle&gt;</span>4<span class=nt>&lt;/ringSettingIdle&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;ringSettingActive&gt;</span>5<span class=nt>&lt;/ringSettingActive&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;contact&gt;</span>SIP_USERNAME<span class=nt>&lt;/contact&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;forwardCallInfoDisplay&gt;</span>
</span></span><span class=line><span class=cl>          <span class=nt>&lt;callerName&gt;</span>true<span class=nt>&lt;/callerName&gt;</span>
</span></span><span class=line><span class=cl>          <span class=nt>&lt;callerNumber&gt;</span>true<span class=nt>&lt;/callerNumber&gt;</span>
</span></span><span class=line><span class=cl>          <span class=nt>&lt;redirectedNumber&gt;</span>true<span class=nt>&lt;/redirectedNumber&gt;</span>
</span></span><span class=line><span class=cl>          <span class=nt>&lt;dialedNumber&gt;</span>true<span class=nt>&lt;/dialedNumber&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/forwardCallInfoDisplay&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/line&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/sipLines&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;voipControlPort&gt;</span>5160<span class=nt>&lt;/voipControlPort&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;startMediaPort&gt;</span>10000<span class=nt>&lt;/startMediaPort&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;stopMediaPort&gt;</span>11000<span class=nt>&lt;/stopMediaPort&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;dscpForAudio&gt;</span>184<span class=nt>&lt;/dscpForAudio&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;ringSettingBusyStationPolicy&gt;</span>0<span class=nt>&lt;/ringSettingBusyStationPolicy&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;dialTemplate&gt;</span>dialplan.xml<span class=nt>&lt;/dialTemplate&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;softKeyFile&gt;&lt;/softKeyFile&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/sipProfile&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;commonProfile&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;phonePassword&gt;&lt;/phonePassword&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;backgroundImageAccess&gt;</span>true<span class=nt>&lt;/backgroundImageAccess&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;callLogBlfEnabled&gt;</span>2<span class=nt>&lt;/callLogBlfEnabled&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/commonProfile&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;loadInformation&gt;</span>SIP894x.9-4-2SR3-1<span class=nt>&lt;/loadInformation&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;vendorConfig&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;disableSpeaker&gt;</span>false<span class=nt>&lt;/disableSpeaker&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;disableSpeakerAndHeadset&gt;</span>false<span class=nt>&lt;/disableSpeakerAndHeadset&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;pcPort&gt;</span>1<span class=nt>&lt;/pcPort&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;settingsAccess&gt;</span>1<span class=nt>&lt;/settingsAccess&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;garp&gt;</span>0<span class=nt>&lt;/garp&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;voiceVlanAccess&gt;</span>0<span class=nt>&lt;/voiceVlanAccess&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;videoCapability&gt;</span>0<span class=nt>&lt;/videoCapability&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;autoSelectLineEnable&gt;</span>0<span class=nt>&lt;/autoSelectLineEnable&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;webAccess&gt;</span>1<span class=nt>&lt;/webAccess&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;daysDisplayNotActive&gt;</span>1,2,3,4,5,6,7<span class=nt>&lt;/daysDisplayNotActive&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;displayOnTime&gt;</span>00:01<span class=nt>&lt;/displayOnTime&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;displayOnDuration&gt;</span>00:01<span class=nt>&lt;/displayOnDuration&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;displayIdleTimeout&gt;</span>00:01<span class=nt>&lt;/displayIdleTimeout&gt;</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;spanToPCPort&gt;</span>1<span class=nt>&lt;/spanToPCPort&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;loggingDisplay&gt;</span>1<span class=nt>&lt;/loggingDisplay&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;loadServer&gt;&lt;/loadServer&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;sshAccess&gt;</span>0<span class=nt>&lt;/sshAccess&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/vendorConfig&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;userLocale&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;name&gt;&lt;/name&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;uid&gt;&lt;/uid&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;langCode&gt;</span>en_US<span class=nt>&lt;/langCode&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;version&gt;</span>1.0.0.0-1<span class=nt>&lt;/version&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;winCharSet&gt;</span>iso-8859-1<span class=nt>&lt;/winCharSet&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/userLocale&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;networkLocale&gt;&lt;/networkLocale&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;networkLocaleInfo&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;name&gt;&lt;/name&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;uid&gt;&lt;/uid&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;version&gt;</span>1.0.0.0-1<span class=nt>&lt;/version&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/networkLocaleInfo&gt;</span>    
</span></span><span class=line><span class=cl>   <span class=nt>&lt;deviceSecurityMode&gt;</span>1<span class=nt>&lt;/deviceSecurityMode&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;authenticationURL&gt;&lt;/authenticationURL&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;directoryURL&gt;&lt;/directoryURL&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;servicesURL&gt;&lt;/servicesURL&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;idleURL&gt;&lt;/idleURL&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;informationURL&gt;&lt;/informationURL&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;messagesURL&gt;&lt;/messagesURL&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;proxyServerURL&gt;&lt;/proxyServerURL&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;dscpForSCCPPhoneConfig&gt;</span>96<span class=nt>&lt;/dscpForSCCPPhoneConfig&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;dscpForSCCPPhoneServices&gt;</span>0<span class=nt>&lt;/dscpForSCCPPhoneServices&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;dscpForCm2Dvce&gt;</span>96<span class=nt>&lt;/dscpForCm2Dvce&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;transportLayerProtocol&gt;</span>2<span class=nt>&lt;/transportLayerProtocol&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;capfAuthMode&gt;</span>0<span class=nt>&lt;/capfAuthMode&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;capfList&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;capf&gt;</span> 
</span></span><span class=line><span class=cl>         <span class=nt>&lt;phonePort&gt;</span>3804<span class=nt>&lt;/phonePort&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/capf&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/capfList&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;certHash&gt;&lt;/certHash&gt;</span> 
</span></span><span class=line><span class=cl>   <span class=nt>&lt;encrConfig&gt;</span>false<span class=nt>&lt;/encrConfig&gt;</span> 
</span></span><span class=line><span class=cl><span class=nt>&lt;/device&gt;</span>
</span></span></code></pre></div><p>修改完后启动tftp服务器，在电话机上设置好tftp服务器后等待电话机完成注册，即可通过网络接打电话了。</p><h2 id=参考>参考<a hidden class=anchor aria-hidden=true href=#参考>#</a></h2><ul><li><a href=https://groups.google.com/g/asterisk-tw/c/pfb3IlN6bbk>https://groups.google.com/g/asterisk-tw/c/pfb3IlN6bbk</a></li><li><a href=https://kb.clearlyip.com/appliances/FXO-and-FXS-Setup-Guide.html>https://kb.clearlyip.com/appliances/FXO-and-FXS-Setup-Guide.html</a></li><li><a href="https://wiki.freepbx.org/pages/viewpage.action?pageId=58097711">https://wiki.freepbx.org/pages/viewpage.action?pageId=58097711</a></li><li><a href=https://usecallmanager.nz/sepmac-cnf-xml.html>https://usecallmanager.nz/sepmac-cnf-xml.html</a></li><li><a href=https://github.com/jefffall/Asterisk/blob/master/asterisk-version_15-config_files_july-3-2018/SEP6899CDA10587.cnf.xml>https://github.com/jefffall/Asterisk/blob/master/asterisk-version_15-config_files_july-3-2018/SEP6899CDA10587.cnf.xml</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.sparktour.me/tags/tech/>Tech</a></li><li><a href=https://blog.sparktour.me/tags/tdm410p/>Tdm410p</a></li><li><a href=https://blog.sparktour.me/tags/asterisk/>Asterisk</a></li><li><a href=https://blog.sparktour.me/tags/freepbx/>Freepbx</a></li><li><a href=https://blog.sparktour.me/tags/sip/>Sip</a></li><li><a href=https://blog.sparktour.me/tags/fxo/>Fxo</a></li></ul><nav class=paginav><a class=prev href=https://blog.sparktour.me/posts/2022/10/15/voip-fxo-via-linksys-spa3102/><span class=title>« 上一页</span><br><span>配置 Linksys SPA3102 并接入固定电话网</span>
</a><a class=next href=https://blog.sparktour.me/posts/2022/10/08/quectel-ec20-asterisk-freepbx-gsm-gateway/><span class=title>下一页 »</span><br><span>使用EC20模块配合asterisk及freepbx实现短信转发和网络电话</span></a></nav></footer><div class="callout callout-default"><img src=https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-nc-sa.svg alt="CC BY-NC-SA 4.0" style=width:88px;height:31px><p style=font-size:12px>Licensed Under <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel=noopener>CC BY-NC-SA 4.0</a></p><p style=font-size:12px>Post Link: <a href=https://blog.sparktour.me/posts/2022/10/14/voip-fxo-via-asterisk-freepbx-dahdi/ target=_blank rel=noopener>https://blog.sparktour.me/posts/2022/10/14/voip-fxo-via-asterisk-freepbx-dahdi/</a></p></div><script src=https://s4.zstatic.net/ajax/libs/disqusjs/3.0.2/disqusjs.es2015.umd.min.js crossorigin=anonymous></script><div id=disqusjs></div><script>const disqusjs=new DisqusJS({shortname:"sparktour",siteName:"",identifier:"",url:"",title:"",api:"https://disqus.com/api/",apikey:"QhJnXpS5igyHkjYQ91XYC4dSAuEJYAEsHX8hjLrRc1HU9AApOHLrqkwwIp2sKOLk",admin:"",adminLabel:""});disqusjs.render(document.getElementById("disqusjs"))</script></article></main><footer class=footer><span>&copy; 2025 <a href=https://blog.sparktour.me/>Sparktour's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>